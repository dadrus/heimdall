<!doctype html><html lang=en><head><title>Authenticators</title>
<meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="An open source Identity Aware Proxy and an Access Control Decision service for cloud native applications"><meta name=dc.relation content="https://dadrus.github.io/"><meta name=theme-color content="#1A94D2"><link rel=stylesheet href=../../../css/styles.min.css media=screen><link rel='shortcut icon' type=image/x-icon href=../../../favicon.ico></head><body><header class="navbar navbar-expand-md navbar-dark bg-dark sticky-top"><nav class="container-xxl flex-wrap flex-lg-nowrap px-0" aria-label="Main navigation"><button class="btn btn-outline-dark d-lg-none navbar-toggler border-0 shadow-none ps-3" type=button data-bs-toggle=offcanvas data-bs-target=#docsMenuContent aria-controls=docsMenuContent aria-expanded=false aria-label="Open docs menu"><svg width="36" height="36" fill="currentcolor" class="bi bi-list" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M2.5 12a.5.5.0 01.5-.5h10a.5.5.0 010 1H3a.5.5.0 01-.5-.5m0-4a.5.5.0 01.5-.5h10a.5.5.0 010 1H3A.5.5.0 012.5 8m0-4a.5.5.0 01.5-.5h10a.5.5.0 010 1H3A.5.5.0 012.5 4"/></svg></button><nav class="offcanvas offcanvas-start d-md-none text-bg-light" tabindex=-1 id=docsMenuContent aria-labelledby=docsMenuContentLabel><div class=offcanvas-header><h5 class=offcanvas-title id=docsMenuContentLabel>Browse docs</h5><button type=button class=btn-close data-bs-dismiss=offcanvas aria-label="Close docs menu"></button></div><div class="offcanvas-body docs-sidebar"><div class=docs-search-button><button type=button class="btn btn-outline-secondary mb-3 d-none d-md-block w-100 text-start" data-bs-toggle=modal data-bs-target=#docSearch aria-controls=docSearch aria-expanded=false aria-label="Open search">
<svg width="20" height="20" fill="currentcolor" class="bi bi-search me-2" viewBox="0 0 20 20"><path d="M11.742 10.344a6.5 6.5.0 10-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 001.415-1.414l-3.85-3.85a1 1 0 00-.115-.1zM12 6.5a5.5 5.5.0 11-11 0 5.5 5.5.0 0111 0"/></svg>
<span>Quick search...</span></button></div><nav id=SideBarToc><ul><li><span>Getting Started</span><ul><li><a href=../../../docs/getting_started/discover_heimdall/>Discover heimdall</a></li><li><a href=../../../docs/getting_started/installation/>Install heimdall</a></li><li><a href=../../../docs/getting_started/protect_an_app/>Protect an Application</a></li></ul></li><li><span>Concepts</span><ul><li><a href=../../../docs/concepts/pipelines/>Pipelines</a></li><li><a href=../../../docs/concepts/mechanisms/>Mechanisms</a></li><li><a href=../../../docs/concepts/rules/>Rules</a></li><li><a href=../../../docs/concepts/provider/>Rule Provider</a></li><li><a href=../../../docs/concepts/operating_modes/>Operating Modes</a></li></ul></li><li><span>Operations</span><ul><li><a href=../../../docs/operations/configuration/>Configuration</a></li><li><a href=../../../docs/operations/cli/>CLI</a></li><li><a href=../../../docs/operations/observability/>Observability</a></li><li><a href=../../../docs/operations/cache/>Caching</a></li><li><a href=../../../docs/operations/security/>Security</a></li></ul></li><li><span>Services</span><ul><li><a href=../../../docs/services/main/>Main Service</a></li><li><a href=../../../docs/services/management/>Management Service</a></li></ul></li><li><span>Mechanisms</span><ul><li><a href=../../../docs/mechanisms/catalogue/>Catalogue</a></li><li><a href=../../../docs/mechanisms/evaluation_objects/>Objects, Templating & Co</a></li><li><a class=active href=../../../docs/mechanisms/authenticators/>Authenticators</a></li><li><a href=../../../docs/mechanisms/authorizers/>Authorizers</a></li><li><a href=../../../docs/mechanisms/contextualizers/>Contextualizers</a></li><li><a href=../../../docs/mechanisms/finalizers/>Finalizers</a></li><li><a href=../../../docs/mechanisms/error_handlers/>Error Handlers</a></li></ul></li><li><span>Rules</span><ul><li><a href=../../../docs/rules/regular_rule/>Regular Rule</a></li><li><a href=../../../docs/rules/default_rule/>Default Rule</a></li><li><a href=../../../docs/rules/rule_sets/>Rule Sets</a></li><li><a href=../../../docs/rules/providers/>Rule Providers</a></li></ul></li><li><span>Configuration Reference</span><ul><li><a href=../../../docs/configuration/types/>Type Definitions</a></li><li><a href=../../../docs/configuration/reference/>Reference</a></li></ul></li></ul></nav></div></nav><div class="d-flex align-items-center px-4"><a class="navbar-brand navbar-brand-highlight text-white me-0" href=../../../ style=font-weight:500;font-size:1.5rem>Heimdall</a><ul class="navbar-nav d-none d-md-flex ms-3"><li class=nav-item><a class='nav-link text-white' href=../../../docs/getting_started/discover_heimdall>Docs</a></li><li class=nav-item><a class='nav-link text-white' href=../../../guides/>Guides</a></li><li class=nav-item><a class='nav-link text-white' href=../../../openapi/>API</a></li></ul></div><div class=d-flex><button type=button class="btn btn-outline-dark navbar-toggler border-0 shadow-none" data-bs-toggle=modal data-bs-target=#docSearch aria-controls=docSearch aria-expanded=false aria-label="Open search">
<span class="bi bi-search"></span>
</button>
<button class="btn btn-outline-dark navbar-toggler border-0 shadow-none pe-3" type=button data-bs-toggle=offcanvas data-bs-target=#mainMenuContent aria-controls=mainMenuContent aria-expanded=false aria-label="Open main menu"><svg width="24" height="24" fill="currentcolor" class="bi bi-three-dots" viewBox="0 0 16 16"><path d="M3 9.5a1.5 1.5.0 110-3 1.5 1.5.0 010 3m5 0a1.5 1.5.0 110-3 1.5 1.5.0 010 3m5 0a1.5 1.5.0 110-3 1.5 1.5.0 010 3"/></svg></button><div class="offcanvas offcanvas-end text-bg-dark" tabindex=-1 id=mainMenuContent aria-labelledby=mainMenuContentLabel><div class=offcanvas-header><h5 class="offcanvas-title text-white" id=mainMenuContentLabel>Heimdall</h5><button type=button class="btn-close btn-close-white" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class=offcanvas-body><ul class="navbar-nav flex-column d-md-none d-lg-none d-xl-none"><li class=nav-item><a class='nav-link text-white' href=../../../docs/getting_started/discover_heimdall>Docs</a></li><li class=nav-item><a class='nav-link text-white' href=../../../guides/>Guides</a></li><li class=nav-item><a class='nav-link text-white' href=../../../openapi/>API</a></li></ul><hr class="text-white-50 d-md-none"><ul class="navbar-nav flex-column ms-auto"><doc-version-select class="nav-item dropdown" version-file=/heimdall/data.json current-version=v0.16.1 current-page=/docs/mechanisms/authenticators/><button class="btn btn-dark dropdown-toggle me-4" data-bs-toggle=dropdown aria-expanded=false>
v0.16.1</button></doc-version-select></ul><ul class="navbar-nav flex-column"><li class="nav-item mb-1 pe-4"><a class="nav-link text-white" style=align-self:center href=https://github.com/dadrus/heimdall><svg role="img" width="20" height="20" fill="currentcolor" class="bi bi-github text-white" viewBox="0 0 16 16"><title>GitHub</title><path d="M8 0C3.58.0.0 3.58.0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38.0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95.0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12.0.0.67-.21 2.2.82.64-.18 1.32-.27 2-.27s1.36.09 2 .27c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15.0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48.0 1.07-.01 1.93-.01 2.2.0.21.15.46.55.38A8.012 8.012.0 0016 8c0-4.42-3.58-8-8-8z"/></svg>
<small class="ms-2 d-md-none">GitHub</small></a></li></ul></div></div></div></nav></header><div class=modal id=docSearch tabindex=-1 aria-labelledby=docSearchLabel aria-hidden=true><doc-search class="col-auto me-auto mw-75" index-file=/heimdall/v0.16.1/index.json path-prefix=/heimdall/v0.16.1><div class="modal-dialog modal-lg modal-dialog-scrollable"><div class=modal-content><div class="modal-header p-2"><div class=input-group><div class="input-group-text bg-body border-0 fs-4"><svg width="16" height="16" fill="currentcolor" class="bi bi-search text-secondary my-0" viewBox="0 0 16 16"><path d="M11.742 10.344a6.5 6.5.0 10-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 001.415-1.414l-3.85-3.85a1 1 0 00-.115-.1zM12 6.5a5.5 5.5.0 11-11 0 5.5 5.5.0 0111 0"/></svg></div><input id=search-input class="form-control search-bar border-0" type=search placeholder="Search documentation " aria-label="Search docs..." autocomplete=off autofocus><div class="input-group-text bg-body border-0"><a class="btn input-group-text text-muted border p-1 bg-light-subtle fs-7 fw-bold font-monospace" data-bs-dismiss=modal aria-label=Close>ESC</a></div></div></div><div class=modal-body><div class=search-results><p class="text-center mt-5">No recent searches</p></div></div><div class=modal-footer></div></div></div></doc-search></div><div class="container-xxl docs-layout px-4"><aside class="d-none pe-3 docs-sidebar"><div class=docs-search-button><button type=button class="btn btn-outline-secondary mb-3 d-none d-md-block w-100 text-start" data-bs-toggle=modal data-bs-target=#docSearch aria-controls=docSearch aria-expanded=false aria-label="Open search">
<svg width="20" height="20" fill="currentcolor" class="bi bi-search me-2" viewBox="0 0 20 20"><path d="M11.742 10.344a6.5 6.5.0 10-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 001.415-1.414l-3.85-3.85a1 1 0 00-.115-.1zM12 6.5a5.5 5.5.0 11-11 0 5.5 5.5.0 0111 0"/></svg>
<span>Quick search...</span></button></div><nav id=SideBarToc><ul><li><span>Getting Started</span><ul><li><a href=../../../docs/getting_started/discover_heimdall/>Discover heimdall</a></li><li><a href=../../../docs/getting_started/installation/>Install heimdall</a></li><li><a href=../../../docs/getting_started/protect_an_app/>Protect an Application</a></li></ul></li><li><span>Concepts</span><ul><li><a href=../../../docs/concepts/pipelines/>Pipelines</a></li><li><a href=../../../docs/concepts/mechanisms/>Mechanisms</a></li><li><a href=../../../docs/concepts/rules/>Rules</a></li><li><a href=../../../docs/concepts/provider/>Rule Provider</a></li><li><a href=../../../docs/concepts/operating_modes/>Operating Modes</a></li></ul></li><li><span>Operations</span><ul><li><a href=../../../docs/operations/configuration/>Configuration</a></li><li><a href=../../../docs/operations/cli/>CLI</a></li><li><a href=../../../docs/operations/observability/>Observability</a></li><li><a href=../../../docs/operations/cache/>Caching</a></li><li><a href=../../../docs/operations/security/>Security</a></li></ul></li><li><span>Services</span><ul><li><a href=../../../docs/services/main/>Main Service</a></li><li><a href=../../../docs/services/management/>Management Service</a></li></ul></li><li><span>Mechanisms</span><ul><li><a href=../../../docs/mechanisms/catalogue/>Catalogue</a></li><li><a href=../../../docs/mechanisms/evaluation_objects/>Objects, Templating & Co</a></li><li><a class=active href=../../../docs/mechanisms/authenticators/>Authenticators</a></li><li><a href=../../../docs/mechanisms/authorizers/>Authorizers</a></li><li><a href=../../../docs/mechanisms/contextualizers/>Contextualizers</a></li><li><a href=../../../docs/mechanisms/finalizers/>Finalizers</a></li><li><a href=../../../docs/mechanisms/error_handlers/>Error Handlers</a></li></ul></li><li><span>Rules</span><ul><li><a href=../../../docs/rules/regular_rule/>Regular Rule</a></li><li><a href=../../../docs/rules/default_rule/>Default Rule</a></li><li><a href=../../../docs/rules/rule_sets/>Rule Sets</a></li><li><a href=../../../docs/rules/providers/>Rule Providers</a></li></ul></li><li><span>Configuration Reference</span><ul><li><a href=../../../docs/configuration/types/>Type Definitions</a></li><li><a href=../../../docs/configuration/reference/>Reference</a></li></ul></li></ul></nav></aside><main class=docs-main><div class="d-md-none docs-location bg-body"><nav style="--bs-breadcrumb-divider:'>'" aria-label=breadcrumb><ol class="breadcrumb mb-0"><li class="breadcrumb-item fw-bold">Mechanisms</li><li class="breadcrumb-item active" aria-current=page>Authenticators</li></ol></nav></div><div class="docs-intro pt-3 pe-3"><h1>Authenticators</h1><p>Authenticators verify the authentication status of requests and create subjects. This page describes the available authenticator types in detail.</p></div><aside class="text-muted docs-toc"><strong class="d-md-block h6 pb-2 my-2 ms-2 border-bottom d-none d-md-none d-lg-block">On this page</strong><div id=page-content-toc class="mt-1 mb-3 text-muted d-none d-md-none d-lg-block docs-toc-content"><nav id=TableOfContents><ul><li><a href=#_unauthorized>Unauthorized</a></li><li><a href=#_anonymous>Anonymous</a></li><li><a href=#_basic_auth>Basic Auth</a></li><li><a href=#_generic>Generic</a></li><li><a href=#_oauth2_introspection>OAuth2 Introspection</a></li><li><a href=#_jwt>JWT</a></li></ul></nav></div><button class="btn btn-outline-secondary text-decoration-none d-lg-none collapsed" type=button data-bs-toggle=collapse data-bs-target=#page-content-toc-collapsible aria-expanded=false aria-controls=page-content-toc-collapsible>
On this page<svg width="16" height="16" fill="currentcolor" class="bi bi-chevron-expand" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M3.646 9.146a.5.5.0 01.708.0L8 12.793l3.646-3.647a.5.5.0 01.708.708l-4 4a.5.5.0 01-.708.0l-4-4a.5.5.0 010-.708m0-2.292a.5.5.0 00.708.0L8 3.207l3.646 3.647a.5.5.0 00.708-.708l-4-4a.5.5.0 00-.708.0l-4 4a.5.5.0 000 .708"/></svg></button><div id=page-content-toc-collapsible class="mt-1 mb-3 text-muted d-lg-none collapse docs-toc-content"><div class="card card-body"><nav id=TableOfContents><ul><li><a href=#_unauthorized>Unauthorized</a></li><li><a href=#_anonymous>Anonymous</a></li><li><a href=#_basic_auth>Basic Auth</a></li><li><a href=#_generic>Generic</a></li><li><a href=#_oauth2_introspection>OAuth2 Introspection</a></li><li><a href=#_jwt>JWT</a></li></ul></nav></div></div></aside><div class="docs-content pe-3"><div data-bs-spy=scroll data-bs-target=#page-content-toc class=mt-3><linkable-headline-area><div class=paragraph><p>Some of the supported authenticator types may support or require additional configuration. The corresponding properties are annotated with <code>mandatory</code>, respectively <code>optional</code> to denote configuration requirement, as well as with <code>overridable</code>, <code>not overriddable</code> and <code>partially overridable</code> to indicate whether the property can be overridden in a rule pipeline.</p></div><div class=sect1><h2 id=_unauthorized>Unauthorized</h2><div class=sectionbody><div class=paragraph><p>This authenticator rejects all requests as unauthenticated (on HTTP response code level this is then mapped to <code>401 Unauthorized</code>, hence the type name). It basically stops the successful execution of the pipeline resulting in the execution of the error handlers. This authenticator type doesn’t have any configuration options.</p></div><div class=paragraph><p>To enable the usage of this authenticator, you have to set the <code>type</code> property to <code>unauthorized</code>.</p></div><div class=exampleblock><div class=title>Example 1. Configure Unauthorized authenticator</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=yaml><span class=na>id</span><span class=pi>:</span> <span class=s>foo</span>
<span class=na>type</span><span class=pi>:</span> <span class=s>unauthorized</span></code></pre></div></div></div></div></div></div><div class=sect1><h2 id=_anonymous>Anonymous</h2><div class=sectionbody><div class=paragraph><p>This authenticator just creates a <a href=../../../docs/mechanisms/evaluation_objects/#_subject><code>Subject</code></a> object and sets its <code>ID</code> to <code>anonymous</code> without doing anything else. You can overwrite the value of subject’s id by using the optional <code>config</code> property.</p></div><div class=paragraph><p>To enable the usage of this authenticator, you have to set the <code>type</code> property to <code>anonymous</code>.</p></div><div class=paragraph><p>Configuration using the <code>config</code> property is optional. Following properties are available:</p></div><div class=ulist><ul><li><p><strong><code>subject</code></strong>: <em>string</em> (optional, overridable)</p><div class=paragraph><p>Enables setting the <code>ID</code> of the created <a href=../../../docs/mechanisms/evaluation_objects/#_subject><code>Subject</code></a> object to a custom value.</p></div></li></ul></div><div class=exampleblock><div class=title>Example 2. Configuration of Anonymous authenticator</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=yaml><span class=na>id</span><span class=pi>:</span> <span class=s>foo</span>
<span class=na>type</span><span class=pi>:</span> <span class=s>anonymous</span>
<span class=na>config</span><span class=pi>:</span>
  <span class=na>subject</span><span class=pi>:</span> <span class=s>anon</span></code></pre></div></div></div></div></div></div><div class=sect1><h2 id=_basic_auth>Basic Auth</h2><div class=sectionbody><div class=paragraph><p>This authenticator verifies the provided credentials according to the HTTP "Basic" authentication scheme, described in <a href=https://datatracker.ietf.org/doc/html/rfc7617>RFC 7617</a>. It does however not challenge the authentication, it only verifies the provided credentials and sets the <a href=../../../docs/mechanisms/evaluation_objects/#_subject><code>Subject</code></a> <code>ID</code> to the configured user identifier if the authentication succeeds. Otherwise, it raises an error, resulting in the execution of the configured error handlers. The <a href=../../../docs/mechanisms/error_handlers/#_www_authenticate>"WWW Authenticate"</a> error handler mechanism can for example be used if the corresponding challenge is required.</p></div><div class=paragraph><p>To enable the usage of this authenticator, you have to set the <code>type</code> property to <code>basic_auth</code>.</p></div><div class=paragraph><p>Configuration using the <code>config</code> property is mandatory. Following properties are available:</p></div><div class=ulist><ul><li><p><strong><code>user_id</code></strong>: <em>string</em> (mandatory, overridable)</p><div class=paragraph><p>The identifier of the subject to be verified.</p></div></li><li><p><strong><code>password</code></strong>: <em>string</em> (mandatory, overridable)</p><div class=paragraph><p>The password of the subject to be verified.</p></div></li><li><p><strong><code>allow_fallback_on_error</code></strong>: <em>boolean</em> (optional, overridable)</p><div class=paragraph><p><strong>Deprecated:</strong> As of v0.16.0, this property is ineffective and will be removed in v0.17.0. Refer to the authentication stage description in the <a href=../../../docs/concepts/pipelines/#_authentication_authorization_pipeline>Authentication & Authorization Pipline</a> for details on the current behavior.</p></div></li></ul></div><div class=exampleblock><div class=title>Example 3. Configuration of Basic Auth authenticator</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=yaml><span class=na>id</span><span class=pi>:</span> <span class=s>foo</span>
<span class=na>type</span><span class=pi>:</span> <span class=s>basic_auth</span>
<span class=na>config</span><span class=pi>:</span>
  <span class=na>user_id</span><span class=pi>:</span> <span class=s>bar</span>
  <span class=na>password</span><span class=pi>:</span> <span class=s>baz</span></code></pre></div></div></div></div></div></div><div class=sect1><h2 id=_generic>Generic</h2><div class=sectionbody><div class=paragraph><p>This authenticator is kind of a Swiss knife and can do a lot depending on the given configuration. It verifies the authentication status of the subject by making use of values available in cookies, headers, or query parameters of the HTTP request and communicating with the actual authentication system to perform the verification of the subject authentication status on the one hand, and to get the information about the subject on the other hand. There is however one limitation: it can only deal with JSON responses.</p></div><div class=paragraph><p>To enable the usage of this authenticator, you have to set the <code>type</code> property to <code>generic</code>.</p></div><div class=paragraph><p>Configuration using the <code>config</code> property is mandatory. Following properties are available:</p></div><div class=ulist><ul><li><p><strong><code>identity_info_endpoint</code></strong>: <em><a href=../../../docs/configuration/types/#_endpoint>Endpoint</a></em> (mandatory, not overridable)</p><div class=paragraph><p>The endpoint to communicate to for the actual subject authentication status verification purpose. At least the <code>url</code> must be configured. If you don’t configure <code>method</code>, HTTP <code>POST</code> will be used. The <code>Accept</code> header is set to <code>application/json</code> by default. You can overwrite these setting if required. Query and header definitions can be templated and can make use of the <code>AuthenticationData</code> object (see below). Don’t forget - this authenticator supports only JSON responses.</p></div></li><li><p><strong><code>authentication_data_source</code></strong>: <em><a href=../../../docs/configuration/types/#_authentication_data_source>Authentication Data Source</a></em> (mandatory, not overridable)</p><div class=paragraph><p>Where to extract the authentication data from the request. The extracted value is made available as <code>AuthenticationData</code> for usage in templates defined as part of this authenticator configuration. So you can reference it in a body, header, etc.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content>The <code>AuthenticationData</code> object is available during the execution of this authenticator only and is not made available to other mechanisms.</td></tr></tbody></table></div></li><li><p><strong><code>forward_headers</code></strong>: <em>string array</em> (optional, not overridable)</p><div class=paragraph><p>If the <code>identity_info_endpoint</code> API requires any headers from the request to heimdall, you can forward these unchanged by making use of this property. This might be the header used to extract the authentication data from.</p></div></li><li><p><strong><code>forward_cookies</code></strong>: <em>string array</em> (optional, not overridable)</p><div class=paragraph><p>If the <code>identity_info_endpoint</code> API requires any cookies from the request to heimdall, you can forward these unchanged by making use of this property. This might be the cookie used to extract the authentication data from.</p></div></li><li><p><strong><code>payload</code></strong>: <em>string</em> (optional, not overridable)</p><div class=paragraph><p>Your <a href=../../../docs/mechanisms/evaluation_objects/#_templating>template</a> with definitions required to send the extracted authentication data. The template has access to the <code>AuthenticationData</code> object only.</p></div></li><li><p><strong><code>subject</code></strong>: <em><a href=../../../docs/configuration/types/#_subject>Subject</a></em> (mandatory, not overridable)</p><div class=paragraph><p>Where to extract the <a href=../../../docs/mechanisms/evaluation_objects/#_subject><code>Subject</code></a> information from the identity info endpoint response.</p></div></li><li><p><strong><code>cache_ttl</code></strong>: <em><a href=../../../docs/configuration/types/#_duration>Duration</a></em> (optional, overridable)</p><div class=paragraph><p>How long to cache the response. If not set, response caching if disabled. The cache key is calculated from the <code>identity_info_endpoint</code> configuration and the actual authentication data value.</p></div></li><li><p><strong><code>allow_fallback_on_error</code></strong>: <em>boolean</em> (optional, overridable)</p><div class=paragraph><p><strong>Deprecated:</strong> As of v0.16.0, this property is ineffective and will be removed in v0.17.0. Refer to the authentication stage description in the <a href=../../../docs/concepts/pipelines/#_authentication_authorization_pipeline>Authentication & Authorization Pipline</a> for details on the current behavior.</p></div></li><li><p><strong><code>session_lifespan</code></strong>: <em><a href=../../../docs/configuration/types/#_session_lifespan>Session Lifespan</a></em> (optional, not overridable)</p><div class=paragraph><p>Where to extract the session validity information form the identity info endpoint response. If the <code>not_after</code> property is specified, the corresponding value from the response is also used for cache ttl calculation to prevent usage of not anymore valid session objects and overwrites the value configured for <code>cache_ttl</code> if the usage of that value would exceed the lifespan of the session object.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content>If you’re configuring the <code>cache_ttl</code> property, it is highly recommended to configure <code>session_lifespan</code> as well to ensure outdated session objects are not used for subsequent requests to heimdall. Usage of <code>session_lifespan</code> is recommended anyway to enable time based validation of the response from the identity info endpoint.</td></tr></tbody></table></div></li></ul></div><div class=exampleblock><div class=title>Example 4. Configuration to work with session cookies</div><div class=content><div class=paragraph><p>This example shows how to configure this authenticator to work with Ory Kratos, an authentication system, which issues a cookie upon successful user authentication to maintain the authentication state. To reduce the communication overhead, it also makes use of <code>cache_ttl</code> to cache the response for 5 minutes if that time frame does not exceed the actual validity of the session represented by the cookie.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=yaml><span class=na>id</span><span class=pi>:</span> <span class=s>kratos_session_cookie</span>
<span class=na>type</span><span class=pi>:</span> <span class=s>generic</span>
<span class=na>config</span><span class=pi>:</span>
  <span class=na>identity_info_endpoint</span><span class=pi>:</span> <span class=s>https://kratos/sessions/whoami</span>
  <span class=na>authentication_data_source</span><span class=pi>:</span>
    <span class=pi>-</span> <span class=na>cookie</span><span class=pi>:</span> <span class=s>ory_kratos_session</span>
  <span class=na>forward_cookies</span><span class=pi>:</span>
    <span class=pi>-</span> <span class=s>ory_kratos_session</span>
  <span class=na>subject</span><span class=pi>:</span>
    <span class=na>id</span><span class=pi>:</span> <span class=s2>&#34;</span><span class=s>identity.id&#34;</span>
  <span class=na>cache_ttl</span><span class=pi>:</span> <span class=s>5m</span>
  <span class=na>session_lifespan</span><span class=pi>:</span>
    <span class=na>active</span><span class=pi>:</span> <span class=s>active</span>
    <span class=na>issued_at</span><span class=pi>:</span> <span class=s>issued_at</span>
    <span class=na>not_before</span><span class=pi>:</span> <span class=s>authenticated_at</span>
    <span class=na>not_after</span><span class=pi>:</span> <span class=s>expires_at</span>
    <span class=na>time_format</span><span class=pi>:</span> <span class=s2>&#34;</span><span class=s>2006-01-02T15:04:05.999999Z07&#34;</span>
    <span class=na>validity_leeway</span><span class=pi>:</span> <span class=s>10s</span></code></pre></div></div><div class=paragraph><p>As kratos requires the <code>ory_kratos_session</code> cookie as is, this configuration makes use of the <code>forward_cookies</code> property and does not use the <code>AuthenticationData</code> object.</p></div><div class=paragraph><p>This example does also show how an endpoint can be configured by just specifying the URL as string, which is the simplest way for endpoint configuration.</p></div></div></div><div class=exampleblock><div class=title>Example 5. Configuration to work with a Bearer token</div><div class=content><div class=paragraph><p>This example shows how to configure this authenticator to work with an OAuth2 authorization service, which issues a Bearer token upon successful user authentication. To reduce the communication overhead, it also makes use of <code>cache_ttl</code> to cache the response for 5 minutes if it does not exceed the validity of the information present in the response from the used endpoint.</p></div><div class=paragraph><p>In this example we configure the authenticator to use the introspection endpoint to get the information about the token.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=yaml><span class=na>id</span><span class=pi>:</span> <span class=s>opaque_bearer_token</span>
<span class=na>type</span><span class=pi>:</span> <span class=s>generic</span>
<span class=na>config</span><span class=pi>:</span>
  <span class=na>identity_info_endpoint</span><span class=pi>:</span>
    <span class=na>url</span><span class=pi>:</span> <span class=s>https://my-auth.system/introspect</span>
    <span class=na>headers</span><span class=pi>:</span>
      <span class=na>Content-Type</span><span class=pi>:</span> <span class=s>application/x-www-form-urlencoded</span>
    <span class=na>auth</span><span class=pi>:</span>
      <span class=na>type</span><span class=pi>:</span> <span class=s>basic_auth</span>
      <span class=na>config</span><span class=pi>:</span>
        <span class=na>user</span><span class=pi>:</span> <span class=s>Heimdall</span>
        <span class=na>password</span><span class=pi>:</span> <span class=s>${INTROSPECTION_PASSWORD}</span>
  <span class=na>authentication_data_source</span><span class=pi>:</span>
    <span class=pi>-</span> <span class=na>header</span><span class=pi>:</span> <span class=s>Authorization</span>
      <span class=na>scheme</span><span class=pi>:</span> <span class=s>Bearer</span>
  <span class=na>payload</span><span class=pi>:</span> <span class=pi>|</span>
    <span class=s>token={{ urlenc .AuthenticationData }}&amp;token_type_hint=access_token</span>
  <span class=na>subject</span><span class=pi>:</span>
    <span class=na>id</span><span class=pi>:</span> <span class=s>sub</span>
  <span class=na>cache_ttl</span><span class=pi>:</span> <span class=s>5m</span>
  <span class=na>session_lifespan</span><span class=pi>:</span>
    <span class=na>active</span><span class=pi>:</span> <span class=s>active</span>
    <span class=na>issued_at</span><span class=pi>:</span> <span class=s>iat</span>
    <span class=na>not_before</span><span class=pi>:</span> <span class=s>nbf</span>
    <span class=na>not_after</span><span class=pi>:</span> <span class=s>exp</span>
    <span class=na>validity_leeway</span><span class=pi>:</span> <span class=s>10s</span></code></pre></div></div><div class=paragraph><p>Usually, you would not only like to verify the validity of a token, but also a couple of claims. This can be achieved by a <a href=../../../docs/mechanisms/authorizers/#_local_cel>CEL Authorizer</a>. However, there is also a special purpose <a href=#_oauth2_introspection>OAuth2 Introspection</a> authenticator type, which supports asserting all security relevant claims in just one place and does not need so much configuration as shown above.</p></div><div class=paragraph><p>In this configuration the authenticator extracts the token from the <code>Authorization</code> header and request the information about the corresponding user from the <code>https://my-auth.system/introspect</code> endpoint by sending the extracted token in the body of the request in a parameter named <code>token</code>.</p></div></div></div><div class=exampleblock><div class=title>Example 6. Configuration to work with Google’s Firebase.</div><div class=content><div class=paragraph><p>If you would like to integrate with Google’s Firebase, you would configure something like this:</p></div><div class=paragraph><p>Assumption: The token issued by firebase is located in the HTTP Authorization header using Bearer scheme</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=yaml><span class=na>id</span><span class=pi>:</span> <span class=s>firebase_token</span>
<span class=na>type</span><span class=pi>:</span> <span class=s>generic</span>
<span class=na>config</span><span class=pi>:</span>
  <span class=na>identity_info_endpoint</span><span class=pi>:</span>
    <span class=na>url</span><span class=pi>:</span> <span class=s>https://identitytoolkit.googleapis.com/v1/accounts:lookup?key=${YOUR_API_KEY}</span>
    <span class=na>headers</span><span class=pi>:</span>
      <span class=na>Content-Type</span><span class=pi>:</span> <span class=s>application/json</span>
  <span class=na>authentication_data_source</span><span class=pi>:</span>
    <span class=pi>-</span> <span class=na>header</span><span class=pi>:</span> <span class=s>Authorization</span>
      <span class=na>scheme</span><span class=pi>:</span> <span class=s>Bearer</span>
  <span class=na>payload</span><span class=pi>:</span> <span class=pi>|</span>
   <span class=s>{ &#34;idToken&#34;: {{ quote .AuthenticationData }} }</span>
  <span class=na>subject</span><span class=pi>:</span>
   <span class=na>id</span><span class=pi>:</span> <span class=s>users.0.localId</span>
   <span class=na>attributes</span><span class=pi>:</span> <span class=s>users.0</span>
  <span class=na>cache_ttl</span><span class=pi>:</span> <span class=s>5m</span></code></pre></div></div></div></div></div></div><div class=sect1><h2 id=_oauth2_introspection>OAuth2 Introspection</h2><div class=sectionbody><div class=paragraph><p>This authenticator handles requests that have Bearer token in the HTTP Authorization header (<code>Authorization: Bearer &lt;token></code>), in the <code>access_token</code> query parameter or the <code>access_token</code> body parameter (latter, if the body is of <code>application/x-www-form-urlencoded</code> MIME type). It then uses <a href=https://datatracker.ietf.org/doc/html/rfc7662>OAuth 2.0 Token Introspection</a> endpoint to check if the token is valid. The validation includes at least the verification of the status and the time validity. That is if the token is still active and whether it has been issued in an acceptable time frame. Latter can be adjusted by specifying a leeway. All other validation options can and should be configured.</p></div><div class=paragraph><p>To enable the usage of this authenticator, you have to set the <code>type</code> property to <code>oauth2_introspection</code>.</p></div><div class=paragraph><p>Configuration using the <code>config</code> property is mandatory. Following properties are available:</p></div><div class=ulist><ul><li><p><strong><code>introspection_endpoint</code></strong>: <em><a href=../../../docs/configuration/types/#_endpoint>Endpoint</a></em> (dependant, not overridable)</p><div class=paragraph><p>The <a href=https://datatracker.ietf.org/doc/html/rfc7662>OAuth 2.0 Token Introspection</a> endpoint of the OAuth2 authorization provider.</p></div><div class=paragraph><p>The configuration of this property is mutually exclusive with <code>metadata_endpoint</code>. If used, at least the <code>url</code> must be configured. There is no need to define the <code>method</code> property or setting the <code>Content-Type</code> or the <code>Accept</code> header. These are set by default to the values required by the RFC referenced above. You can however override these while configuring the authenticator if needed. The path part of the <code>url</code> can be <a href=../../../docs/mechanisms/evaluation_objects/#_templating>templated</a> and has access to the <code>TokenIssuer</code> object, which is a string and only available if the format of the used token is JWT. It basically holds the value of the <code>iss</code> claim from the token.</p></div></li><li><p><strong><code>metadata_endpoint</code></strong>: <em><a href=../../../docs/configuration/types/#_endpoint>Endpoint</a></em> (dependant, not overridable)</p><div class=paragraph><p>The <a href=https://datatracker.ietf.org/doc/html/rfc8414>OAuth 2.0 Authorization Server Metadata</a> endpoint of the OAuth2, respectively OIDC authorization provider (the <a href=https://openid.net/specs/openid-connect-discovery-1_0.html>OpenID Connect Discovery</a> specification is an OIDC specific profile of that specification). If the token introspection URL is not known upfront, it can be resolved by making use of that endpoint.</p></div><div class=paragraph><p>The configuration of this property is mutually exclusive with <code>introspection_endpoint</code>. If used, at least the <code>url</code> must be configured, can be templated and has access to the <code>TokenIssuer</code> object already introduced above (with the same limitations).</p></div><div class=paragraph><p>The <code>metadata_endpoint</code> is by default configured to use <code>GET</code> as HTTP method and sets the <code>Accept</code> header to <code>application/json</code> as also required by both specifications referenced above. In addition, to avoid useless communication, it is also configured to make use of HTTP cache according to <a href=https://tools.ietf.org/html/rfc7234>RFC 7234</a> with default HTTP cache ttl set to <code>30m</code>. All these settings can however be overridden if required.</p></div><div class=paragraph><p>In addition to the properties specified by the <a href=../../../docs/configuration/types/#_endpoint><code>endpoint</code></a> type, following properties are available:</p></div><div class=ulist><ul><li><p><strong><code>disable_issuer_identifier_verification</code></strong>: <em>boolean</em> (optional, not overridable)</p><div class=paragraph><p>Upon retrieval of the server metadata, both, the <a href=https://datatracker.ietf.org/doc/html/rfc8414>OAuth 2.0 Authorization Server Metadata</a> RFC, and the <a href=https://openid.net/specs/openid-connect-discovery-1_0.html>OpenID Connect Discovery</a> specification, require the verification of the issuer identifier for security reasons, e.g. to prevent <a href=https://datatracker.ietf.org/doc/html/rfc8414#section-6.2>Spoofing Attacks</a>. There are however setups, where strictly following that recommendation would result in extended bandwidth usage (instead of communicating directly with the auth server within the cluster one would need to use the same domain, the client application uses, which introduces additional network hops). It might also not work at all as the actual identifier of the issuer would change depending on where the request come from. By making use of this property and setting it to <code>true</code>, one can disable the corresponding verification. Defaults to <code>false</code>.</p></div></li><li><p><strong><code>resolved_endpoints</code></strong>: <em>map of ResolvedEndpoint</em> (optional, not overridable)</p><div class=paragraph><p>A map where each key represents the name of an endpoint as specified in the <a href=https://datatracker.ietf.org/doc/html/rfc8414>OAuth 2.0 Authorization Server Metadata</a> or the <a href=https://openid.net/specs/openid-connect-discovery-1_0.html>OpenID Connect Discovery</a> specifications. The value associated with each key is a set of configuration options that are applied before sending a request to that specific endpoint. Following configuration options are possible:</p></div><div class=ulist><ul><li><p><strong><code>retry</code></strong> <em><a href=../../../docs/configuration/types/#_retry>Retry</a></em> (optional)</p><div class=paragraph><p>What to do if the communication fails. If not configured, no retry attempts are done.</p></div></li><li><p><strong><code>auth</code></strong> <em><a href=../../../docs/configuration/types/#_authentication_strategy>Authentication Strategy</a></em> (optional)</p><div class=paragraph><p>Authentication strategy to apply if the endpoint requires authentication.</p></div></li><li><p><strong><code>http_cache</code></strong> <em><a href=../../../docs/configuration/types/#_http_cache>HTTP Cache</a></em> (optional)</p><div class=paragraph><p>Controls whether HTTP caching according to <a href=https://www.rfc-editor.org/rfc/rfc7234>RFC 7234</a> should be used.</p></div></li></ul></div></li></ul></div></li><li><p><strong><code>token_source</code></strong>: <em><a href=../../../docs/configuration/types/#_authentication_data_source>Authentication Data Source</a></em> (optional, not overridable)</p><div class=paragraph><p>Where to get the access token from. Defaults to retrieve it from the <code>Authorization</code> header, the <code>access_token</code> query parameter or the <code>access_token</code> body parameter (latter, if the body is of <code>application/x-www-form-urlencoded</code> MIME type).</p></div></li><li><p><strong><code>assertions</code></strong>: <em><a href=../../../docs/configuration/types/#_assertions>Assertions</a></em> (optional, overridable)</p><div class=paragraph><p>Configures the required claim assertions. Overriding on rule level is possible even partially. Those parts of the assertion, which have not been overridden are taken from the prototype configuration.</p></div></li><li><p><strong><code>subject</code></strong>: <em><a href=../../../docs/configuration/types/#_subject>Subject</a></em> (optional, not overridable)</p><div class=paragraph><p>Where to extract the <a href=../../../docs/mechanisms/evaluation_objects/#_subject><code>Subject</code></a> information from the introspection endpoint response. If not configured <code>sub</code> is used to extract the subject <code>ID</code> and all attributes from the introspection endpoint response are made available as <code>Attributes</code>.</p></div></li><li><p><strong><code>cache_ttl</code></strong>: <em><a href=../../../docs/configuration/types/#_duration>Duration</a></em> (optional, overridable)</p><div class=paragraph><p>How long to cache the response. If not set, caching of the introspection response is based on the available token expiration information. To disable caching, set it to <code>0s</code>. If you set the ttl to a custom value > 0, the expiration time (if available) of the token will be considered. The cache key is calculated from the <code>introspection_endpoint</code> configuration and the value of the access token.</p></div></li><li><p><strong><code>allow_fallback_on_error</code></strong>: <em>boolean</em> (optional, overridable)</p><div class=paragraph><p><strong>Deprecated:</strong> As of v0.16.0, this property is ineffective and will be removed in v0.17.0. Refer to the authentication stage description in the <a href=../../../docs/concepts/pipelines/#_authentication_authorization_pipeline>Authentication & Authorization Pipline</a> for details on the current behavior.</p></div></li></ul></div><div class=exampleblock><div class=title>Example 7. Minimal possible configuration based on the Introspection endpoint</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=yaml><span class=na>id</span><span class=pi>:</span> <span class=s>at_opaque</span>
<span class=na>type</span><span class=pi>:</span> <span class=s>oauth2_introspection</span>
<span class=na>config</span><span class=pi>:</span>
  <span class=na>introspection_endpoint</span><span class=pi>:</span>
    <span class=na>url</span><span class=pi>:</span> <span class=s>https://hydra:4445/oauth2/introspect</span></code></pre></div></div></div></div><div class=exampleblock><div class=title>Example 8. Configuration for Keycloak utilizing metadata discovery and authentication configuration for the resolved <code>introspection_endpoint</code>.</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=yaml><span class=na>id</span><span class=pi>:</span> <span class=s>keycloak</span>
<span class=na>type</span><span class=pi>:</span> <span class=s>metadata_endpoint</span>
<span class=na>config</span><span class=pi>:</span>
  <span class=na>metadata_endpoint</span><span class=pi>:</span>
    <span class=na>url</span><span class=pi>:</span> <span class=s>https://keycloak:8080/realms/{{ trimPrefix &#34;https://my-auth-server/realms/&#34; .TokenIssuer }}/.well-known/openid-configuration</span>
    <span class=na>resolved_endpoints</span><span class=pi>:</span>
      <span class=na>introspection_endpoint</span><span class=pi>:</span>
        <span class=na>auth</span><span class=pi>:</span>
          <span class=na>type</span><span class=pi>:</span> <span class=s>api_key</span>
          <span class=na>config</span><span class=pi>:</span>
            <span class=na>in</span><span class=pi>:</span> <span class=s>header</span>
            <span class=na>name</span><span class=pi>:</span> <span class=s>Authorization</span>
            <span class=na>value</span><span class=pi>:</span> <span class=s>Bearer 23410913-abewfq.123483</span></code></pre></div></div><div class=paragraph><p>This example does also show how to make use of templating if the format of the access token is JWT.</p></div><div class=paragraph><p>The external domain of the auth server in this example is <code>https://my-auth-server.com</code>.
If the <code>iss</code> claim of the issued JWT is set to <code>https://my-auth-server.com/realms/my-app</code>, the above line will build an internal URL to the metadata endpoint of the same server and profile/realm, which is that case would be <code>https://keycloak:8080/realms/my-app/.well-known/openid-configuration</code></p></div></div></div></div></div><div class=sect1><h2 id=_jwt>JWT</h2><div class=sectionbody><div class=paragraph><p>As the <a href=#_oauth2_introspection>OAuth2 Introspection</a> authenticator, this authenticator handles requests that have a Bearer token in the <code>Authorization</code> header, in a different header, a query parameter or a body parameter as well. Unlike the OAuth2 Introspection authenticator it expects the token to be a JSON Web Token (JWT) and verifies it according <a href=https://www.rfc-editor.org/rfc/rfc7519#section-7.2>RFC 7519, Section 7.2</a>. It does however not support encrypted payloads and nested JWTs. In addition to this, validation includes the verification of the time validity. Latter can be adjusted by specifying a leeway. All other validation options can and should be configured.</p></div><div class=paragraph><p>To enable the usage of this authenticator, you have to set the <code>type</code> property to <code>jwt</code>.</p></div><div class=paragraph><p>Configuration using the <code>config</code> property is mandatory. Following properties are available:</p></div><div class=ulist><ul><li><p><strong><code>jwks_endpoint</code></strong>: <em><a href=../../../docs/configuration/types/#_endpoint>Endpoint</a></em> (dependant, not overridable)</p><div class=paragraph><p>The JWKS endpoint, this authenticator retrieves the key material in a format specified in <a href=https://datatracker.ietf.org/doc/html/rfc7519>RFC 7519</a> from for JWT signature verification purposes.</p></div><div class=paragraph><p>The configuration of this property is mutually exclusive with <code>metadata_endpoint</code>. If used, at least the <code>url</code> must be configured. By default <code>method</code> is set to <code>GET</code> and the HTTP <code>Accept</code> header to <code>application/json</code>. The path part of the <code>url</code> can be <a href=../../../docs/mechanisms/evaluation_objects/#_templating>templated</a> and has access to the <code>TokenIssuer</code> object, which is a string and basically holds the value of the <code>iss</code> claim from the token.</p></div></li><li><p><strong><code>metadata_endpoint</code></strong>: <em><a href=../../../docs/configuration/types/#_endpoint>Endpoint</a></em> (dependant, not overridable)</p><div class=paragraph><p>The <a href=https://datatracker.ietf.org/doc/html/rfc8414>OAuth 2.0 Authorization Server Metadata</a> endpoint of the OAuth2, respectively OIDC authorization provider (the <a href=https://openid.net/specs/openid-connect-discovery-1_0.html>OpenID Connect Discovery</a> specification is an OIDC specific profile of that specification). If the JWKS URL is not known upfront, it can be resolved by making use of that endpoint.</p></div><div class=paragraph><p>The configuration of this property is mutually exclusive with <code>jwks_endpoint</code>. If used, at least the <code>url</code> must be configured. As with the <code>jwks_endpoint</code>, the path part of the <code>url</code> can be templated and has access to the <code>TokenIssuer</code> object already introduced above.</p></div><div class=paragraph><p>As with the <code>jwks_endpoint</code> as well, the <code>metadata_endpoint</code> is by default configured to use <code>GET</code> as HTTP method and sets the <code>Accept</code> header to <code>application/json</code>, as also required by both specifications referenced above. In addition, to avoid useless communication, it is also configured to make use of HTTP cache according to <a href=https://tools.ietf.org/html/rfc7234>RFC 7234</a> with default HTTP cache ttl set to <code>30m</code>. All these settings can however be overridden if required.</p></div><div class=paragraph><p>In addition to the properties specified by the <a href=../../../docs/configuration/types/#_endpoint><code>endpoint</code></a> type, following properties are available:</p></div><div class=ulist><ul><li><p><strong><code>disable_issuer_identifier_verification</code></strong>: <em>boolean</em> (optional, not overridable)</p><div class=paragraph><p>Upon retrieval of the server metadata, both, the <a href=https://datatracker.ietf.org/doc/html/rfc8414>OAuth 2.0 Authorization Server Metadata</a> RFC, and the <a href=https://openid.net/specs/openid-connect-discovery-1_0.html>OpenID Connect Discovery</a> specification, require the verification of the issuer identifier for security reasons, e.g. to prevent <a href=https://datatracker.ietf.org/doc/html/rfc8414#section-6.2>Spoofing Attacks</a>. There are however setups, where strictly following that recommendation would result in extended bandwidth usage (instead of communicating directly with the auth server within the cluster one would need to use the same domain, the client application uses, which introduces additional network hops). It might also not work at all as the actual identifier of the issuer would change depending on where the request come from. By making use of this property and setting it to <code>true</code>, one can disable the corresponding verification. Defaults to <code>false</code>.</p></div></li><li><p><strong><code>resolved_endpoints</code></strong>: <em>map of ResolvedEndpoint</em> (optional, not overridable)</p><div class=paragraph><p>A map where each key represents the name of an endpoint as specified in the <a href=https://datatracker.ietf.org/doc/html/rfc8414>OAuth 2.0 Authorization Server Metadata</a> or the <a href=https://openid.net/specs/openid-connect-discovery-1_0.html>OpenID Connect Discovery</a> specifications. The value associated with each key is a set of configuration options that are applied before sending a request to that specific endpoint. Following configuration options are possible:</p></div><div class=ulist><ul><li><p><strong><code>retry</code></strong> <em><a href=../../../docs/configuration/types/#_retry>Retry</a></em> (optional)</p><div class=paragraph><p>What to do if the communication fails. If not configured, no retry attempts are done.</p></div></li><li><p><strong><code>auth</code></strong> <em><a href=../../../docs/configuration/types/#_authentication_strategy>Authentication Strategy</a></em> (optional)</p><div class=paragraph><p>Authentication strategy to apply if the endpoint requires authentication.</p></div></li><li><p><strong><code>http_cache</code></strong> <em><a href=../../../docs/configuration/types/#_http_cache>HTTP Cache</a></em> (optional)</p><div class=paragraph><p>Controls whether HTTP caching according to <a href=https://www.rfc-editor.org/rfc/rfc7234>RFC 7234</a> should be used.</p></div></li></ul></div></li></ul></div></li><li><p><strong><code>jwt_source</code></strong>: <em><a href=../../../docs/configuration/types/#_authentication_data_source>Authentication Data Source</a></em> (optional, not overridable)</p><div class=paragraph><p>Where to get the access token from. Defaults to retrieve it from the <code>Authorization</code> header, the <code>access_token</code> query parameter or the <code>access_token</code> body parameter (latter, if the body is of <code>application/x-www-form-urlencoded</code> MIME type).</p></div></li><li><p><strong><code>assertions</code></strong>: <em><a href=../../../docs/configuration/types/#_assertions>Assertions</a></em> (dependant, overridable)</p><div class=paragraph><p>Configures the required claim assertions. Overriding on rule level is possible even partially. Those parts of the assertion, which have not been overridden are taken from the prototype configuration. If <code>metadata_endpoint</code> is used, the list of issuers is optional, as the issuer will be resolved via the auth server metadata document. Otherwise, the list of issuers is mandatory.</p></div></li><li><p><strong><code>subject</code></strong>: <em><a href=../../../docs/configuration/types/#_subject>Subject</a></em> (optional, not overridable)</p><div class=paragraph><p>Where to extract the subject id from the JWT, as well as which attributes to use. If not configured <code>sub</code> is used to extract the subject id and all attributes from the JWT payload are made available as attributes of the subject.</p></div></li><li><p><strong><code>cache_ttl</code></strong>: <em><a href=../../../docs/configuration/types/#_duration>Duration</a></em> (optional, overridable)</p><div class=paragraph><p>How long to cache the key from the JWKS response, which was used for signature verification purposes. If not set, heimdall will cache this key for 10 minutes and not call JWKS endpoint again if the same <code>kid</code> is referenced in an JWT and same JWKS endpoint is used. The cache key is calculated from the <code>jwks_endpoint</code> configuration and the <code>kid</code> referenced in the JWT.</p></div></li><li><p><strong><code>allow_fallback_on_error</code></strong>: <em>boolean</em> (optional, overridable)</p><div class=paragraph><p><strong>Deprecated:</strong> As of v0.16.0, this property is ineffective and will be removed in v0.17.0. Refer to the authentication stage description in the <a href=../../../docs/concepts/pipelines/#_authentication_authorization_pipeline>Authentication & Authorization Pipline</a> for details on the current behavior.</p></div></li><li><p><strong><code>validate_jwk</code></strong>: <em>boolean</em> (optional, not overridable)</p><div class=paragraph><p>Enables or disables the verification of the JWK certificate used for JWT signature verification purposes. Effective only if the JWK contains a certificate. The verification happens according to <a href=https://www.rfc-editor.org/rfc/rfc5280#section-6.1>RFC 5280, section 6.1</a> and also includes the check, that the certificate is allowed to be used for signature verification purposes. Revocation check is not supported. Defaults to <code>true</code>.</p></div></li><li><p><strong><code>trust_store</code></strong>: <em>string</em> (optional, not overridable)</p><div class=paragraph><p>The path to a PEM file containing the trust anchors, to be used for the JWK certificate validation. Defaults to system trust store.</p></div></li></ul></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content>If a JWT does not reference a <code>kid</code>, heimdall always fetches a JWKS from the configured endpoint (so no caching is done) and iterates over the received keys until one matches. If none matches, the authenticator fails.</td></tr></tbody></table></div><div class=exampleblock><div class=title>Example 9. Minimal possible configuration based on the JWKS endpoint</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=yaml><span class=na>id</span><span class=pi>:</span> <span class=s>at_jwt</span>
<span class=na>type</span><span class=pi>:</span> <span class=s>jwt</span>
<span class=na>config</span><span class=pi>:</span>
  <span class=na>jwks_endpoint</span><span class=pi>:</span>
    <span class=na>url</span><span class=pi>:</span> <span class=s>https://hydra:4444/.well-known/jwks.json</span>
  <span class=na>assertions</span><span class=pi>:</span>
    <span class=na>issuers</span><span class=pi>:</span>
      <span class=pi>-</span> <span class=s>https://127.0.0.1:4444/</span></code></pre></div></div></div></div><div class=exampleblock><div class=title>Example 10. Configuration for Keycloak utilizing metadata discovery and HTTP cache enabled for the resolved <code>jwks_uri</code>.</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=yaml><span class=na>id</span><span class=pi>:</span> <span class=s>keycloak</span>
<span class=na>type</span><span class=pi>:</span> <span class=s>jwt</span>
<span class=na>config</span><span class=pi>:</span>
  <span class=na>metadata_endpoint</span><span class=pi>:</span>
    <span class=na>url</span><span class=pi>:</span> <span class=s>https://keycloak:8080/realms/my-app/.well-known/openid-configuration</span>
    <span class=na>resolved_endpoints</span><span class=pi>:</span>
      <span class=na>jwks_uri</span><span class=pi>:</span>
        <span class=na>http_cache</span><span class=pi>:</span>
          <span class=na>enabled</span><span class=pi>:</span> <span class=kc>true</span>
  <span class=c1># Note that no assertions are configured here, since it&#39;ll be resolved via the metadata endpoint</span></code></pre></div></div></div></div></div></div></linkable-headline-area></div><p class="text-end fst-italic fs-7 pb-3">Last updated on <span class=fw-bold>Apr 8, 2025</span></p><hr><div class="d-flex justify-content-between py-3"><a href=../../../docs/mechanisms/evaluation_objects/ class="fs-6 fw-bold text-dark link-secondary link-underline-opacity-0"><svg width="16" height="16" fill="currentcolor" class="bi bi-chevron-left" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M11.354 1.646a.5.5.0 010 .708L5.707 8l5.647 5.646a.5.5.0 01-.708.708l-6-6a.5.5.0 010-.708l6-6a.5.5.0 01.708.0z"/></svg>
Objects, Templating & Co
</a><a class="ms-auto fs-6 fw-bold text-dark link-secondary link-underline-opacity-0" href=../../../docs/mechanisms/authorizers/>Authorizers<svg width="16" height="16" fill="currentcolor" class="bi bi-chevron-right" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4.646 1.646a.5.5.0 01.708.0l6 6a.5.5.0 010 .708l-6 6a.5.5.0 01-.708-.708L10.293 8 4.646 2.354a.5.5.0 010-.708z"/></svg></a></div></div></main></div><footer class="footer py-4 py-md-5 px-4 px-md-3 mt-3"><div class=container><div class=row><div class="col-lg-3 mb-3"><p class=fs-5>Heimdall</p><ul class="list-unstyled small text-muted"><li class=mb-2>2022-2024 © Heimdall Project Authors. All rights reserved.</li><li class=mb-2><a href=https://github.com/dadrus/heimdall/blob/master/LICENSE>Apache 2.0 licensed</a></li></ul></div><div class="col-6 col-lg-2 offset-lg-1 mb-3"><h5>Links</h5><ul class=list-unstyled><li class=mb-2><a href=../../../>Home</a></li><li class=mb-2><a href=../../../docs/getting_started/discover_heimdall>Docs</a></li><li class=mb-2><a href=../../../guides/>Guides</a></li><li class=mb-2><a href=../../../openapi/>API</a></li></ul></div><div class="col-6 col-lg-2 mb-2"><h5>Guides</h5><ul class=list-unstyled><li class=mb-2><a href=../../../guides/proxies/>API Gateways & Proxies</a></li><li class=mb-2><a href=../../../guides/authz/>Authorization Services</a></li><li class=mb-2><a href=../../../guides/authn/>Authentication Protocols & Services</a></li></ul></div><div class="col-6 col-lg-2 mb-2"><h5>Community</h5><ul class=list-unstyled><li class=mb-2><a href=https://github.com/dadrus/heimdall>Github</a></li><li class=mb-2><a href=https://discord.gg/qQgg8xKuyb>Discord</a></li></ul></div></div></div></footer><script src=../../../js/main.js defer></script></body></html>