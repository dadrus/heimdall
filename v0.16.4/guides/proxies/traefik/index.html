<!doctype html><html lang=en><head><title>Traefik Proxy Integration</title>
<meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="An open source Identity Aware Proxy and an Access Control Decision service for cloud native applications"><meta name=dc.relation content="https://dadrus.github.io/"><meta name=theme-color content="#1A94D2"><link rel=stylesheet href=../../../css/styles.min.css media=screen><link rel='shortcut icon' type=image/x-icon href=../../../favicon.ico></head><body><header class="navbar navbar-expand-md navbar-dark bg-dark sticky-top"><nav class="container-xxl flex-wrap flex-lg-nowrap px-0" aria-label="Main navigation"><button class="btn btn-outline-dark d-lg-none navbar-toggler border-0 shadow-none ps-3" type=button data-bs-toggle=offcanvas data-bs-target=#docsMenuContent aria-controls=docsMenuContent aria-expanded=false aria-label="Open docs menu"><svg width="36" height="36" fill="currentcolor" class="bi bi-list" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M2.5 12a.5.5.0 01.5-.5h10a.5.5.0 010 1H3a.5.5.0 01-.5-.5m0-4a.5.5.0 01.5-.5h10a.5.5.0 010 1H3A.5.5.0 012.5 8m0-4a.5.5.0 01.5-.5h10a.5.5.0 010 1H3A.5.5.0 012.5 4"/></svg></button><nav class="offcanvas offcanvas-start d-md-none text-bg-light" tabindex=-1 id=docsMenuContent aria-labelledby=docsMenuContentLabel><div class=offcanvas-header><h5 class=offcanvas-title id=docsMenuContentLabel>Browse guides</h5><button type=button class=btn-close data-bs-dismiss=offcanvas aria-label="Close docs menu"></button></div><div class="offcanvas-body docs-sidebar"><div class=docs-search-button><button type=button class="btn btn-outline-secondary mb-3 d-none d-md-block w-100 text-start" data-bs-toggle=modal data-bs-target=#docSearch aria-controls=docSearch aria-expanded=false aria-label="Open search">
<svg width="20" height="20" fill="currentcolor" class="bi bi-search me-2" viewBox="0 0 20 20"><path d="M11.742 10.344a6.5 6.5.0 10-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 001.415-1.414l-3.85-3.85a1 1 0 00-.115-.1zM12 6.5a5.5 5.5.0 11-11 0 5.5 5.5.0 0111 0"/></svg>
<span>Quick search...</span></button></div><nav id=SideBarToc><ul><li><span>API Gateways & Proxies</span><ul><li><a href=../../../guides/proxies/caddy/>Caddy Integration</a></li><li><a href=../../../guides/proxies/contour/>Contour Integration</a></li><li><a href=../../../guides/proxies/emissary/>Emissary Ingress Integration</a></li><li><a href=../../../guides/proxies/envoy/>Envoy Integration</a></li><li><a href=../../../guides/proxies/envoy_gateway/>Envoy Gateway Integration</a></li><li><a href=../../../guides/proxies/haproxy/>HAProxy Integration</a></li><li><a href=../../../guides/proxies/istio/>Istio Service Mesh Integration</a></li><li><a href=../../../guides/proxies/nginx/>NGINX Integration</a></li><li><a class=active href=../../../guides/proxies/traefik/>Traefik Proxy Integration</a></li></ul></li><li><span>Authorization Services</span><ul><li><a href=../../../guides/authz/opa/>Integration with OPA</a></li><li><a href=../../../guides/authz/openfga/>Integration with OpenFGA</a></li></ul></li><li><span>Authentication Protocols & Services</span><ul><li><a href=../../../guides/authn/oidc_first_party_auth/>First-Party Authentication with OpenID Connect</a></li></ul></li></ul></nav></div></nav><div class="d-flex align-items-center px-4"><a class="navbar-brand navbar-brand-highlight text-white me-0" href=../../../ style=font-weight:500;font-size:1.5rem>Heimdall</a><ul class="navbar-nav d-none d-md-flex ms-3"><li class=nav-item><a class='nav-link text-white' href=../../../docs/getting_started/discover_heimdall>Docs</a></li><li class=nav-item><a class='nav-link text-white active' href=../../../guides/>Guides</a></li><li class=nav-item><a class='nav-link text-white' href=../../../openapi/>API</a></li></ul></div><div class=d-flex><button type=button class="btn btn-outline-dark navbar-toggler border-0 shadow-none" data-bs-toggle=modal data-bs-target=#docSearch aria-controls=docSearch aria-expanded=false aria-label="Open search">
<span class="bi bi-search"></span>
</button>
<button class="btn btn-outline-dark navbar-toggler border-0 shadow-none pe-3" type=button data-bs-toggle=offcanvas data-bs-target=#mainMenuContent aria-controls=mainMenuContent aria-expanded=false aria-label="Open main menu"><svg width="24" height="24" fill="currentcolor" class="bi bi-three-dots" viewBox="0 0 16 16"><path d="M3 9.5a1.5 1.5.0 110-3 1.5 1.5.0 010 3m5 0a1.5 1.5.0 110-3 1.5 1.5.0 010 3m5 0a1.5 1.5.0 110-3 1.5 1.5.0 010 3"/></svg></button><div class="offcanvas offcanvas-end text-bg-dark" tabindex=-1 id=mainMenuContent aria-labelledby=mainMenuContentLabel><div class=offcanvas-header><h5 class="offcanvas-title text-white" id=mainMenuContentLabel>Heimdall</h5><button type=button class="btn-close btn-close-white" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class=offcanvas-body><ul class="navbar-nav flex-column d-md-none d-lg-none d-xl-none"><li class=nav-item><a class='nav-link text-white' href=../../../docs/getting_started/discover_heimdall>Docs</a></li><li class=nav-item><a class='nav-link text-white active' href=../../../guides/>Guides</a></li><li class=nav-item><a class='nav-link text-white' href=../../../openapi/>API</a></li></ul><hr class="text-white-50 d-md-none"><ul class="navbar-nav flex-column ms-auto"><doc-version-select class="nav-item dropdown" version-file=/heimdall/data.json current-version=v0.16.4 current-page=/guides/proxies/traefik/><button class="btn btn-dark dropdown-toggle me-4" data-bs-toggle=dropdown aria-expanded=false>
v0.16.4</button></doc-version-select></ul><ul class="navbar-nav flex-column"><li class="nav-item mb-1 pe-4"><a class="nav-link text-white" style=align-self:center href=https://github.com/dadrus/heimdall><svg role="img" width="20" height="20" fill="currentcolor" class="bi bi-github text-white" viewBox="0 0 16 16"><title>GitHub</title><path d="M8 0C3.58.0.0 3.58.0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38.0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95.0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12.0.0.67-.21 2.2.82.64-.18 1.32-.27 2-.27s1.36.09 2 .27c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15.0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48.0 1.07-.01 1.93-.01 2.2.0.21.15.46.55.38A8.012 8.012.0 0016 8c0-4.42-3.58-8-8-8z"/></svg>
<small class="ms-2 d-md-none">GitHub</small></a></li></ul></div></div></div></nav></header><div class=modal id=docSearch tabindex=-1 aria-labelledby=docSearchLabel aria-hidden=true><doc-search class="col-auto me-auto mw-75" index-file=/heimdall/v0.16.4/index.json path-prefix=/heimdall/v0.16.4><div class="modal-dialog modal-lg modal-dialog-scrollable"><div class=modal-content><div class="modal-header p-2"><div class=input-group><div class="input-group-text bg-body border-0 fs-4"><svg width="16" height="16" fill="currentcolor" class="bi bi-search text-secondary my-0" viewBox="0 0 16 16"><path d="M11.742 10.344a6.5 6.5.0 10-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 001.415-1.414l-3.85-3.85a1 1 0 00-.115-.1zM12 6.5a5.5 5.5.0 11-11 0 5.5 5.5.0 0111 0"/></svg></div><input id=search-input class="form-control search-bar border-0" type=search placeholder="Search documentation " aria-label="Search docs..." autocomplete=off autofocus><div class="input-group-text bg-body border-0"><a class="btn input-group-text text-muted border p-1 bg-light-subtle fs-7 fw-bold font-monospace" data-bs-dismiss=modal aria-label=Close>ESC</a></div></div></div><div class=modal-body><div class=search-results><p class="text-center mt-5">No recent searches</p></div></div><div class=modal-footer></div></div></div></doc-search></div><div class="container-xxl docs-layout px-4"><aside class="d-none pe-3 docs-sidebar"><div class=docs-search-button><button type=button class="btn btn-outline-secondary mb-3 d-none d-md-block w-100 text-start" data-bs-toggle=modal data-bs-target=#docSearch aria-controls=docSearch aria-expanded=false aria-label="Open search">
<svg width="20" height="20" fill="currentcolor" class="bi bi-search me-2" viewBox="0 0 20 20"><path d="M11.742 10.344a6.5 6.5.0 10-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 001.415-1.414l-3.85-3.85a1 1 0 00-.115-.1zM12 6.5a5.5 5.5.0 11-11 0 5.5 5.5.0 0111 0"/></svg>
<span>Quick search...</span></button></div><nav id=SideBarToc><ul><li><span>API Gateways & Proxies</span><ul><li><a href=../../../guides/proxies/caddy/>Caddy Integration</a></li><li><a href=../../../guides/proxies/contour/>Contour Integration</a></li><li><a href=../../../guides/proxies/emissary/>Emissary Ingress Integration</a></li><li><a href=../../../guides/proxies/envoy/>Envoy Integration</a></li><li><a href=../../../guides/proxies/envoy_gateway/>Envoy Gateway Integration</a></li><li><a href=../../../guides/proxies/haproxy/>HAProxy Integration</a></li><li><a href=../../../guides/proxies/istio/>Istio Service Mesh Integration</a></li><li><a href=../../../guides/proxies/nginx/>NGINX Integration</a></li><li><a class=active href=../../../guides/proxies/traefik/>Traefik Proxy Integration</a></li></ul></li><li><span>Authorization Services</span><ul><li><a href=../../../guides/authz/opa/>Integration with OPA</a></li><li><a href=../../../guides/authz/openfga/>Integration with OpenFGA</a></li></ul></li><li><span>Authentication Protocols & Services</span><ul><li><a href=../../../guides/authn/oidc_first_party_auth/>First-Party Authentication with OpenID Connect</a></li></ul></li></ul></nav></aside><main class=docs-main><div class="d-md-none docs-location bg-body"><nav style="--bs-breadcrumb-divider:'>'" aria-label=breadcrumb><ol class="breadcrumb mb-0"><li class="breadcrumb-item fw-bold">API Gateways & Proxies</li><li class="breadcrumb-item active" aria-current=page>Traefik Proxy Integration</li></ol></nav></div><div class="docs-intro pt-3 pe-3"><h1>Traefik Proxy Integration</h1><p>This guide explains how to integrate heimdall with Traefik Proxy.</p></div><aside class="text-muted docs-toc"><strong class="d-md-block h6 pb-2 my-2 ms-2 border-bottom d-none d-md-none d-lg-block">On this page</strong><div id=page-content-toc class="mt-1 mb-3 text-muted d-none d-md-none d-lg-block docs-toc-content"><nav id=TableOfContents><ul><li><a href=#_prerequisites>Prerequisites</a></li><li><a href=#_global_configuration>Global Configuration</a><ul><li><a href=#_regular_deployment>Regular Deployment</a></li><li><a href=#_kubernetes_deployment>Kubernetes Deployment</a></li></ul></li><li><a href=#_route_based_configuration_with_docker>Route-based Configuration with Docker</a></li><li><a href=#_traefik_as_ingress_controller>Traefik as Ingress Controller</a></li><li><a href=#_traefik_as_gateway_api_implementation>Traefik as Gateway API implementation</a></li><li><a href=#_additional_resources>Additional Resources</a></li></ul></nav></div><button class="btn btn-outline-secondary text-decoration-none d-lg-none collapsed" type=button data-bs-toggle=collapse data-bs-target=#page-content-toc-collapsible aria-expanded=false aria-controls=page-content-toc-collapsible>
On this page<svg width="16" height="16" fill="currentcolor" class="bi bi-chevron-expand" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M3.646 9.146a.5.5.0 01.708.0L8 12.793l3.646-3.647a.5.5.0 01.708.708l-4 4a.5.5.0 01-.708.0l-4-4a.5.5.0 010-.708m0-2.292a.5.5.0 00.708.0L8 3.207l3.646 3.647a.5.5.0 00.708-.708l-4-4a.5.5.0 00-.708.0l-4 4a.5.5.0 000 .708"/></svg></button><div id=page-content-toc-collapsible class="mt-1 mb-3 text-muted d-lg-none collapse docs-toc-content"><div class="card card-body"><nav id=TableOfContents><ul><li><a href=#_prerequisites>Prerequisites</a></li><li><a href=#_global_configuration>Global Configuration</a><ul><li><a href=#_regular_deployment>Regular Deployment</a></li><li><a href=#_kubernetes_deployment>Kubernetes Deployment</a></li></ul></li><li><a href=#_route_based_configuration_with_docker>Route-based Configuration with Docker</a></li><li><a href=#_traefik_as_ingress_controller>Traefik as Ingress Controller</a></li><li><a href=#_traefik_as_gateway_api_implementation>Traefik as Gateway API implementation</a></li><li><a href=#_additional_resources>Additional Resources</a></li></ul></nav></div></div></aside><div class="docs-content pe-3"><div data-bs-spy=scroll data-bs-target=#page-content-toc class=mt-3><linkable-headline-area><div class=paragraph><p><a href=https://doc.traefik.io/traefik/>Traefik Proxy</a> is a modern HTTP proxy and load balancer for microservices, heimdall can be integrated with via the <a href=https://doc.traefik.io/traefik/middlewares/http/forwardauth/>ForwardAuth Middleware</a>. If heimdall answers with a 2XX code, traefik grants access and forwards the original request to the upstream service. Otherwise, the response from heimdall is returned to the client.</p></div><div class=sect1><h2 id=_prerequisites>Prerequisites</h2><div class=sectionbody><div class=ulist><ul><li><p>Integration with traefik requires heimdall being operated in <a href=../../../docs/concepts/operating_modes/#_decision_mode>Decision Operation Mode</a>.</p></li></ul></div><div class="admonitionblock caution"><table><tbody><tr><td class=icon><i class="fa icon-caution" title=Caution></i></td><td class=content><div class=paragraph><p>Traefik makes use of <code>X-Forwarded-*</code> HTTP headers to forward the HTTP method, protocol, host, etc. to the ForwardAuth middleware. By default, heimdall does not trust those. To allow heimdall making use of such headers, you must configure <a href=../../../docs/services/main/#_trusted_proxies>trusted proxies</a> in heimdall’s main service configuration to contain the IPs or networks of your traefik instances. For test purposes, you can set it to "0.0.0.0/0", which would basically disable the check and let heimdall trust requests from any source.</p></div></td></tr></tbody></table></div><div class=paragraph><p>Traefik can be configured statically, but also load dynamic configuration from many sources managed by so-called providers. The following sections describe how to integrate with heimdall using some of them.</p></div></div></div><div class=sect1><h2 id=_global_configuration>Global Configuration</h2><div class=sectionbody><div class=paragraph><p>To let Traefik forward all incoming requests to heimdall, there is a need</p></div><div class=ulist><ul><li><p>to configure the <a href=https://doc.traefik.io/traefik/middlewares/http/forwardauth/>ForwardAuth</a> middleware, and</p></li><li><p>to add it to the list of <a href=https://doc.traefik.io/traefik/routing/entrypoints/#middlewares>middlewares</a> that are prepended by default to the list of middlewares of each router associated to a named entry point.</p></li></ul></div><div class=sect2><h3 id=_regular_deployment>Regular Deployment</h3><div class=paragraph><p>If you are using Traefik outside of kubernetes, the above can be achieved by the following static configuration</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=yaml><span class=na>entryPoints</span><span class=pi>:</span>
  <span class=na>web</span><span class=pi>:</span>
    <span class=na>address</span><span class=pi>:</span> <span class=s2>&#34;</span><span class=s>:8080&#34;</span>
    <span class=na>middlewares</span><span class=pi>:</span> <i class=conum data-value=1></i><b>(1)</b>
    <span class=pi>-</span> <span class=s>heimdall</span>

<span class=na>http</span><span class=pi>:</span>
  <span class=na>middlewares</span><span class=pi>:</span>
    <span class=na>heimdall</span><span class=pi>:</span> <i class=conum data-value=2></i><b>(2)</b>
      <span class=na>forwardAuth</span><span class=pi>:</span> <i class=conum data-value=3></i><b>(3)</b>
        <span class=na>address</span><span class=pi>:</span> <span class=s2>&#34;</span><span class=s>https://heimdall:4456&#34;</span> <i class=conum data-value=4></i><b>(4)</b>
        <span class=na>authResponseHeaders</span><span class=pi>:</span>
        <span class=pi>-</span> <span class=s>Authorization</span> <i class=conum data-value=5></i><b>(5)</b></code></pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>The list of default middlewares. Here only the middleware named "heimdall" is included. That way, traefik will use this middleware for each and every request.</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>The definition of the middleware named "heimdall"</td></tr><tr><td><i class=conum data-value=3></i><b>3</b></td><td>which is of type <a href=https://doc.traefik.io/traefik/middlewares/http/forwardauth/><code>forwardAuth</code></a></td></tr><tr><td><i class=conum data-value=4></i><b>4</b></td><td>Configures this middleware to forward requests to a service available under "heimdall" DNS name</td></tr><tr><td><i class=conum data-value=5></i><b>5</b></td><td>Configures this middleware to forward the <code>Authorization</code> header from heimdall’s response to the upstream service</td></tr></tbody></table></div></div><div class=sect2><h3 id=_kubernetes_deployment>Kubernetes Deployment</h3><div class=paragraph><p>If you are using Traefik as <a href=https://kubernetes.io/docs/concepts/services-networking/ingress-controllers/>Ingress Controller</a> or as <a href=https://gateway-api.sigs.k8s.io/>Gateway API</a> implementation in your kubernetes cluster, the required configuration is slightly different. The configuration of the entry point(s) stays the same, but the middleware needs to be deployed as a custom resource.</p></div><div class=paragraph><p>Here an example for a <a href=https://doc.traefik.io/traefik/routing/providers/kubernetes-crd/#kind-middleware><code>Middleware</code></a> custom resource:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=yaml><span class=na>apiVersion</span><span class=pi>:</span> <span class=s>traefik.io/v1alpha1</span>
<span class=na>kind</span><span class=pi>:</span> <span class=s>Middleware</span>
<span class=na>metadata</span><span class=pi>:</span> <i class=conum data-value=1></i><b>(1)</b>
  <span class=na>name</span><span class=pi>:</span> <span class=s>heimdall</span>
  <span class=na>namespace</span><span class=pi>:</span> <span class=s>heimdall</span>
<span class=na>spec</span><span class=pi>:</span>
  <span class=na>forwardAuth</span><span class=pi>:</span> <i class=conum data-value=2></i><b>(2)</b>
    <span class=na>address</span><span class=pi>:</span> <span class=s2>&#34;</span><span class=s>https://heimdall.heimdall.svc.cluster.local:4456&#34;</span> <i class=conum data-value=3></i><b>(3)</b>
    <span class=na>authResponseHeaders</span><span class=pi>:</span> <i class=conum data-value=4></i><b>(4)</b>
      <span class=pi>-</span> <span class=s>Authorization</span></code></pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>The name and the namespace of the middleware. Both are set to <code>heimdall</code> here</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>The type of the middleware, which is of type <a href=https://doc.traefik.io/traefik/middlewares/http/forwardauth/><code>forwardAuth</code></a></td></tr><tr><td><i class=conum data-value=3></i><b>3</b></td><td>Configures this middleware to forward requests to the heimdall service. Here, the corresponding <code>Service</code> is named <code>heimdall</code> and is also located in the namespace named <code>heimdall</code>.</td></tr><tr><td><i class=conum data-value=4></i><b>4</b></td><td>Configures this middleware to forward the <code>Authorization</code> header from heimdall’s response to the upstream service</td></tr></tbody></table></div><div class=paragraph><p>How to add this middleware to the default middleware list of a particular endpoint depends on the method used to install Traefik. If helm is used, you can configure that list by making use of the following <code>values.yaml</code> file:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=yaml><span class=na>providers</span><span class=pi>:</span>
  <span class=na>kubernetesCRD</span><span class=pi>:</span>
    <span class=na>enabled</span><span class=pi>:</span> <span class=kc>true</span> <i class=conum data-value=1></i><b>(1)</b>

<span class=na>ports</span><span class=pi>:</span>
  <span class=na>web</span><span class=pi>:</span> <i class=conum data-value=2></i><b>(2)</b>
    <span class=na>middlewares</span><span class=pi>:</span>
      <span class=pi>-</span> <span class=s>heimdall-heimdall@kubernetescrd</span> <i class=conum data-value=3></i><b>(3)</b>
  <span class=na>websecure</span><span class=pi>:</span> <i class=conum data-value=4></i><b>(4)</b>
    <span class=na>middlewares</span><span class=pi>:</span>
      <span class=pi>-</span> <span class=s>heimdall-heimdall@kubernetescrd</span></code></pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>To let traefik load <code>Middleware</code> resources, like defined above, traefik’s <code>kubernetesCRD</code> provider must be enabled. Typically, it is enabled by default.</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>Traefik’s helm chart defines two entry points <code>web</code> for HTTP traffic and <code>websecure</code> for HTTPS traffic. Here we configure the <code>web</code> endpoint to use our middleware</td></tr><tr><td><i class=conum data-value=3></i><b>3</b></td><td>Reference to the <code>Middleware</code> resource, defined above. The general structure is <code>&lt;middleware name>-&lt;middleware namespace>@&lt;provider></code>. Since our middleware resource is loaded by the <code>kubernetescrd</code> provider, resides in the <code>heimdall</code> namespace, and is named <code>heimdall</code>, the reference <code>heimdall-heimdall@kubernetescrd</code> is used.</td></tr><tr><td><i class=conum data-value=4></i><b>4</b></td><td>Here we configure the <code>websecure</code> endpoint, which, as written above, is configured via helm chart for HTTPS traffic. The actual configuration is identical to the configuration for the <code>web</code> endpoint.</td></tr></tbody></table></div></div></div></div><div class=sect1><h2 id=_route_based_configuration_with_docker>Route-based Configuration with Docker</h2><div class=sectionbody><div class=paragraph><p>The integration option, described here makes use of the <a href=https://doc.traefik.io/traefik/providers/docker/>Docker Provider</a> for configuration discovery.</p></div><div class=paragraph><p>The following <code>docker-compose.yaml</code> file shows a minimal required configuration.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=yaml><span class=na>services</span><span class=pi>:</span>
  <span class=na>proxy</span><span class=pi>:</span>
    <span class=na>image</span><span class=pi>:</span> <span class=s>traefik:2.11.0</span>
    <span class=na>ports</span><span class=pi>:</span>
    <span class=pi>-</span> <span class=s2>&#34;</span><span class=s>9090:9090&#34;</span>
    <span class=na>command</span><span class=pi>:</span> <span class=pi>&gt;</span>
      <span class=s>--providers.docker=true </span><i class=conum data-value=1></i><b>(1)</b>
      <span class=s>--providers.docker.exposedbydefault=false</span>
      <span class=s>--entryPoints.http.address=&#34;:9090&#34;</span>
    <span class=na>volumes</span><span class=pi>:</span>
    <span class=pi>-</span> <span class=s2>&#34;</span><span class=s>/var/run/docker.sock:/var/run/docker.sock:ro&#34;</span> <i class=conum data-value=2></i><b>(2)</b>
    <span class=c1># other config options</span>
    <span class=na>labels</span><span class=pi>:</span>
    <span class=c1># other labels</span>
    <span class=pi>-</span> <span class=s>traefik.http.middlewares.heimdall.forwardauth.address=https://heimdall:4456</span> <i class=conum data-value=3></i><b>(3)</b>
    <span class=pi>-</span> <span class=s>traefik.http.middlewares.heimdall.forwardauth.authResponseHeaders=Authorization</span> <i class=conum data-value=4></i><b>(4)</b>

  <span class=na>heimdall</span><span class=pi>:</span>
    <span class=na>image</span><span class=pi>:</span> <span class=s>dadrus/heimdall:{{ github.ref_name }}</span>
    <span class=c1># further config</span>

  <span class=na>upstream</span><span class=pi>:</span>
    <span class=c1># image and config of your upstream service</span>
    <span class=na>labels</span><span class=pi>:</span>
    <span class=c1># other labels</span>
    <span class=pi>-</span> <span class=s>traefik.http.routers.upstream.middlewares=heimdall</span> <i class=conum data-value=5></i><b>(5)</b></code></pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>This and the next line configures the docker provider</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>The docker provider reads the configuration from labels of the services and requires access to the docker socket for this purpose</td></tr><tr><td><i class=conum data-value=3></i><b>3</b></td><td>Configuration of the <a href=https://doc.traefik.io/traefik/middlewares/http/forwardauth/>ForwardAuth</a> middleware to forward incoming requests to heimdall. The name of middleware is set to "heimdall" here.</td></tr><tr><td><i class=conum data-value=4></i><b>4</b></td><td>Configuration of the ForwardAuth middleware to forward the <code>Authorization</code> header from heimdall’s response to the upstream service</td></tr><tr><td><i class=conum data-value=5></i><b>5</b></td><td>Configuration of the required middlewares on the route level of a particular service. Here only the middleware named "heimdall" is referenced. Without that label, traefik will not forward requests to heimdall before routing them to that upstream service.</td></tr></tbody></table></div></div></div><div class=sect1><h2 id=_traefik_as_ingress_controller>Traefik as Ingress Controller</h2><div class=sectionbody><div class=paragraph><p>If you have Traefik as Ingress Controller in your Kubernetes cluster, you can simply integrate heimdall globally as described in <a href=#_global_configuration>Global Configuration</a> chapter above and make use of the standard <a href=https://kubernetes.io/docs/concepts/services-networking/ingress/>Ingress resource</a>.</p></div><div class=paragraph><p>If you are using traefik’s proprietary <a href=https://doc.traefik.io/traefik/routing/providers/kubernetes-crd/#kind-ingressroute><code>IngressRoute</code></a> custom resource instead of kubernetes standard <a href=https://kubernetes.io/docs/concepts/services-networking/ingress/><code>Ingress</code></a> one, you can also reference the <a href=https://doc.traefik.io/traefik/routing/providers/kubernetes-crd/#kind-middleware><code>Middleware</code></a> resource locally. This option is shown in the snippet below.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=yaml><span class=na>apiVersion</span><span class=pi>:</span> <span class=s>traefik.io/v1alpha1</span>
<span class=na>kind</span><span class=pi>:</span> <span class=s>IngressRoute</span>
<span class=na>metadata</span><span class=pi>:</span> <i class=conum data-value=1></i><b>(1)</b>
  <span class=na>name</span><span class=pi>:</span> <span class=s>demo-app</span>
  <span class=na>namespace</span><span class=pi>:</span> <span class=s>demo</span>
<span class=na>spec</span><span class=pi>:</span>
  <span class=na>entryPoints</span><span class=pi>:</span>
    <span class=pi>-</span> <span class=s>web</span> <i class=conum data-value=2></i><b>(2)</b>
  <span class=na>routes</span><span class=pi>:</span>
    <span class=pi>-</span> <span class=na>kind</span><span class=pi>:</span> <span class=s>Rule</span>
      <span class=na>match</span><span class=pi>:</span> <span class=s>Host(`demo-app.local`) &amp;&amp; PathPrefix(`/`)</span>
      <span class=na>middlewares</span><span class=pi>:</span> <i class=conum data-value=3></i><b>(3)</b>
        <span class=pi>-</span> <span class=na>name</span><span class=pi>:</span> <span class=s>heimdall</span>
          <span class=na>namespace</span><span class=pi>:</span> <span class=s>heimdall</span>
      <span class=na>services</span><span class=pi>:</span> <i class=conum data-value=4></i><b>(4)</b>
        <span class=pi>-</span> <span class=na>kind</span><span class=pi>:</span> <span class=s>Service</span>
          <span class=na>name</span><span class=pi>:</span> <span class=s>demo-app</span>
          <span class=na>namespace</span><span class=pi>:</span> <span class=s>demo</span>
          <span class=na>port</span><span class=pi>:</span> <span class=s>app-port</span></code></pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td><code>metadata</code>, like name and the namespace of the <code>IngressRoute</code> resource</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>The traefik entry points to attach this resource to. Here only <code>web</code> entry point is referenced</td></tr><tr><td><i class=conum data-value=3></i><b>3</b></td><td>List of the middlewares to be applied. Here the <code>Middleware</code> named <code>heimdall</code> in the namespace <code>heimdall</code> is referenced.<div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content>By default, <code>IngressRoute</code> resources are not allowed to reference resources in namespaces different from the own namespace. If your <code>Middleware</code> resource, like also shown here, is deployed in another namespace, you have to allow that. If traefik is installed via helm, it can be achieved by setting <code>providers.kubernetesCRD.allowCrossNamespace</code> to <code>true</code> (See also <a href=https://doc.traefik.io/traefik/providers/kubernetes-crd/#allowcrossnamespace>here</a>).</td></tr></tbody></table></div></td></tr><tr><td><i class=conum data-value=4></i><b>4</b></td><td>The reference to the <code>Service</code>, the requests should be forwarded to.</td></tr></tbody></table></div></div></div><div class=sect1><h2 id=_traefik_as_gateway_api_implementation>Traefik as Gateway API implementation</h2><div class=sectionbody><div class=paragraph><p>If you have Traefik as <a href=https://gateway-api.sigs.k8s.io/>Gateway API</a> implementation in your Kubernetes cluster, you can simply integrate heimdall globally as described in <a href=#_kubernetes_deployment>Global Configuration</a> chapter above and make use of the standard <a href=https://gateway-api.sigs.k8s.io/api-types/httproute><code>HTTPRoute</code></a> resource.</p></div></div></div><div class=sect1><h2 id=_additional_resources>Additional Resources</h2><div class=sectionbody><div class=paragraph><p>A fully working example with Traefik is shown in the <a href=../../../docs/getting_started/protect_an_app/>Protect an Application</a> quickstart and is also available on <a href=https://github.com/dadrus/heimdall/tree/main/examples>GitHub</a>.</p></div></div></div></linkable-headline-area></div><p class="text-end fst-italic fs-7 pb-3">Last updated on <span class=fw-bold>Apr 8, 2025</span></p><hr><div class="d-flex justify-content-between py-3"><a href=../../../guides/proxies/nginx/ class="fs-6 fw-bold text-dark link-secondary link-underline-opacity-0"><svg width="16" height="16" fill="currentcolor" class="bi bi-chevron-left" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M11.354 1.646a.5.5.0 010 .708L5.707 8l5.647 5.646a.5.5.0 01-.708.708l-6-6a.5.5.0 010-.708l6-6a.5.5.0 01.708.0z"/></svg>
NGINX Integration
</a><a class="ms-auto fs-6 fw-bold text-dark link-secondary link-underline-opacity-0" href=../../../guides/authz/opa/>Integration with OPA<svg width="16" height="16" fill="currentcolor" class="bi bi-chevron-right" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4.646 1.646a.5.5.0 01.708.0l6 6a.5.5.0 010 .708l-6 6a.5.5.0 01-.708-.708L10.293 8 4.646 2.354a.5.5.0 010-.708z"/></svg></a></div></div></main></div><footer class="footer py-4 py-md-5 px-4 px-md-3 mt-3"><div class=container><div class=row><div class="col-lg-3 mb-3"><p class=fs-5>Heimdall</p><ul class="list-unstyled small text-muted"><li class=mb-2>2022-2024 © Heimdall Project Authors. All rights reserved.</li><li class=mb-2><a href=https://github.com/dadrus/heimdall/blob/master/LICENSE>Apache 2.0 licensed</a></li></ul></div><div class="col-6 col-lg-2 offset-lg-1 mb-3"><h5>Links</h5><ul class=list-unstyled><li class=mb-2><a href=../../../>Home</a></li><li class=mb-2><a href=../../../docs/getting_started/discover_heimdall>Docs</a></li><li class=mb-2><a href=../../../guides/>Guides</a></li><li class=mb-2><a href=../../../openapi/>API</a></li></ul></div><div class="col-6 col-lg-2 mb-2"><h5>Guides</h5><ul class=list-unstyled><li class=mb-2><a href=../../../guides/proxies/>API Gateways & Proxies</a></li><li class=mb-2><a href=../../../guides/authz/>Authorization Services</a></li><li class=mb-2><a href=../../../guides/authn/>Authentication Protocols & Services</a></li></ul></div><div class="col-6 col-lg-2 mb-2"><h5>Community</h5><ul class=list-unstyled><li class=mb-2><a href=https://github.com/dadrus/heimdall>Github</a></li><li class=mb-2><a href=https://discord.gg/qQgg8xKuyb>Discord</a></li></ul></div></div></div></footer><script src=../../../js/main.js defer></script></body></html>