<!doctype html><html lang=en><head><title>Authorizers</title>
<meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="An open source Identity Aware Proxy and an Access Control Decision service for cloud native applications"><meta name=dc.relation content="https://dadrus.github.io/"><meta name=theme-color content="#1A94D2"><link rel=stylesheet href=../../../css/styles.min.css media=screen><link rel='shortcut icon' type=image/x-icon href=../../../favicon.ico></head><body><header class="navbar navbar-expand-md navbar-dark bg-dark sticky-top"><nav class="container-xxl flex-wrap flex-lg-nowrap px-0" aria-label="Main navigation"><button class="btn btn-outline-dark d-lg-none navbar-toggler border-0 shadow-none ps-3" type=button data-bs-toggle=offcanvas data-bs-target=#docsMenuContent aria-controls=docsMenuContent aria-expanded=false aria-label="Open docs menu"><svg width="36" height="36" fill="currentcolor" class="bi bi-list" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M2.5 12a.5.5.0 01.5-.5h10a.5.5.0 010 1H3a.5.5.0 01-.5-.5m0-4a.5.5.0 01.5-.5h10a.5.5.0 010 1H3A.5.5.0 012.5 8m0-4a.5.5.0 01.5-.5h10a.5.5.0 010 1H3A.5.5.0 012.5 4"/></svg></button><nav class="offcanvas offcanvas-start d-md-none text-bg-light" tabindex=-1 id=docsMenuContent aria-labelledby=docsMenuContentLabel><div class=offcanvas-header><h5 class=offcanvas-title id=docsMenuContentLabel>Browse docs</h5><button type=button class=btn-close data-bs-dismiss=offcanvas aria-label="Close docs menu"></button></div><div class="offcanvas-body docs-sidebar"><div class=docs-search-button><button type=button class="btn btn-outline-secondary mb-3 d-none d-md-block w-100 text-start" data-bs-toggle=modal data-bs-target=#docSearch aria-controls=docSearch aria-expanded=false aria-label="Open search">
<svg width="20" height="20" fill="currentcolor" class="bi bi-search me-2" viewBox="0 0 20 20"><path d="M11.742 10.344a6.5 6.5.0 10-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 001.415-1.414l-3.85-3.85a1 1 0 00-.115-.1zM12 6.5a5.5 5.5.0 11-11 0 5.5 5.5.0 0111 0"/></svg>
<span>Quick search...</span></button></div><nav id=SideBarToc><ul><li><span>Getting Started</span><ul><li><a href=../../../docs/getting_started/discover_heimdall/>Discover heimdall</a></li><li><a href=../../../docs/getting_started/installation/>Install heimdall</a></li><li><a href=../../../docs/getting_started/protect_an_app/>Protect an Application</a></li></ul></li><li><span>Concepts</span><ul><li><a href=../../../docs/concepts/pipelines/>Pipelines</a></li><li><a href=../../../docs/concepts/mechanisms/>Mechanisms</a></li><li><a href=../../../docs/concepts/rules/>Rules</a></li><li><a href=../../../docs/concepts/provider/>Rule Provider</a></li><li><a href=../../../docs/concepts/operating_modes/>Operating Modes</a></li></ul></li><li><span>Operations</span><ul><li><a href=../../../docs/operations/configuration/>Configuration</a></li><li><a href=../../../docs/operations/cli/>CLI</a></li><li><a href=../../../docs/operations/observability/>Observability</a></li><li><a href=../../../docs/operations/cache/>Caching</a></li><li><a href=../../../docs/operations/security/>Security</a></li></ul></li><li><span>Services</span><ul><li><a href=../../../docs/services/main/>Main Service</a></li><li><a href=../../../docs/services/management/>Management Service</a></li></ul></li><li><span>Mechanisms</span><ul><li><a href=../../../docs/mechanisms/catalogue/>Catalogue</a></li><li><a href=../../../docs/mechanisms/evaluation_objects/>Objects, Templating & Co</a></li><li><a href=../../../docs/mechanisms/authenticators/>Authenticators</a></li><li><a class=active href=../../../docs/mechanisms/authorizers/>Authorizers</a></li><li><a href=../../../docs/mechanisms/contextualizers/>Contextualizers</a></li><li><a href=../../../docs/mechanisms/finalizers/>Finalizers</a></li><li><a href=../../../docs/mechanisms/error_handlers/>Error Handlers</a></li></ul></li><li><span>Rules</span><ul><li><a href=../../../docs/rules/regular_rule/>Regular Rule</a></li><li><a href=../../../docs/rules/default_rule/>Default Rule</a></li><li><a href=../../../docs/rules/rule_sets/>Rule Sets</a></li><li><a href=../../../docs/rules/providers/>Rule Providers</a></li></ul></li><li><span>Configuration Reference</span><ul><li><a href=../../../docs/configuration/types/>Type Definitions</a></li><li><a href=../../../docs/configuration/reference/>Reference</a></li></ul></li></ul></nav></div></nav><div class="d-flex align-items-center px-4"><a class="navbar-brand navbar-brand-highlight text-white me-0" href=../../../ style=font-weight:500;font-size:1.5rem>Heimdall</a><ul class="navbar-nav d-none d-md-flex ms-3"><li class=nav-item><a class='nav-link text-white' href=../../../docs/getting_started/discover_heimdall>Docs</a></li><li class=nav-item><a class='nav-link text-white' href=../../../guides/>Guides</a></li><li class=nav-item><a class='nav-link text-white' href=../../../openapi/>API</a></li></ul></div><div class=d-flex><button type=button class="btn btn-outline-dark navbar-toggler border-0 shadow-none" data-bs-toggle=modal data-bs-target=#docSearch aria-controls=docSearch aria-expanded=false aria-label="Open search">
<span class="bi bi-search"></span>
</button>
<button class="btn btn-outline-dark navbar-toggler border-0 shadow-none pe-3" type=button data-bs-toggle=offcanvas data-bs-target=#mainMenuContent aria-controls=mainMenuContent aria-expanded=false aria-label="Open main menu"><svg width="24" height="24" fill="currentcolor" class="bi bi-three-dots" viewBox="0 0 16 16"><path d="M3 9.5a1.5 1.5.0 110-3 1.5 1.5.0 010 3m5 0a1.5 1.5.0 110-3 1.5 1.5.0 010 3m5 0a1.5 1.5.0 110-3 1.5 1.5.0 010 3"/></svg></button><div class="offcanvas offcanvas-end text-bg-dark" tabindex=-1 id=mainMenuContent aria-labelledby=mainMenuContentLabel><div class=offcanvas-header><h5 class="offcanvas-title text-white" id=mainMenuContentLabel>Heimdall</h5><button type=button class="btn-close btn-close-white" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class=offcanvas-body><ul class="navbar-nav flex-column d-md-none d-lg-none d-xl-none"><li class=nav-item><a class='nav-link text-white' href=../../../docs/getting_started/discover_heimdall>Docs</a></li><li class=nav-item><a class='nav-link text-white' href=../../../guides/>Guides</a></li><li class=nav-item><a class='nav-link text-white' href=../../../openapi/>API</a></li></ul><hr class="text-white-50 d-md-none"><ul class="navbar-nav flex-column ms-auto"><doc-version-select class="nav-item dropdown" version-file=/heimdall/data.json current-version=dev current-page=/docs/mechanisms/authorizers/><button class="btn btn-dark dropdown-toggle me-4" data-bs-toggle=dropdown aria-expanded=false>
dev</button></doc-version-select></ul><ul class="navbar-nav flex-column"><li class="nav-item mb-1 pe-4"><a class="nav-link text-white" style=align-self:center href=https://github.com/dadrus/heimdall><svg role="img" width="20" height="20" fill="currentcolor" class="bi bi-github text-white" viewBox="0 0 16 16"><title>GitHub</title><path d="M8 0C3.58.0.0 3.58.0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38.0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95.0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12.0.0.67-.21 2.2.82.64-.18 1.32-.27 2-.27s1.36.09 2 .27c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15.0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48.0 1.07-.01 1.93-.01 2.2.0.21.15.46.55.38A8.012 8.012.0 0016 8c0-4.42-3.58-8-8-8z"/></svg>
<small class="ms-2 d-md-none">GitHub</small></a></li></ul></div></div></div></nav></header><div class=modal id=docSearch tabindex=-1 aria-labelledby=docSearchLabel aria-hidden=true><doc-search class="col-auto me-auto mw-75" index-file=/heimdall/dev/index.json path-prefix=/heimdall/dev><div class="modal-dialog modal-lg modal-dialog-scrollable"><div class=modal-content><div class="modal-header p-2"><div class=input-group><div class="input-group-text bg-body border-0 fs-4"><svg width="16" height="16" fill="currentcolor" class="bi bi-search text-secondary my-0" viewBox="0 0 16 16"><path d="M11.742 10.344a6.5 6.5.0 10-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 001.415-1.414l-3.85-3.85a1 1 0 00-.115-.1zM12 6.5a5.5 5.5.0 11-11 0 5.5 5.5.0 0111 0"/></svg></div><input id=search-input class="form-control search-bar border-0" type=search placeholder="Search documentation " aria-label="Search docs..." autocomplete=off autofocus><div class="input-group-text bg-body border-0"><a class="btn input-group-text text-muted border p-1 bg-light-subtle fs-7 fw-bold font-monospace" data-bs-dismiss=modal aria-label=Close>ESC</a></div></div></div><div class=modal-body><div class=search-results><p class="text-center mt-5">No recent searches</p></div></div><div class=modal-footer></div></div></div></doc-search></div><div class="container-xxl docs-layout px-4"><aside class="d-none pe-3 docs-sidebar"><div class=docs-search-button><button type=button class="btn btn-outline-secondary mb-3 d-none d-md-block w-100 text-start" data-bs-toggle=modal data-bs-target=#docSearch aria-controls=docSearch aria-expanded=false aria-label="Open search">
<svg width="20" height="20" fill="currentcolor" class="bi bi-search me-2" viewBox="0 0 20 20"><path d="M11.742 10.344a6.5 6.5.0 10-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 001.415-1.414l-3.85-3.85a1 1 0 00-.115-.1zM12 6.5a5.5 5.5.0 11-11 0 5.5 5.5.0 0111 0"/></svg>
<span>Quick search...</span></button></div><nav id=SideBarToc><ul><li><span>Getting Started</span><ul><li><a href=../../../docs/getting_started/discover_heimdall/>Discover heimdall</a></li><li><a href=../../../docs/getting_started/installation/>Install heimdall</a></li><li><a href=../../../docs/getting_started/protect_an_app/>Protect an Application</a></li></ul></li><li><span>Concepts</span><ul><li><a href=../../../docs/concepts/pipelines/>Pipelines</a></li><li><a href=../../../docs/concepts/mechanisms/>Mechanisms</a></li><li><a href=../../../docs/concepts/rules/>Rules</a></li><li><a href=../../../docs/concepts/provider/>Rule Provider</a></li><li><a href=../../../docs/concepts/operating_modes/>Operating Modes</a></li></ul></li><li><span>Operations</span><ul><li><a href=../../../docs/operations/configuration/>Configuration</a></li><li><a href=../../../docs/operations/cli/>CLI</a></li><li><a href=../../../docs/operations/observability/>Observability</a></li><li><a href=../../../docs/operations/cache/>Caching</a></li><li><a href=../../../docs/operations/security/>Security</a></li></ul></li><li><span>Services</span><ul><li><a href=../../../docs/services/main/>Main Service</a></li><li><a href=../../../docs/services/management/>Management Service</a></li></ul></li><li><span>Mechanisms</span><ul><li><a href=../../../docs/mechanisms/catalogue/>Catalogue</a></li><li><a href=../../../docs/mechanisms/evaluation_objects/>Objects, Templating & Co</a></li><li><a href=../../../docs/mechanisms/authenticators/>Authenticators</a></li><li><a class=active href=../../../docs/mechanisms/authorizers/>Authorizers</a></li><li><a href=../../../docs/mechanisms/contextualizers/>Contextualizers</a></li><li><a href=../../../docs/mechanisms/finalizers/>Finalizers</a></li><li><a href=../../../docs/mechanisms/error_handlers/>Error Handlers</a></li></ul></li><li><span>Rules</span><ul><li><a href=../../../docs/rules/regular_rule/>Regular Rule</a></li><li><a href=../../../docs/rules/default_rule/>Default Rule</a></li><li><a href=../../../docs/rules/rule_sets/>Rule Sets</a></li><li><a href=../../../docs/rules/providers/>Rule Providers</a></li></ul></li><li><span>Configuration Reference</span><ul><li><a href=../../../docs/configuration/types/>Type Definitions</a></li><li><a href=../../../docs/configuration/reference/>Reference</a></li></ul></li></ul></nav></aside><main class=docs-main><div class="d-md-none docs-location bg-body"><nav style="--bs-breadcrumb-divider:'>'" aria-label=breadcrumb><ol class="breadcrumb mb-0"><li class="breadcrumb-item fw-bold">Mechanisms</li><li class="breadcrumb-item active" aria-current=page>Authorizers</li></ol></nav></div><div class="docs-intro pt-3 pe-3"><h1>Authorizers</h1><p>Authorizers ensure that only those subjects, which are eligible can access the desired resource. This page describes the available authorizer types in detail.</p></div><aside class="text-muted docs-toc"><strong class="d-md-block h6 pb-2 my-2 ms-2 border-bottom d-none d-md-none d-lg-block">On this page</strong><div id=page-content-toc class="mt-1 mb-3 text-muted d-none d-md-none d-lg-block docs-toc-content"><nav id=TableOfContents><ul><li><a href=#_allow>Allow</a></li><li><a href=#_deny>Deny</a></li><li><a href=#_local_cel>Local (CEL)</a></li><li><a href=#_remote>Remote</a></li></ul></nav></div><button class="btn btn-outline-secondary text-decoration-none d-lg-none collapsed" type=button data-bs-toggle=collapse data-bs-target=#page-content-toc-collapsible aria-expanded=false aria-controls=page-content-toc-collapsible>
On this page<svg width="16" height="16" fill="currentcolor" class="bi bi-chevron-expand" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M3.646 9.146a.5.5.0 01.708.0L8 12.793l3.646-3.647a.5.5.0 01.708.708l-4 4a.5.5.0 01-.708.0l-4-4a.5.5.0 010-.708m0-2.292a.5.5.0 00.708.0L8 3.207l3.646 3.647a.5.5.0 00.708-.708l-4-4a.5.5.0 00-.708.0l-4 4a.5.5.0 000 .708"/></svg></button><div id=page-content-toc-collapsible class="mt-1 mb-3 text-muted d-lg-none collapse docs-toc-content"><div class="card card-body"><nav id=TableOfContents><ul><li><a href=#_allow>Allow</a></li><li><a href=#_deny>Deny</a></li><li><a href=#_local_cel>Local (CEL)</a></li><li><a href=#_remote>Remote</a></li></ul></nav></div></div></aside><div class="docs-content pe-3"><div data-bs-spy=scroll data-bs-target=#page-content-toc class=mt-3><linkable-headline-area><div class=paragraph><p>Some of the authorizers may support or require additional configuration. The corresponding properties are annotated with <code>mandatory</code>, respectively <code>optional</code> to denote configuration requirement, as well as with <code>overridable</code>, <code>not overridable</code> and <code>partially overridable</code> to indicate whether the property can be overridden in a rule pipeline.</p></div><div class=sect1><h2 id=_allow>Allow</h2><div class=sectionbody><div class=paragraph><p>As the name implies, this authorizer allows any request passing through. This authorizer type also doesn’t have any configuration options.</p></div><div class=paragraph><p>To enable the usage of this authorizer, you have to set the <code>type</code> property to <code>allow</code>.</p></div><div class=exampleblock><div class=title>Example 1. Configuration of Allow authorizer</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=yaml><span class=na>id</span><span class=pi>:</span> <span class=s>allow_any_request</span>
<span class=na>type</span><span class=pi>:</span> <span class=s>allow</span></code></pre></div></div></div></div></div></div><div class=sect1><h2 id=_deny>Deny</h2><div class=sectionbody><div class=paragraph><p>As the name implies, this authorizer denies any request (on HTTP response code level this is then mapped to <code>403 Forbidden</code>). It basically stops the successful execution of the pipeline resulting in the execution of the error handler mechanisms. This authorizer type doesn’t have any configuration options.</p></div><div class=paragraph><p>To enable the usage of this authorizer, you have to set the <code>type</code> property to <code>deny</code>.</p></div><div class=exampleblock><div class=title>Example 2. Configuration of Deny authorizer</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=yaml><span class=na>id</span><span class=pi>:</span> <span class=s>deny_any_request</span>
<span class=na>type</span><span class=pi>:</span> <span class=s>deny</span></code></pre></div></div></div></div></div></div><div class=sect1><h2 id=_local_cel>Local (CEL)</h2><div class=sectionbody><div class=paragraph><p>This authorizer allows definition of authorization requirements based on information available about the authenticated subject, the existing pipeline results, as well as the actual request by using <a href=https://github.com/google/cel-spec>CEL</a> based authorization expressions. Each expression is expected to return <code>true</code> to signal success. Otherwise, the authorization fails, resulting in the execution of the error handler mechanisms.</p></div><div class=paragraph><p>To enable the usage of this authorizer, you have to set the <code>type</code> property to <code>cel</code>.</p></div><div class=paragraph><p>Configuration using the <code>config</code> property is mandatory. Following properties are available:</p></div><div class=ulist><ul><li><p><strong><code>expressions</code></strong>: <em><a href=../../../docs/configuration/types/#_authorization_expression>Authorization Expression</a> array</em> (mandatory, overridable)</p><div class=paragraph><p>List of authorization expressions, which define the actual authorization logic. Each expression has access to the <a href=../../../docs/mechanisms/evaluation_objects/#_subject><code>Subject</code></a>, the <a href=../../../docs/mechanisms/evaluation_objects/#_outputs><code>Outputs</code></a>, the <a href=../../../docs/mechanisms/evaluation_objects/#_request><code>Request</code></a>, and the <a href=../../../docs/mechanisms/evaluation_objects/#_values><code>Values</code></a> objects.</p></div></li><li><p><strong><code>values</code></strong> <em>map of strings</em> (optional, overridable)</p><div class=paragraph><p>A key value map, which is made accessible to the CEL engine as <a href=../../../docs/mechanisms/evaluation_objects/#_values><code>Values</code></a> object, to support "templating" of expressions (see also examples below). The actual values in that map can be templated as well with access to the <a href=../../../docs/mechanisms/evaluation_objects/#_subject><code>Subject</code></a>, the <a href=../../../docs/mechanisms/evaluation_objects/#_outputs><code>Outputs</code></a>, and <a href=../../../docs/mechanisms/evaluation_objects/#_request><code>Request</code></a> objects.</p></div></li></ul></div><div class=exampleblock><div class=title>Example 3. Authorization based on subject properties</div><div class=content><div class=paragraph><p>In this example the subject is checked to be member of the "admin" group.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=yaml><span class=na>id</span><span class=pi>:</span> <span class=s>user_is_admin</span>
<span class=na>type</span><span class=pi>:</span> <span class=s>cel</span>
<span class=na>config</span><span class=pi>:</span>
  <span class=na>expressions</span><span class=pi>:</span>
    <span class=pi>-</span> <span class=na>expression</span><span class=pi>:</span> <span class=pi>|</span>
        <span class=s>has(Subject.Attributes.groups) &amp;&amp;</span>
        <span class=s>Subject.Attributes.groups.exists(g, g == &#34;admin&#34;)</span>
      <span class=na>message</span><span class=pi>:</span> <span class=s>User is not admin</span></code></pre></div></div><div class=paragraph><p>The first line of the expressions verifies that the property group exists. The second line checks, whether <code>groups</code> contains an entry named <code>admin</code>.</p></div><div class=paragraph><p>This example specifies also a message, which is logged, if the expression fails.</p></div></div></div><div class=exampleblock><div class=title>Example 4. Authorization based on subject and request properties</div><div class=content><div class=paragraph><p>In this example the authorizer is configured to ensure anonymous access to a resource is possible for read requests only.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=yaml><span class=na>id</span><span class=pi>:</span> <span class=s>no_modification_allowed_by_anonymous</span>
<span class=na>type</span><span class=pi>:</span> <span class=s>cel</span>
<span class=na>config</span><span class=pi>:</span>
  <span class=na>expressions</span><span class=pi>:</span>
    <span class=pi>-</span> <span class=na>expression</span><span class=pi>:</span> <span class=pi>|</span>
        <span class=s>Request.Method in [&#34;GET&#34;, &#34;HEAD&#34;, &#34;OPTIONS&#34;] || Subject.ID != &#34;anonymous&#34;</span>
      <span class=na>message</span><span class=pi>:</span> <span class=s>Anonymous non-read access is forbidden</span></code></pre></div></div><div class=paragraph><p>The usage of this type of configuration makes sense in a pipeline, which combines multiple <a href=../../../docs/mechanisms/authenticators/>Authenticators</a>, allowing anonymous and authenticated access.</p></div></div></div><div class=exampleblock><div class=title>Example 5. Checking for a Kubernetes Service Account</div><div class=content><div class=paragraph><p>In this example, the authorizer is configured to check for a service account name in the format <code>system:serviceaccount:&lt;namespace>:&lt;name></code>, where <code>namespace</code> and <code>name</code> are provided by making use of the <a href=../../../docs/mechanisms/evaluation_objects/#_values><code>Values</code></a> object. By default, both properties are set to an empty string.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=yaml><span class=na>id</span><span class=pi>:</span> <span class=s>check_service_account</span>
<span class=na>type</span><span class=pi>:</span> <span class=s>cel</span>
<span class=na>config</span><span class=pi>:</span>
  <span class=na>values</span><span class=pi>:</span>
    <span class=na>namespace</span><span class=pi>:</span> <span class=s2>&#34;</span><span class=s>&#34;</span>
    <span class=na>name</span><span class=pi>:</span> <span class=s2>&#34;</span><span class=s>&#34;</span>
  <span class=na>expressions</span><span class=pi>:</span>
    <span class=pi>-</span> <span class=na>expression</span><span class=pi>:</span> <span class=pi>&gt;</span>
        <span class=s>Subject.ID == &#34;system:serviceaccount:&#34; + Values.namespace + &#34;:&#34; + Values.name</span></code></pre></div></div><div class=paragraph><p>With this configuration in place, rules can override the default expression values by specifying rule-specific settings, as shown below:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=yaml><span class=c1># further rule settings</span>
<span class=na>execute</span><span class=pi>:</span>
  <span class=pi>-</span> <span class=c1># some other steps</span>
  <span class=pi>-</span> <span class=na>authorizer</span><span class=pi>:</span> <span class=s>check_service_account</span>
    <span class=na>config</span><span class=pi>:</span>
      <span class=na>values</span><span class=pi>:</span>
        <span class=na>namespace</span><span class=pi>:</span> <span class=s2>&#34;</span><span class=s>awesome-app&#34;</span>
        <span class=na>name</span><span class=pi>:</span> <span class=s2>&#34;</span><span class=s>app&#34;</span>
  <span class=pi>-</span> <span class=c1># some further steps</span></code></pre></div></div></div></div></div></div><div class=sect1><h2 id=_remote>Remote</h2><div class=sectionbody><div class=paragraph><p>This authorizer allows communication with other systems, like <a href=https://www.openpolicyagent.org/>Open Policy Agent</a>, <a href=https://www.ory.sh/docs/keto/>Ory Keto</a>, etc. for the actual authorization purpose. If the used endpoint answers with a not 2xx HTTP response code, this authorizer assumes, the authorization has failed, resulting in the execution of the error handler mechanisms. Otherwise, if no expressions for the verification of the response are defined, the authorizer assumes, the request has been authorized. If expressions are defined and do not fail, the authorization succeeds.</p></div><div class=paragraph><p>If your authorization system provides a payload in the response, heimdall inspects the <code>Content-Type</code> header to prepare the payload for further usage, e.g. for payload verification expressions, or for a <a href=#_local_cel>Local (CEL)</a> authorizer. If the content type does either end with <code>json</code> or is <code>application/x-www-form-urlencoded</code>, the payload is decoded, so key based access to the corresponding attributes is possible, otherwise it is made available as well, but as a simple string. In all cases this value is available for the authorization expressions, as well as in the <a href=../../../docs/mechanisms/evaluation_objects/#_outputs><code>Outputs</code></a> property under a key named by the <code>id</code> of the authorizer (See also the example below).</p></div><div class=paragraph><p>To enable the usage of this authorizer, you have to set the <code>type</code> property to <code>remote</code>.</p></div><div class=paragraph><p>Configuration using the <code>config</code> property is mandatory. Following properties are available:</p></div><div class=ulist><ul><li><p><strong><code>endpoint</code></strong>: <em><a href=../../../docs/configuration/types/#_endpoint>Endpoint</a></em> (mandatory, not overridable)</p><div class=paragraph><p>The API endpoint of your authorization system. At least the <code>url</code> must be configured. This mechanism allows templating of the url and makes the <a href=../../../docs/mechanisms/evaluation_objects/#_subject><code>Subject</code></a> object, the <a href=../../../docs/mechanisms/evaluation_objects/#_outputs><code>Outputs</code></a> object, as well as the <a href=../../../docs/mechanisms/evaluation_objects/#_values><code>Values</code></a> (see also below) objects available to it. By default, this authorizer will use HTTP <code>POST</code> to send the rendered payload to this endpoint. You can override this behavior by configuring <code>method</code> as well. Depending on the API requirements of your authorization system, you might need to configure further properties, like headers, etc.</p></div></li><li><p><strong><code>payload</code></strong>: <em>string</em> (optional, overridable)</p><div class=paragraph><p>Your <a href=../../../docs/mechanisms/evaluation_objects/#_templating>template</a> with definitions required to communicate to the authorization endpoint. The template can make use of <a href=../../../docs/mechanisms/evaluation_objects/#_values><code>Values</code></a>, <a href=../../../docs/mechanisms/evaluation_objects/#_outputs><code>Outputs</code></a>, <a href=../../../docs/mechanisms/evaluation_objects/#_subject><code>Subject</code></a> and <a href=../../../docs/mechanisms/evaluation_objects/#_request><code>Request</code></a> objects.</p></div></li><li><p><strong><code>expressions</code></strong>: <em><a href=../../../docs/configuration/types/#_authorization_expression>Authorization Expression</a> array</em> (optional, overridable)</p><div class=paragraph><p>List of <a href=https://github.com/google/cel-spec>CEL</a> expressions which define the logic to be applied to the response returned by the endpoint. All expressions are expected to evaluate to <code>true</code> if the authorization was successful. If any of the expressions evaluates to <code>false</code>, the authorization fails and the message defined by the failed expression will be logged.</p></div><div class=paragraph><p>Each expression has access to the <a href=../../../docs/mechanisms/evaluation_objects/#_payload><code>Payload</code></a> object.</p></div></li><li><p><strong><code>forward_response_headers_to_upstream</code></strong>: <em>string array</em> (optional, overridable)</p><div class=paragraph><p>Enables forwarding of any headers from the authorization endpoint response to the upstream service.</p></div></li><li><p><strong><code>cache_ttl</code></strong>: <em><a href=../../../docs/configuration/types/#_duration>Duration</a></em> (optional, overridable)</p><div class=paragraph><p>Allows caching of the authorization endpoint responses. Defaults to 0s, which means no caching. The cache key is calculated from the entire configuration of the authorizer instance and the available information about the current subject.</p></div></li><li><p><strong><code>values</code></strong> <em>map of strings</em> (optional, overridable)</p><div class=paragraph><p>A key value map, which is made accessible to the template rendering engine as <a href=../../../docs/mechanisms/evaluation_objects/#_values><code>Values</code></a> object, to render parts of the URL and/or the payload. The actual values in that map can be templated as well with access to the <a href=../../../docs/mechanisms/evaluation_objects/#_subject><code>Subject</code></a>, the <a href=../../../docs/mechanisms/evaluation_objects/#_outputs><code>Outputs</code></a>, and <a href=../../../docs/mechanisms/evaluation_objects/#_request><code>Request</code></a> objects.</p></div></li></ul></div><div class=exampleblock><div class=title>Example 6. Configuration of Remote authorizer to communicate with <a href=https://www.openpolicyagent.org/>Open Policy Agent</a> (OPA)</div><div class=content><div class=paragraph><p>Here the remote authorizer is configured to communicate with OPA. Since OPA expects the query to be formatted as JSON, the corresponding <code>Content-Type</code> header is set. Since the responses are JSON objects as well, the <code>Accept</code> header is also provided. In addition, this examples uses the <code>basic_auth</code> auth type to authenticate against the endpoint.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=yaml><span class=na>id</span><span class=pi>:</span> <span class=s>opa</span>
<span class=na>type</span><span class=pi>:</span> <span class=s>remote</span>
<span class=na>config</span><span class=pi>:</span>
  <span class=na>endpoint</span><span class=pi>:</span>
    <span class=na>url</span><span class=pi>:</span> <span class=s>https://opa.local/v1/data/{{ .Values.namespace }}/{{ .Values.policy }}</span>
    <span class=na>headers</span><span class=pi>:</span>
      <span class=na>Content-Type</span><span class=pi>:</span> <span class=s>json</span>
      <span class=na>Accept</span><span class=pi>:</span> <span class=s>json</span>
    <span class=na>auth</span><span class=pi>:</span>
      <span class=na>type</span><span class=pi>:</span> <span class=s>basic_auth</span>
      <span class=na>config</span><span class=pi>:</span>
        <span class=na>user</span><span class=pi>:</span> <span class=s>${OPA_USER}</span>
        <span class=na>password</span><span class=pi>:</span> <span class=s>${OPA_PASSWORD}</span>
  <span class=na>payload</span><span class=pi>:</span> <span class=pi>|</span>
    <span class=s>{ &#34;input&#34;: { &#34;user&#34;: {{ quote .Subject.ID }} }, &#34;some_data&#34;: {{ quote .Values.whatever }}, &#34;more_data&#34;: {{ quote .Outputs.whatever }} }</span>
  <span class=na>values</span><span class=pi>:</span>
    <span class=na>namespace</span><span class=pi>:</span> <span class=s>myapi/policy</span>
    <span class=na>policy</span><span class=pi>:</span> <span class=s>allow_write</span>
    <span class=na>whatever</span><span class=pi>:</span> <span class=pi>|</span>
     <span class=s>{{ .Request.Header(&#34;X-Whatever&#34;) }}</span>
  <span class=na>expressions</span><span class=pi>:</span>
    <span class=pi>-</span> <span class=na>expression</span><span class=pi>:</span> <span class=pi>|</span>
        <span class=s>Payload.result == true</span>
      <span class=na>message</span><span class=pi>:</span> <span class=s>User does not have required permissions</span></code></pre></div></div><div class=paragraph><p>In this case, since an OPA response could look like <code>{ "result": true }</code> or <code>{ "result": false }</code>, heimdall makes the response also available under <code>Outputs["opa"]</code>, with <code>"opa"</code> being the id of the authorizer in this example.</p></div><div class=paragraph><p>A specific rule could then use this authorizer in the following ways:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=yaml><span class=pi>-</span> <span class=na>id</span><span class=pi>:</span> <span class=s>rule1</span>
  <span class=c1># other rule properties</span>
  <span class=na>execute</span><span class=pi>:</span>
  <span class=pi>-</span> <span class=c1># other mechanisms</span>
  <span class=pi>-</span> <span class=na>authorizer</span><span class=pi>:</span> <span class=s>opa</span> <span class=c1># using defaults</span>
  <span class=pi>-</span> <span class=c1># other mechanisms</span>

<span class=pi>-</span> <span class=na>id</span><span class=pi>:</span> <span class=s>rule2</span>
  <span class=c1># other rule properties</span>
  <span class=na>execute</span><span class=pi>:</span>
  <span class=pi>-</span> <span class=c1># other mechanisms</span>
  <span class=pi>-</span> <span class=na>authorizer</span><span class=pi>:</span> <span class=s>opa</span>
    <span class=na>config</span><span class=pi>:</span> <span class=c1># overriding with rule specifics</span>
      <span class=na>values</span><span class=pi>:</span>
        <span class=na>policy</span><span class=pi>:</span> <span class=s>allow_read</span>
        <span class=na>whatever</span><span class=pi>:</span> <span class=pi>|</span>
          <span class=s>{{ .Request.Header(&#34;X-SomethingElse&#34;) }}</span>
  <span class=pi>-</span> <span class=c1># other mechanisms</span></code></pre></div></div></div></div></div></div></linkable-headline-area></div><p class="text-end fst-italic fs-7 pb-3">Last updated on <span class=fw-bold>Jun 23, 2025</span></p><hr><div class="d-flex justify-content-between py-3"><a href=../../../docs/mechanisms/authenticators/ class="fs-6 fw-bold text-dark link-secondary link-underline-opacity-0"><svg width="16" height="16" fill="currentcolor" class="bi bi-chevron-left" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M11.354 1.646a.5.5.0 010 .708L5.707 8l5.647 5.646a.5.5.0 01-.708.708l-6-6a.5.5.0 010-.708l6-6a.5.5.0 01.708.0z"/></svg>
Authenticators
</a><a class="ms-auto fs-6 fw-bold text-dark link-secondary link-underline-opacity-0" href=../../../docs/mechanisms/contextualizers/>Contextualizers<svg width="16" height="16" fill="currentcolor" class="bi bi-chevron-right" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4.646 1.646a.5.5.0 01.708.0l6 6a.5.5.0 010 .708l-6 6a.5.5.0 01-.708-.708L10.293 8 4.646 2.354a.5.5.0 010-.708z"/></svg></a></div></div></main></div><footer class="footer py-4 py-md-5 px-4 px-md-3 mt-3"><div class=container><div class=row><div class="col-lg-3 mb-3"><p class=fs-5>Heimdall</p><ul class="list-unstyled small text-muted"><li class=mb-2>2022-2024 © Heimdall Project Authors. All rights reserved.</li><li class=mb-2><a href=https://github.com/dadrus/heimdall/blob/master/LICENSE>Apache 2.0 licensed</a></li></ul></div><div class="col-6 col-lg-2 offset-lg-1 mb-3"><h5>Links</h5><ul class=list-unstyled><li class=mb-2><a href=../../../>Home</a></li><li class=mb-2><a href=../../../docs/getting_started/discover_heimdall>Docs</a></li><li class=mb-2><a href=../../../guides/>Guides</a></li><li class=mb-2><a href=../../../openapi/>API</a></li></ul></div><div class="col-6 col-lg-2 mb-2"><h5>Guides</h5><ul class=list-unstyled><li class=mb-2><a href=../../../guides/proxies/>API Gateways & Proxies</a></li><li class=mb-2><a href=../../../guides/authz/>Authorization Services</a></li><li class=mb-2><a href=../../../guides/authn/>Authentication Protocols & Services</a></li></ul></div><div class="col-6 col-lg-2 mb-2"><h5>Community</h5><ul class=list-unstyled><li class=mb-2><a href=https://github.com/dadrus/heimdall>Github</a></li><li class=mb-2><a href=https://discord.gg/qQgg8xKuyb>Discord</a></li></ul></div></div></div></footer><script src=../../../js/main.js defer></script></body></html>