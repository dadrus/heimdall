<!doctype html><html lang=en><head><title>Objects, Templating & Co</title>
<meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="An open source Identity Aware Proxy and an Access Control Decision service for cloud native applications"><meta name=dc.relation content="https://dadrus.github.io/"><meta name=theme-color content="#1A94D2"><link rel=stylesheet href=../../../css/styles.min.css media=screen><link rel='shortcut icon' type=image/x-icon href=../../../favicon.ico></head><body><header class="navbar navbar-expand-md navbar-dark bg-dark sticky-top"><nav class="container-xxl flex-wrap flex-lg-nowrap px-0" aria-label="Main navigation"><button class="btn btn-outline-dark d-lg-none navbar-toggler border-0 shadow-none ps-3" type=button data-bs-toggle=offcanvas data-bs-target=#docsMenuContent aria-controls=docsMenuContent aria-expanded=false aria-label="Open docs menu"><svg width="36" height="36" fill="currentcolor" class="bi bi-list" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M2.5 12a.5.5.0 01.5-.5h10a.5.5.0 010 1H3a.5.5.0 01-.5-.5m0-4a.5.5.0 01.5-.5h10a.5.5.0 010 1H3A.5.5.0 012.5 8m0-4a.5.5.0 01.5-.5h10a.5.5.0 010 1H3A.5.5.0 012.5 4"/></svg></button><nav class="offcanvas offcanvas-start d-md-none text-bg-light" tabindex=-1 id=docsMenuContent aria-labelledby=docsMenuContentLabel><div class=offcanvas-header><h5 class=offcanvas-title id=docsMenuContentLabel>Browse docs</h5><button type=button class=btn-close data-bs-dismiss=offcanvas aria-label="Close docs menu"></button></div><div class="offcanvas-body docs-sidebar"><div class=docs-search-button><button type=button class="btn btn-outline-secondary mb-3 d-none d-md-block w-100 text-start" data-bs-toggle=modal data-bs-target=#docSearch aria-controls=docSearch aria-expanded=false aria-label="Open search">
<svg width="20" height="20" fill="currentcolor" class="bi bi-search me-2" viewBox="0 0 20 20"><path d="M11.742 10.344a6.5 6.5.0 10-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 001.415-1.414l-3.85-3.85a1 1 0 00-.115-.1zM12 6.5a5.5 5.5.0 11-11 0 5.5 5.5.0 0111 0"/></svg>
<span>Quick search...</span></button></div><nav id=SideBarToc><ul><li><span>Getting Started</span><ul><li><a href=../../../docs/getting_started/discover_heimdall/>Discover heimdall</a></li><li><a href=../../../docs/getting_started/installation/>Install heimdall</a></li><li><a href=../../../docs/getting_started/protect_an_app/>Protect an Application</a></li></ul></li><li><span>Concepts</span><ul><li><a href=../../../docs/concepts/pipelines/>Pipelines</a></li><li><a href=../../../docs/concepts/mechanisms/>Mechanisms</a></li><li><a href=../../../docs/concepts/rules/>Rules</a></li><li><a href=../../../docs/concepts/provider/>Rule Provider</a></li><li><a href=../../../docs/concepts/operating_modes/>Operating Modes</a></li></ul></li><li><span>Operations</span><ul><li><a href=../../../docs/operations/configuration/>Configuration</a></li><li><a href=../../../docs/operations/cli/>CLI</a></li><li><a href=../../../docs/operations/observability/>Observability</a></li><li><a href=../../../docs/operations/cache/>Caching</a></li><li><a href=../../../docs/operations/security/>Security</a></li></ul></li><li><span>Services</span><ul><li><a href=../../../docs/services/main/>Main Service</a></li><li><a href=../../../docs/services/management/>Management Service</a></li></ul></li><li><span>Mechanisms</span><ul><li><a href=../../../docs/mechanisms/catalogue/>Catalogue</a></li><li><a class=active href=../../../docs/mechanisms/evaluation_objects/>Objects, Templating & Co</a></li><li><a href=../../../docs/mechanisms/authenticators/>Authenticators</a></li><li><a href=../../../docs/mechanisms/authorizers/>Authorizers</a></li><li><a href=../../../docs/mechanisms/contextualizers/>Contextualizers</a></li><li><a href=../../../docs/mechanisms/finalizers/>Finalizers</a></li><li><a href=../../../docs/mechanisms/error_handlers/>Error Handlers</a></li></ul></li><li><span>Rules</span><ul><li><a href=../../../docs/rules/regular_rule/>Regular Rule</a></li><li><a href=../../../docs/rules/default_rule/>Default Rule</a></li><li><a href=../../../docs/rules/rule_sets/>Rule Sets</a></li><li><a href=../../../docs/rules/providers/>Rule Providers</a></li></ul></li><li><span>Configuration Reference</span><ul><li><a href=../../../docs/configuration/types/>Type Definitions</a></li><li><a href=../../../docs/configuration/reference/>Reference</a></li></ul></li></ul></nav></div></nav><div class="d-flex align-items-center px-4"><a class="navbar-brand navbar-brand-highlight text-white me-0" href=../../../ style=font-weight:500;font-size:1.5rem>Heimdall</a><ul class="navbar-nav d-none d-md-flex ms-3"><li class=nav-item><a class='nav-link text-white' href=../../../docs/getting_started/discover_heimdall>Docs</a></li><li class=nav-item><a class='nav-link text-white' href=../../../guides/>Guides</a></li><li class=nav-item><a class='nav-link text-white' href=../../../openapi/>API</a></li></ul></div><div class=d-flex><button type=button class="btn btn-outline-dark navbar-toggler border-0 shadow-none" data-bs-toggle=modal data-bs-target=#docSearch aria-controls=docSearch aria-expanded=false aria-label="Open search">
<span class="bi bi-search"></span>
</button>
<button class="btn btn-outline-dark navbar-toggler border-0 shadow-none pe-3" type=button data-bs-toggle=offcanvas data-bs-target=#mainMenuContent aria-controls=mainMenuContent aria-expanded=false aria-label="Open main menu"><svg width="24" height="24" fill="currentcolor" class="bi bi-three-dots" viewBox="0 0 16 16"><path d="M3 9.5a1.5 1.5.0 110-3 1.5 1.5.0 010 3m5 0a1.5 1.5.0 110-3 1.5 1.5.0 010 3m5 0a1.5 1.5.0 110-3 1.5 1.5.0 010 3"/></svg></button><div class="offcanvas offcanvas-end text-bg-dark" tabindex=-1 id=mainMenuContent aria-labelledby=mainMenuContentLabel><div class=offcanvas-header><h5 class="offcanvas-title text-white" id=mainMenuContentLabel>Heimdall</h5><button type=button class="btn-close btn-close-white" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class=offcanvas-body><ul class="navbar-nav flex-column d-md-none d-lg-none d-xl-none"><li class=nav-item><a class='nav-link text-white' href=../../../docs/getting_started/discover_heimdall>Docs</a></li><li class=nav-item><a class='nav-link text-white' href=../../../guides/>Guides</a></li><li class=nav-item><a class='nav-link text-white' href=../../../openapi/>API</a></li></ul><hr class="text-white-50 d-md-none"><ul class="navbar-nav flex-column ms-auto"><doc-version-select class="nav-item dropdown" version-file=/heimdall/data.json current-version=dev current-page=/docs/mechanisms/evaluation_objects/><button class="btn btn-dark dropdown-toggle me-4" data-bs-toggle=dropdown aria-expanded=false>
dev</button></doc-version-select></ul><ul class="navbar-nav flex-column"><li class="nav-item mb-1 pe-4"><a class="nav-link text-white" style=align-self:center href=https://github.com/dadrus/heimdall><svg role="img" width="20" height="20" fill="currentcolor" class="bi bi-github text-white" viewBox="0 0 16 16"><title>GitHub</title><path d="M8 0C3.58.0.0 3.58.0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38.0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95.0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12.0.0.67-.21 2.2.82.64-.18 1.32-.27 2-.27s1.36.09 2 .27c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15.0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48.0 1.07-.01 1.93-.01 2.2.0.21.15.46.55.38A8.012 8.012.0 0016 8c0-4.42-3.58-8-8-8z"/></svg>
<small class="ms-2 d-md-none">GitHub</small></a></li></ul></div></div></div></nav></header><div class=modal id=docSearch tabindex=-1 aria-labelledby=docSearchLabel aria-hidden=true><doc-search class="col-auto me-auto mw-75" index-file=/heimdall/dev/index.json path-prefix=/heimdall/dev><div class="modal-dialog modal-lg modal-dialog-scrollable"><div class=modal-content><div class="modal-header p-2"><div class=input-group><div class="input-group-text bg-body border-0 fs-4"><svg width="16" height="16" fill="currentcolor" class="bi bi-search text-secondary my-0" viewBox="0 0 16 16"><path d="M11.742 10.344a6.5 6.5.0 10-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 001.415-1.414l-3.85-3.85a1 1 0 00-.115-.1zM12 6.5a5.5 5.5.0 11-11 0 5.5 5.5.0 0111 0"/></svg></div><input id=search-input class="form-control search-bar border-0" type=search placeholder="Search documentation " aria-label="Search docs..." autocomplete=off autofocus><div class="input-group-text bg-body border-0"><a class="btn input-group-text text-muted border p-1 bg-light-subtle fs-7 fw-bold font-monospace" data-bs-dismiss=modal aria-label=Close>ESC</a></div></div></div><div class=modal-body><div class=search-results><p class="text-center mt-5">No recent searches</p></div></div><div class=modal-footer></div></div></div></doc-search></div><div class="container-xxl docs-layout px-4"><aside class="d-none pe-3 docs-sidebar"><div class=docs-search-button><button type=button class="btn btn-outline-secondary mb-3 d-none d-md-block w-100 text-start" data-bs-toggle=modal data-bs-target=#docSearch aria-controls=docSearch aria-expanded=false aria-label="Open search">
<svg width="20" height="20" fill="currentcolor" class="bi bi-search me-2" viewBox="0 0 20 20"><path d="M11.742 10.344a6.5 6.5.0 10-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 001.415-1.414l-3.85-3.85a1 1 0 00-.115-.1zM12 6.5a5.5 5.5.0 11-11 0 5.5 5.5.0 0111 0"/></svg>
<span>Quick search...</span></button></div><nav id=SideBarToc><ul><li><span>Getting Started</span><ul><li><a href=../../../docs/getting_started/discover_heimdall/>Discover heimdall</a></li><li><a href=../../../docs/getting_started/installation/>Install heimdall</a></li><li><a href=../../../docs/getting_started/protect_an_app/>Protect an Application</a></li></ul></li><li><span>Concepts</span><ul><li><a href=../../../docs/concepts/pipelines/>Pipelines</a></li><li><a href=../../../docs/concepts/mechanisms/>Mechanisms</a></li><li><a href=../../../docs/concepts/rules/>Rules</a></li><li><a href=../../../docs/concepts/provider/>Rule Provider</a></li><li><a href=../../../docs/concepts/operating_modes/>Operating Modes</a></li></ul></li><li><span>Operations</span><ul><li><a href=../../../docs/operations/configuration/>Configuration</a></li><li><a href=../../../docs/operations/cli/>CLI</a></li><li><a href=../../../docs/operations/observability/>Observability</a></li><li><a href=../../../docs/operations/cache/>Caching</a></li><li><a href=../../../docs/operations/security/>Security</a></li></ul></li><li><span>Services</span><ul><li><a href=../../../docs/services/main/>Main Service</a></li><li><a href=../../../docs/services/management/>Management Service</a></li></ul></li><li><span>Mechanisms</span><ul><li><a href=../../../docs/mechanisms/catalogue/>Catalogue</a></li><li><a class=active href=../../../docs/mechanisms/evaluation_objects/>Objects, Templating & Co</a></li><li><a href=../../../docs/mechanisms/authenticators/>Authenticators</a></li><li><a href=../../../docs/mechanisms/authorizers/>Authorizers</a></li><li><a href=../../../docs/mechanisms/contextualizers/>Contextualizers</a></li><li><a href=../../../docs/mechanisms/finalizers/>Finalizers</a></li><li><a href=../../../docs/mechanisms/error_handlers/>Error Handlers</a></li></ul></li><li><span>Rules</span><ul><li><a href=../../../docs/rules/regular_rule/>Regular Rule</a></li><li><a href=../../../docs/rules/default_rule/>Default Rule</a></li><li><a href=../../../docs/rules/rule_sets/>Rule Sets</a></li><li><a href=../../../docs/rules/providers/>Rule Providers</a></li></ul></li><li><span>Configuration Reference</span><ul><li><a href=../../../docs/configuration/types/>Type Definitions</a></li><li><a href=../../../docs/configuration/reference/>Reference</a></li></ul></li></ul></nav></aside><main class=docs-main><div class="d-md-none docs-location bg-body"><nav style="--bs-breadcrumb-divider:'>'" aria-label=breadcrumb><ol class="breadcrumb mb-0"><li class="breadcrumb-item fw-bold">Mechanisms</li><li class="breadcrumb-item active" aria-current=page>Objects, Templating & Co</li></ol></nav></div><div class="docs-intro pt-3 pe-3"><h1>Objects, Templating & Co</h1><p>The dynamic nature of mechanisms is given by the ability to work on different objects and making use of templates and expressions to implement different use cases.</p></div><aside class="text-muted docs-toc"><strong class="d-md-block h6 pb-2 my-2 ms-2 border-bottom d-none d-md-none d-lg-block">On this page</strong><div id=page-content-toc class="mt-1 mb-3 text-muted d-none d-md-none d-lg-block docs-toc-content"><nav id=TableOfContents><ul><li><a href=#_objects>Objects</a><ul><li><a href=#_subject>Subject</a></li><li><a href=#_request>Request</a></li><li><a href=#_outputs>Outputs</a></li><li><a href=#_payload>Payload</a></li><li><a href=#_error>Error</a></li><li><a href=#_values>Values</a></li></ul></li><li><a href=#_templating>Templating</a></li><li><a href=#_expressions>Expressions</a></li></ul></nav></div><button class="btn btn-outline-secondary text-decoration-none d-lg-none collapsed" type=button data-bs-toggle=collapse data-bs-target=#page-content-toc-collapsible aria-expanded=false aria-controls=page-content-toc-collapsible>
On this page<svg width="16" height="16" fill="currentcolor" class="bi bi-chevron-expand" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M3.646 9.146a.5.5.0 01.708.0L8 12.793l3.646-3.647a.5.5.0 01.708.708l-4 4a.5.5.0 01-.708.0l-4-4a.5.5.0 010-.708m0-2.292a.5.5.0 00.708.0L8 3.207l3.646 3.647a.5.5.0 00.708-.708l-4-4a.5.5.0 00-.708.0l-4 4a.5.5.0 000 .708"/></svg></button><div id=page-content-toc-collapsible class="mt-1 mb-3 text-muted d-lg-none collapse docs-toc-content"><div class="card card-body"><nav id=TableOfContents><ul><li><a href=#_objects>Objects</a><ul><li><a href=#_subject>Subject</a></li><li><a href=#_request>Request</a></li><li><a href=#_outputs>Outputs</a></li><li><a href=#_payload>Payload</a></li><li><a href=#_error>Error</a></li><li><a href=#_values>Values</a></li></ul></li><li><a href=#_templating>Templating</a></li><li><a href=#_expressions>Expressions</a></li></ul></nav></div></div></aside><div class="docs-content pe-3"><div data-bs-spy=scroll data-bs-target=#page-content-toc class=mt-3><linkable-headline-area><div class=paragraph><p>E.g. in one case, you want to have access to a particular request header. In another case you would like to add specific data to the resulting JWT created by heimdall. And in yet another case, you may want to check whether some expectations apply. These capabilities are described on this page.</p></div><div class=sect1><h2 id=_objects>Objects</h2><div class=sectionbody><div class=paragraph><p>Objects represent state in the execution of a particular rule. These are the entities, either created or used by particular mechanisms and can represent things, like the actual request, the authenticated subject of the request and many more.</p></div><div class=sect2><h3 id=_subject>Subject</h3><div class=paragraph><p>This object is created by an authenticator which was able to verify the authentication claim available in the request, and contains the information about the authenticated subject. It has the following properties:</p></div><div class=ulist><ul><li><p><strong><code>ID</code></strong>: <em>string</em></p><div class=paragraph><p>The identifier of the subject.</p></div></li><li><p><strong><code>Attributes</code></strong>: <em>map</em></p><div class=paragraph><p>Contains all attributes, which are known about the subject.</p></div></li></ul></div><div class=paragraph><p>Each object of this type can be thought as a JSON object. Here some examples:</p></div><div class=exampleblock><div class=title>Example 1. Subject created by an Anonymous Authenticator</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=javascript><span class=nx>Subject</span> <span class=o>=</span> <span class=p>{</span>
  <span class=na>ID</span><span class=p>:</span> <span class=dl>&#34;</span><span class=s2>anonymous</span><span class=dl>&#34;</span><span class=p>,</span>
  <span class=na>Attributes</span><span class=p>:</span> <span class=p>{}</span>
<span class=p>}</span></code></pre></div></div></div></div><div class=exampleblock><div class=title>Example 2. Possible Subject created by an OAuth2 Authenticator</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=javascript><span class=nx>Subject</span> <span class=o>=</span> <span class=p>{</span>
  <span class=na>ID</span><span class=p>:</span> <span class=dl>&#34;</span><span class=s2>foobar</span><span class=dl>&#34;</span><span class=p>,</span>
  <span class=na>Attributes</span><span class=p>:</span> <span class=p>{</span>
    <span class=dl>&#34;</span><span class=s2>sub</span><span class=dl>&#34;</span><span class=p>:</span> <span class=dl>&#34;</span><span class=s2>foobar</span><span class=dl>&#34;</span><span class=p>,</span>
    <span class=dl>&#34;</span><span class=s2>exp</span><span class=dl>&#34;</span><span class=p>:</span> <span class=dl>&#34;</span><span class=s2>1670600805</span><span class=dl>&#34;</span><span class=p>,</span>
    <span class=dl>&#34;</span><span class=s2>jti</span><span class=dl>&#34;</span><span class=p>:</span> <span class=dl>&#34;</span><span class=s2>7b91ed8a-0251-4e02-8d51-9792785851e8</span><span class=dl>&#34;</span><span class=p>,</span>
    <span class=dl>&#34;</span><span class=s2>iat</span><span class=dl>&#34;</span><span class=p>:</span> <span class=dl>&#34;</span><span class=s2>1670600305</span><span class=dl>&#34;</span><span class=p>,</span>
    <span class=dl>&#34;</span><span class=s2>iss</span><span class=dl>&#34;</span><span class=p>:</span> <span class=dl>&#34;</span><span class=s2>https://testauthserver.local</span><span class=dl>&#34;</span><span class=p>,</span>
    <span class=dl>&#34;</span><span class=s2>nbf</span><span class=dl>&#34;</span><span class=p>:</span> <span class=dl>&#34;</span><span class=s2>1670600305</span><span class=dl>&#34;</span><span class=p>,</span>
    <span class=dl>&#34;</span><span class=s2>extra</span><span class=dl>&#34;</span><span class=p>:</span> <span class=p>{</span>
        <span class=dl>&#34;</span><span class=s2>foo</span><span class=dl>&#34;</span><span class=p>:</span> <span class=p>[</span><span class=dl>&#34;</span><span class=s2>bar</span><span class=dl>&#34;</span><span class=p>,</span> <span class=dl>&#34;</span><span class=s2>baz</span><span class=dl>&#34;</span><span class=p>]</span>
    <span class=p>}</span>
  <span class=p>}</span>
<span class=p>}</span></code></pre></div></div></div></div></div><div class=sect2><h3 id=_request>Request</h3><div class=paragraph><p>This object contains information about the request handled by heimdall and has the following attributes and methods:</p></div><div class=ulist><ul><li><p><strong><code>Method</code></strong>: <em>string</em></p><div class=paragraph><p>The HTTP method used, like <code>GET</code>, <code>POST</code>, etc.</p></div></li></ul></div><div id=_url_captures class=ulist><ul><li><p><strong><code>URL</code></strong>: <em>URL</em></p><div class=paragraph><p>The URL of the matched request. This object has the following properties and methods:</p></div><div class=ulist><ul><li><p><strong><code>Captures</code></strong>: <em>map</em></p><div class=paragraph><p>Allows accessing of the values captured by the named wildcards used in the matching path expression of the rule.</p></div></li><li><p><strong><code>Host</code></strong>: <em>string</em></p><div class=paragraph><p>The host part of the url.</p></div></li><li><p><strong><code>Hostname()</code></strong>: <em>method</em></p><div class=paragraph><p>This method returns the host name stripping any valid port number if present.</p></div></li><li><p><strong><code>Port()</code></strong>: <em>method</em></p><div class=paragraph><p>Returns the port part of the <code>Host</code>, without the leading colon. If <code>Host</code> doesn’t contain a valid numeric port, returns an empty string.</p></div></li><li><p><strong><code>Path</code></strong>: <em>string</em></p><div class=paragraph><p>The path part of the url.</p></div></li><li><p><strong><code>Query()</code></strong>: <em>method</em></p><div class=paragraph><p>The parsed query with each key-value pair being a string to array of strings mapping.</p></div></li><li><p><strong><code>RawQuery</code></strong>: <em>string</em></p><div class=paragraph><p>The raw query part of the url.</p></div></li><li><p><strong><code>Scheme</code></strong>: <em>string</em></p><div class=paragraph><p>The HTTP scheme part of the url.</p></div></li><li><p><strong><code>String()</code></strong>: <em>method</em></p><div class=paragraph><p>This method returns the URL as valid URL string of a form <code>scheme:host/path?query</code>.</p></div></li></ul></div></li><li><p><strong><code>ClientIPAddresses</code></strong>: <em>string array</em></p><div class=paragraph><p>The list of IP addresses the request passed through with the first entry being the ultimate client of the request. Only available if heimdall is configured to trust the client, sending this information, e.g. in the <code>X-Forwarded-From</code> header (see also <a href=../../../docs/services/main/#_trusted_proxies>trusted_proxies</a> configuration for more details).</p></div></li><li><p><strong><code>Header(name)</code></strong>: <em>method</em>,</p><div class=paragraph><p>This method expects the name of a header as input and returns its value as a <code>string</code>. If the header is not present in the HTTP request an empty string (<code>""</code>) is returned. If a header appears multiple times in the request, the returned <code>string</code> is a comma separated list of all values.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content>A single header may be a comma separated list of actual values as well. Best example is the <code>Accept</code> header, which might be set to e.g. <code>text/html,application/xhtml+xml,application/xml;q=0.9,<strong>/</strong>;q=0.8</code>).</td></tr></tbody></table></div></li><li><p><strong><code>Cookie(name)</code></strong>: <em>method</em>,</p><div class=paragraph><p>This method expects the name of a cookie as input and returns the value of it as <code>string</code>. If the cookie is not present in the HTTP request an empty string (<code>""</code>) is returned.</p></div></li><li><p><strong><code>Body()</code></strong>: <em>method</em>,</p><div class=paragraph><p>The parsed body with contents depending on the <code>Content-Type</code> header. Supported content types are any MIME types with <code>json</code> or <code>yaml</code> subtype, as well as <code>application/x-www-form-urlencoded</code>. If MIME type is unsupported, the method returns a string with the actual body contents.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content>The actual request body is parsed only on the first use of this function. All subsequent calls return the cached result.</td></tr></tbody></table></div><div class=exampleblock><div class=title>Example 3. Example results</div><div class=content><div class=paragraph><p>If the <code>Content-Type</code> header is set to <code>application/json</code> and the actual request body is a valid JSON object, shown below</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=json><span class=p>{</span><span class=w> </span><span class=nl>&#34;context&#34;</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;heimdall&#34;</span><span class=w> </span><span class=p>}</span></code></pre></div></div><div class=paragraph><p>The call to the <code>Body()</code> function will return exactly this representation as a map.</p></div><div class=paragraph><p>If the <code>Content-Type</code> header is set to <code>application/yaml</code> and the actual request body is a valid YAML object, shown below</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=yaml><span class=na>context</span><span class=pi>:</span> <span class=s>heimdall</span></code></pre></div></div><div class=paragraph><p>The call to the <code>Body()</code> function will return <code>{ "context": "heimdall" }</code> representation as a map.</p></div><div class=paragraph><p>If the <code>Content-Type</code> header is set to <code>application/x-www-form-urlencoded</code> and the actual request body is a valid object, shown below</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=yaml><span class=s>context=heimdall</span></code></pre></div></div><div class=paragraph><p>The call to the <code>Body()</code> function will return this representation as a map with each value being a string array. In this particular case as <code>{ "context": [ "heimdall" ] }</code>.</p></div></div></div></li></ul></div><div class=paragraph><p>Here is an example for a request object:</p></div><div class=exampleblock><div class=title>Example 4. Example request object</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=javascript><span class=nx>Request</span> <span class=o>=</span> <span class=p>{</span>
  <span class=na>Method</span><span class=p>:</span> <span class=dl>&#34;</span><span class=s2>GET</span><span class=dl>&#34;</span><span class=p>,</span>
  <span class=na>Url</span><span class=p>:</span> <span class=p>{</span>
    <span class=na>Scheme</span><span class=p>:</span> <span class=dl>&#34;</span><span class=s2>https</span><span class=dl>&#34;</span><span class=p>,</span>
    <span class=na>Host</span><span class=p>:</span> <span class=dl>&#34;</span><span class=s2>localhost</span><span class=dl>&#34;</span><span class=p>,</span>
    <span class=na>Path</span><span class=p>:</span> <span class=dl>&#34;</span><span class=s2>/test/abc</span><span class=dl>&#34;</span><span class=p>,</span>
    <span class=na>RawQuery</span><span class=p>:</span> <span class=dl>&#34;</span><span class=s2>baz=zab&amp;baz=bar&amp;foo=bar</span><span class=dl>&#34;</span><span class=p>,</span>
    <span class=na>Captures</span><span class=p>:</span> <span class=p>{</span> <span class=dl>&#34;</span><span class=s2>value</span><span class=dl>&#34;</span><span class=p>:</span> <span class=dl>&#34;</span><span class=s2>abc</span><span class=dl>&#34;</span> <span class=p>}</span>
  <span class=p>},</span>
  <span class=na>ClientIP</span><span class=p>:</span> <span class=p>[</span><span class=dl>&#34;</span><span class=s2>127.0.0.1</span><span class=dl>&#34;</span><span class=p>,</span> <span class=dl>&#34;</span><span class=s2>10.10.10.10</span><span class=dl>&#34;</span><span class=p>]</span>
<span class=p>}</span></code></pre></div></div></div></div></div><div class=sect2><h3 id=_outputs>Outputs</h3><div class=paragraph><p>This object represents a pipeline execution specific key value map. It is used by pipeline steps to store or read results of particular step executions. Step id is used as a key and the value is the corresponding result.</p></div><div class=paragraph><p>Example:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=javascript><span class=nx>Outputs</span> <span class=o>=</span> <span class=p>{</span>
    <span class=dl>&#34;</span><span class=s2>id_1</span><span class=dl>&#34;</span><span class=p>:</span> <span class=p>[</span><span class=dl>&#34;</span><span class=s2>a</span><span class=dl>&#34;</span><span class=p>,</span> <span class=dl>&#34;</span><span class=s2>b</span><span class=dl>&#34;</span><span class=p>],</span>
    <span class=dl>&#34;</span><span class=s2>id_2</span><span class=dl>&#34;</span><span class=p>:</span> <span class=p>{</span> <span class=dl>&#34;</span><span class=s2>foo</span><span class=dl>&#34;</span><span class=p>:</span> <span class=dl>&#34;</span><span class=s2>bar</span><span class=dl>&#34;</span><span class=p>,</span> <span class=dl>&#34;</span><span class=s2>baz</span><span class=dl>&#34;</span><span class=p>:</span> <span class=kc>false</span> <span class=p>}</span>
<span class=p>}</span></code></pre></div></div></div><div class=sect2><h3 id=_payload>Payload</h3><div class=paragraph><p>This object represents the contents of a payload, like the request body or a response body. The contents depend on the MIME-Type of the payload. For <code>json</code>, <code>yaml</code> or <code>x-www-form-urlencoded</code> encoded payload, the object is transformed to a JSON object. Otherwise, it is just a string.</p></div><div class=paragraph><p>Here some examples:</p></div><div class=exampleblock><div class=title>Example 5. Structured payload</div><div class=content><div class=paragraph><p>The following JSON object is a typical response from OPA.</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=javascript><span class=nx>Payload</span> <span class=o>=</span> <span class=p>{</span> <span class=dl>&#34;</span><span class=s2>result</span><span class=dl>&#34;</span><span class=p>:</span> <span class=kc>true</span> <span class=p>}</span></code></pre></div></div></div></div><div class=exampleblock><div class=title>Example 6. Unstructured payload</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=javascript><span class=nx>Payload</span> <span class=o>=</span> <span class=dl>&#34;</span><span class=s2>SomeStringValue</span><span class=dl>&#34;</span></code></pre></div></div></div></div></div><div class=sect2><h3 id=_error>Error</h3><div class=paragraph><p>This object represents an error, which has been raised during the execution of a rule and is available in <code>if</code> <a href=#_expressions>CEL expressions</a> of <a href=../../../docs/mechanisms/error_handlers/>Error Handlers</a>. Following properties are available:</p></div><div class=ulist><ul><li><p><strong><code>Source</code></strong>: <em>string</em></p><div class=paragraph><p>The ID of the mechanism, which raised the error.</p></div></li><li><p><strong><code>StepID</code></strong>: <em>string</em></p><div class=paragraph><p>The ID of the pipeline step, which raised the error</p></div></li></ul></div><div class=paragraph><p>Proper error handling requires attention to the actual <em><a href=../../../docs/configuration/types/#_errorstate_type>error type</a></em> available via <code>type(Error)</code>.</p></div></div><div class=sect2><h3 id=_values>Values</h3><div class=paragraph><p>This object represents a key value map, with both, the key and the value being of string type. Though, the actual values can be templated (see (<a href=#_templating>Templating</a>). The contents and the variables available in templates depend on the configuration of the particular mechanism, respectively the corresponding override in a rule.</p></div><div class=paragraph><p>Here is an example:</p></div><div class=exampleblock><div class=title>Example 7. Example values object</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=javascript><span class=nx>Values</span> <span class=o>=</span> <span class=p>{</span>
  <span class=dl>&#34;</span><span class=s2>some-key-1</span><span class=dl>&#34;</span><span class=p>:</span> <span class=dl>&#34;</span><span class=s2>value-1</span><span class=dl>&#34;</span><span class=p>,</span>
  <span class=dl>&#34;</span><span class=s2>some-key-2</span><span class=dl>&#34;</span><span class=p>:</span> <span class=dl>&#34;</span><span class=s2>value-2</span><span class=dl>&#34;</span>
<span class=p>}</span></code></pre></div></div></div></div></div></div></div><div class=sect1><h2 id=_templating>Templating</h2><div class=sectionbody><div class=paragraph><p>Some mechanisms support templating using <a href=https://golang.org/pkg/text/template/>Golang Text Templates</a>. Templates can act on all objects described above (<a href=#_subject>Subject</a>, <a href=#_outputs>Outputs</a>, <a href=#_request>Request</a>, <a href=#_payload>Payload</a> and <a href=#_values>Values</a>). Which exactly are supported is mechanism specific.</p></div><div class=paragraph><p>To ease the usage, all <a href=https://masterminds.github.io/sprig/>sprig</a> functions, except <code>env</code> and <code>expandenv</code>, as well as the following functions are available:</p></div><div class=ulist><ul><li><p><code>urlenc</code> - Encodes a given string using url encoding. Is handy if you need to generate request body or query parameters e.g. for communication with further systems.</p></li><li><p><code>atIndex</code> - Implements python-like access to arrays and takes as a single argument the index to access the element in the array at. With index being a positive values it works exactly the same way, as with the usage of the built-in index function to access array elements. With negative index value, one can access the array elements from the tail of the array. -1 is the index of the last element, -2 the index of the element before the last one, etc.</p><div class=paragraph><p>Example: <code>{{ atIndex 2 [1,2,3,4,5] }}</code> evaluates to <code>3</code> (behaves the same way as the <code>index</code> function) and <code>{{ atIndex -2 [1,2,3,4,5] }}</code> evaluates to <code>4</code>.</p></div></li><li><p><code>splitList</code> - Splits a given string using a separator (part of the sprig library, but not documented). The result is a string array.</p><div class=paragraph><p>Example: <code>{{ splitList "/" "/foo/bar" }}</code> evaluates to the <code>["", "foo", "bar"]</code> array.</p></div></li></ul></div><div class=exampleblock><div class=title>Example 8. Rendering a JSON object</div><div class=content><div class=paragraph><p>Imagine, we have a <code>POST</code> request for the URL <code>https://foobar.baz/zab?foo=bar</code>, with a header <code>X-Foo</code> set to <code>bar</code> value, for which heimdall was able to identify a subject, with <code>ID=foo</code> and which <code>Attributes</code> contain an entry <code>email: foo@bar</code>, then you can generate a JSON object with this information with the following template:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=gotemplate>{
  &#34;subject_id&#34;: {{ quote .Subject.ID }},
  &#34;email&#34;: {{ quote .Subject.Attributes.email }},
  &#34;request_url&#34;: {{ quote .Request.URL }},
  &#34;foo_value&#34;: {{ index .Request.URL.Query.foo 0 | quote }}
  &#34;request_method&#34;: {{ quote .Request.Method }},
  &#34;x_foo_value&#34;: {{ .Request.Header &#34;X-Foo&#34; | quote }},
  &#34;whatever&#34;: {{ .Outputs.whatever | quote }}
}</code></pre></div></div><div class=paragraph><p>Please note how the access to the <code>foo</code> query parameter is done. Since <code>.Request.URL.Query.foo</code> returns an array of strings, the first element is taken to render the value for the <code>foo_value</code> key.</p></div><div class=paragraph><p>This will result in the following JSON object:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=json><span class=p>{</span><span class=w>
    </span><span class=nl>&#34;subject_id&#34;</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;foo&#34;</span><span class=p>,</span><span class=w>
    </span><span class=nl>&#34;email&#34;</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;foo@bar.baz&#34;</span><span class=p>,</span><span class=w>
    </span><span class=nl>&#34;request_url&#34;</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;https://foobar.baz/zab?foo=bar&#34;</span><span class=p>,</span><span class=w>
    </span><span class=nl>&#34;foo_value&#34;</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;bar&#34;</span><span class=p>,</span><span class=w>
    </span><span class=nl>&#34;request_method&#34;</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;POST&#34;</span><span class=p>,</span><span class=w>
    </span><span class=nl>&#34;x_foo_value&#34;</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;bar&#34;</span><span class=p>,</span><span class=w>
    </span><span class=nl>&#34;whatever&#34;</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;some value&#34;</span><span class=w>
</span><span class=p>}</span></code></pre></div></div></div></div><div class=exampleblock><div class=title>Example 9. Access to captured path segments</div><div class=content><div class=paragraph><p>Imagine, we have a <code>POST</code> request to the URL <code>https://foobar.baz/zab/1234</code>, with <code>1234</code> being the identifier of a file, which should be updated with the contents sent in the body of the request, and you would like to control access to the aforesaid object using e.g. OpenFGA. This can be achieved with the following authorizer:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=yaml><span class=na>id</span><span class=pi>:</span> <span class=s>openfga_authorizer</span>
<span class=na>type</span><span class=pi>:</span> <span class=s>remote</span>
<span class=na>config</span><span class=pi>:</span>
  <span class=na>endpoint</span><span class=pi>:</span>
    <span class=na>url</span><span class=pi>:</span> <span class=s>https://openfga/stores/files/check</span>
  <span class=na>payload</span><span class=pi>:</span> <span class=pi>|</span>
    <span class=s>{</span>
      <span class=s>&#34;user&#34;: &#34;user:{{ .Subject.ID }}&#34;,</span>
      <span class=s>&#34;relation&#34;: &#34;write&#34;,</span>
      <span class=s>&#34;object&#34;: &#34;file:{{ .Request.URL.Captures.id }}&#34;</span>
    <span class=s>}</span>
  <span class=na>expressions</span><span class=pi>:</span>
  <span class=pi>-</span> <span class=na>expression</span><span class=pi>:</span> <span class=pi>|</span>
      <span class=s>Payload.allowed == true</span></code></pre></div></div><div class=paragraph><p>Please note how the <code>"object"</code> is set in the <code>payload</code> property above. When the <code>payload</code> template is rendered and for the above said request heimdall was able to identify the subject with <code>ID=foo</code>, following JSON object will be created:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=json><span class=p>{</span><span class=w>
  </span><span class=nl>&#34;user&#34;</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;user:foo&#34;</span><span class=p>,</span><span class=w>
  </span><span class=nl>&#34;relation&#34;</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;write&#34;</span><span class=p>,</span><span class=w>
  </span><span class=nl>&#34;object&#34;</span><span class=p>:</span><span class=w> </span><span class=s2>&#34;file:1234&#34;</span><span class=w>
</span><span class=p>}</span></code></pre></div></div></div></div><div class=paragraph><p>You can find further examples as part of mechanism descriptions, supporting templating.</p></div></div></div><div class=sect1><h2 id=_expressions>Expressions</h2><div class=sectionbody><div class=paragraph><p>Expressions can be used to execute conditional logic. Currently, only <a href=https://github.com/google/cel-spec>CEL</a> is supported as expression language. All standard CEL functions, as well as <a href=https://pkg.go.dev/github.com/google/cel-go/ext#pkg-functions>extension functions</a>, are available. The set of available <a href=#_objects>evaluation objects</a> depends on the specific mechanism in use.</p></div><div class=paragraph><p>In addition to the built-in CEL functions, extension methods, and methods on evaluation objects, the following custom functions are also available:</p></div><div class=ulist><ul><li><p><code>at</code> - Provides Python-like access to array elements. A positive index behaves like standard <code>[]</code> array access. A negative index accesses elements from the end of the array (<code>-1</code> is the last element, <code>-2</code> the second-last, etc.).</p><div class=paragraph><p>Example: <code>[1,2,3,4,5].at(2)</code> returns <code>3</code> and <code>[1,2,3,4,5].at(-2)</code> returns <code>4</code>.</p></div></li><li><p><code>last</code> - returns the last element of an array, or nil if the array is empty.</p><div class=paragraph><p>Example: <code>[1,2,3,4,5].last()</code> returns <code>5</code></p></div></li><li><p><code>regexFind</code> - returns the first (leftmost) match of a regular expression within a string.</p><div class=paragraph><p>Example: <code>"abcd1234".regexFind("[a-zA-Z][1-9]")</code> returns <code>"d1"</code>.</p></div></li><li><p><code>regexFindAll</code> - returns an array of all matches of a regular expression within a string.</p><div class=paragraph><p>Example: <code>"123456789".regexFindAll("[2,4,6,8]")</code> returns <code>["2","4","6","8"]</code>.</p></div></li><li><p><code>split</code> - splits a string by the given separator and returns an array of strings.</p><div class=paragraph><p>Example: <code>"/foo/bar/baz".split("/")</code> returns <code>["", "foo", "bar", "baz"]</code>.</p></div></li><li><p><code>networks</code> - accepts a single CIDR string or an array of CIDR strings, and returns a matcher object that can be used to check whether an IP address belongs to one of the specified ranges.</p><div class=paragraph><p>Example: <code>Request.ClientIPAddresses.all(ip in networks(["172.16.0.0/12", "192.168.0.0/16"]))</code> checks whether all IPs in the <code>Request.ClientIPAddresses</code> array belong to the specified IP ranges.</p></div></li></ul></div><div class=paragraph><p>Some examples:</p></div><div class=exampleblock><div class=title>Example 10. Evaluate Payload object</div><div class=content><div class=paragraph><p>Given the following Payload object</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=javascript><span class=nx>Payload</span> <span class=o>=</span> <span class=p>{</span> <span class=dl>&#34;</span><span class=s2>result</span><span class=dl>&#34;</span><span class=p>:</span> <span class=kc>true</span> <span class=p>}</span></code></pre></div></div><div class=paragraph><p>a CEL expression to check whether the <code>result</code> attribute is set to <code>true</code>, would look as follows:</p></div><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=cel>Payload.result == true</code></pre></div></div></div></div><div class=exampleblock><div class=title>Example 11. Check whether the user is member of the admin group</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=cel>has(Subject.Attributes.groups) &amp;&amp;
   Subject.Attributes.groups.exists(g, g == &#34;admin&#34;)</code></pre></div></div></div></div><div class=exampleblock><div class=title>Example 12. Access the last path part of the matched URL</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=cel>Request.URL.Path.split(&#34;/&#34;).last()</code></pre></div></div></div></div><div class=exampleblock><div class=title>Example 13. Check if an error has been raised by an authenticator with the ID "foo"</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight"><code data-lang=cel>type(Error) == authentication_error &amp;&amp; Error.Source == &#34;foo&#34;</code></pre></div></div></div></div></div></div></linkable-headline-area></div><p class="text-end fst-italic fs-7 pb-3">Last updated on <span class=fw-bold>Aug 11, 2025</span></p><hr><div class="d-flex justify-content-between py-3"><a href=../../../docs/mechanisms/catalogue/ class="fs-6 fw-bold text-dark link-secondary link-underline-opacity-0"><svg width="16" height="16" fill="currentcolor" class="bi bi-chevron-left" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M11.354 1.646a.5.5.0 010 .708L5.707 8l5.647 5.646a.5.5.0 01-.708.708l-6-6a.5.5.0 010-.708l6-6a.5.5.0 01.708.0z"/></svg>
Catalogue
</a><a class="ms-auto fs-6 fw-bold text-dark link-secondary link-underline-opacity-0" href=../../../docs/mechanisms/authenticators/>Authenticators<svg width="16" height="16" fill="currentcolor" class="bi bi-chevron-right" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4.646 1.646a.5.5.0 01.708.0l6 6a.5.5.0 010 .708l-6 6a.5.5.0 01-.708-.708L10.293 8 4.646 2.354a.5.5.0 010-.708z"/></svg></a></div></div></main></div><footer class="footer py-4 py-md-5 px-4 px-md-3 mt-3"><div class=container><div class=row><div class="col-lg-3 mb-3"><p class=fs-5>Heimdall</p><ul class="list-unstyled small text-muted"><li class=mb-2>2022-2024 © Heimdall Project Authors. All rights reserved.</li><li class=mb-2><a href=https://github.com/dadrus/heimdall/blob/master/LICENSE>Apache 2.0 licensed</a></li></ul></div><div class="col-6 col-lg-2 offset-lg-1 mb-3"><h5>Links</h5><ul class=list-unstyled><li class=mb-2><a href=../../../>Home</a></li><li class=mb-2><a href=../../../docs/getting_started/discover_heimdall>Docs</a></li><li class=mb-2><a href=../../../guides/>Guides</a></li><li class=mb-2><a href=../../../openapi/>API</a></li></ul></div><div class="col-6 col-lg-2 mb-2"><h5>Guides</h5><ul class=list-unstyled><li class=mb-2><a href=../../../guides/proxies/>API Gateways & Proxies</a></li><li class=mb-2><a href=../../../guides/authz/>Authorization Services</a></li><li class=mb-2><a href=../../../guides/authn/>Authentication Protocols & Services</a></li></ul></div><div class="col-6 col-lg-2 mb-2"><h5>Community</h5><ul class=list-unstyled><li class=mb-2><a href=https://github.com/dadrus/heimdall>Github</a></li><li class=mb-2><a href=https://discord.gg/qQgg8xKuyb>Discord</a></li></ul></div></div></div></footer><script src=../../../js/main.js defer></script></body></html>