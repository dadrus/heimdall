<!doctype html><html lang=en><head><title>Proxy Service Quickstart</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="An open source Identity Aware Proxy and an Access Control Decision service for cloud native applications"><meta name=dc.relation content="https://dadrus.github.io/"><meta name=theme-color content="#1A94D2"><link rel=stylesheet href=../../../css/styles.min.css media=screen><link rel='shortcut icon' type=image/x-icon href=../../../favicon.ico></head><body><header class="navbar navbar-expand-md navbar-dark bg-dark sticky-top"><nav class="container-xxl flex-wrap flex-lg-nowrap" aria-label="Main navigation"><a class="navbar-brand text-white" href=../../../ style=font-weight:500;font-size:1.5rem>Heimdall</a>
<button class=navbar-toggler type=button data-bs-toggle=offcanvas data-bs-target=#mainMenuContent aria-controls=mainMenuContent aria-expanded=false aria-label="Open main menu">
<span class=navbar-toggler-icon></span></button><div class="offcanvas offcanvas-end bg-dark" tabindex=-1 id=mainMenuContent data-bs-scroll=true aria-labelledby=mainMenuContentLabel><div class=offcanvas-header><h5 class="offcanvas-title text-white" id=mainMenuContentLabel>Heimdall</h5><button type=button class="btn-close btn-close-white" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class=offcanvas-body><ul class="navbar-nav flex-column flex-md-row"><li class=nav-item style=display:flex><a class='nav-link text-white' href=../../../docs/welcome style=align-self:center>Docs</a></li><li class=nav-item style=display:flex><a class='nav-link text-white' href=../../../openapi/ style=align-self:center>API</a></li><li class="nav-item dropdown" style=display:flex><a class='nav-link dropdown-toggle text-white active' href=# id="Get Started-navbarDropdown" role=button data-bs-toggle=dropdown aria-expanded=false style=align-self:center>Get Started</a><ul class="dropdown-menu bg-dark" aria-labelledby="Get Started-navbarDropdown"><li><a class='dropdown-item text-white' href=../../../docs/getting_started/concepts/>Concepts</a></li><li><a class='dropdown-item text-white' href=../../../docs/getting_started/decision_service_quickstart/>Decision Service Quickstart</a></li><li><a class='dropdown-item text-white active' href=../../../docs/getting_started/proxy_service_quickstart/>Proxy Service Quickstart</a></li></ul></li><li class="nav-item dropdown" style=display:flex><a class='nav-link dropdown-toggle text-white' href=# id="Integration Guides-navbarDropdown" role=button data-bs-toggle=dropdown aria-expanded=false style=align-self:center>Integration Guides</a><ul class="dropdown-menu bg-dark" aria-labelledby="Integration Guides-navbarDropdown"><li><a class='dropdown-item text-white' href=../../../docs/guides/traefik/>Traefik Proxy Integration</a></li><li><a class='dropdown-item text-white' href=../../../docs/guides/nginx/>NGINX Integration</a></li><li><a class='dropdown-item text-white' href=../../../docs/guides/envoy/>Envoy Integration</a></li><li><a class='dropdown-item text-white' href=../../../docs/guides/opa/>Integration with OPA</a></li><li><a class='dropdown-item text-white' href=../../../docs/guides/contour/>Contour Integration</a></li><li><a class='dropdown-item text-white' href=../../../docs/guides/emissary/>Emissary Ingress Integration</a></li><li><a class='dropdown-item text-white' href=../../../docs/guides/haproxy/>HAProxy Integration</a></li></ul></li></ul><hr class="text-white-50 d-md-none"><ul class="navbar-nav flex-column ms-auto" style=align-self:center><doc-version-select class="nav-item dropdown" version-file=/heimdall/data.json current-version=dev current-page=/docs/getting_started/proxy_service_quickstart/><button class="btn btn-dark dropdown-toggle me-4" data-bs-toggle=dropdown aria-expanded=false>
dev</button></doc-version-select></ul><ul class="navbar-nav flex-column"><li class="nav-item mb-1" style=display:flex><a class="nav-link text-white" style=align-self:center href=https://github.com/dadrus/heimdall><svg xmlns="http://www.w3.org/2000/svg" role="img" width="20" height="20" fill="currentcolor" class="bi bi-github text-white" viewBox="0 0 16 16"><title>GitHub</title><path d="M8 0C3.58.0.0 3.58.0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38.0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95.0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12.0.0.67-.21 2.2.82.64-.18 1.32-.27 2-.27s1.36.09 2 .27c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15.0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48.0 1.07-.01 1.93-.01 2.2.0.21.15.46.55.38A8.012 8.012.0 0016 8c0-4.42-3.58-8-8-8z"/></svg><small class="ms-2 d-md-none">GitHub</small></a></li></ul></div></div></nav></header><nav class="navbar navbar-expand-lg bg-light" aria-label="Docs menu"><div class=container-xxl><div class="row container-fluid"><doc-search class="col-auto me-auto" index-file=/heimdall/dev/index.json path-prefix=/heimdall/dev><form id=docs-search tabindex=1 class="doks-search position-relative me-auto"><input id=search class="form-control search-bar" type=search placeholder="Search docs..." aria-label="Search docs..." autocomplete=off><div id=search-suggestions class="shadow bg-white rounded collapse search-results"></div></form></doc-search><button class="col-auto navbar-toggler" type=button data-bs-toggle=collapse data-bs-target=#docsMenuContent aria-controls=docsMenuContent aria-expanded=false aria-label="Open docs menu"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentcolor" class="bi bi-arrow-down-up" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M11.5 15a.5.5.0 00.5-.5V2.707l3.146 3.147a.5.5.0 00.708-.708l-4-4a.5.5.0 00-.708.0l-4 4a.5.5.0 10.708.708L11 2.707V14.5a.5.5.0 00.5.5zm-7-14a.5.5.0 01.5.5v11.793l3.146-3.147a.5.5.0 01.708.708l-4 4a.5.5.0 01-.708.0l-4-4a.5.5.0 01.708-.708L4 13.293V1.5a.5.5.0 01.5-.5z"/></svg></button></div><div class="row d-md-none"><div class="col-2 collapse navbar-collapse" id=docsMenuContent><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../docs/welcome/>Welcome</a></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-010b85ad56b34c34c7c2a3b2436c740e30428ed5 aria-expanded=true>
Getting Started</button><div id=section-010b85ad56b34c34c7c2a3b2436c740e30428ed5 class="collapse show"><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../docs/getting_started/concepts/>Concepts</a></li><li class=nav-item><a class=nav-link href=../../../docs/getting_started/decision_service_quickstart/>Decision Service Quickstart</a></li><li class=nav-item><a class="nav-link fw-bold" href=../../../docs/getting_started/proxy_service_quickstart/>Proxy Service Quickstart</a></li><li class=nav-item><a class=nav-link href=../../../docs/getting_started/configuration_introduction/>Configuration Introduction</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-a1fdaa6b2a846c8fcf18d414bf8c61db610eda6a aria-expanded=false>
Operations</button><div id=section-a1fdaa6b2a846c8fcf18d414bf8c61db610eda6a class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../docs/operations/install/>Install</a></li><li class=nav-item><a class=nav-link href=../../../docs/operations/cli/>CLI</a></li><li class=nav-item><a class=nav-link href=../../../docs/operations/observability/>Observability</a></li><li class=nav-item><a class=nav-link href=../../../docs/operations/security/>Security</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-63bf47d7b1e91548862e3da277e46e20a4b75401 aria-expanded=false>
Integration Guides</button><div id=section-63bf47d7b1e91548862e3da277e46e20a4b75401 class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../docs/guides/traefik/>Traefik Proxy Integration</a></li><li class=nav-item><a class=nav-link href=../../../docs/guides/nginx/>NGINX Integration</a></li><li class=nav-item><a class=nav-link href=../../../docs/guides/envoy/>Envoy Integration</a></li><li class=nav-item><a class=nav-link href=../../../docs/guides/opa/>Integration with OPA</a></li><li class=nav-item><a class=nav-link href=../../../docs/guides/contour/>Contour Integration</a></li><li class=nav-item><a class=nav-link href=../../../docs/guides/emissary/>Emissary Ingress Integration</a></li><li class=nav-item><a class=nav-link href=../../../docs/guides/haproxy/>HAProxy Integration</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-754164850f38c1ecdaf6b8ed894cb192bc36c5f4 aria-expanded=false>
Configuration</button><div id=section-754164850f38c1ecdaf6b8ed894cb192bc36c5f4 class=collapse><ul class="nav flex-column"><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-5cbd584046863bc7b753e57e8681a98a87f36f0f aria-expanded=false>
Services</button><div id=section-5cbd584046863bc7b753e57e8681a98a87f36f0f class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../docs/configuration/services/decision/>Decision</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/services/proxy/>Proxy</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/services/management/>Management</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-e2397377af6d698b0fb66f53c47349a85bd2cb00 aria-expanded=false>
Observability</button><div id=section-e2397377af6d698b0fb66f53c47349a85bd2cb00 class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../docs/configuration/observability/logging/>Logging</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/observability/metrics/>Metrics</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/observability/tracing/>Tracing</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/observability/profiling/>Runtime Profiling</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-bb11a8e3f8712e36e7cd9d1c615a4e3dbb03336a aria-expanded=false>
Rules</button><div id=section-bb11a8e3f8712e36e7cd9d1c615a4e3dbb03336a class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../docs/configuration/rules/overview/>Rules Overview</a></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-83ebcaaac1209f17a08fa17b9b1837aca7b222f7 aria-expanded=false>
Pipeline Mechanisms</button><div id=section-83ebcaaac1209f17a08fa17b9b1837aca7b222f7 class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../docs/configuration/rules/pipeline_mechanisms/overview/>Mechanisms Overview</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/rules/pipeline_mechanisms/authenticators/>Authenticators</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/rules/pipeline_mechanisms/authorizers/>Authorizers</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/rules/pipeline_mechanisms/contextualizers/>Contextualizers</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/rules/pipeline_mechanisms/finalizers/>Finalizers</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/rules/pipeline_mechanisms/error_handlers/>Error Handlers</a></li></ul></div></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/rules/configuration/>Rule</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/rules/default/>Default Rule</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/rules/providers/>Rule Providers</a></li></ul></div></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/cryptographic_material/>Cryptographic Material</a></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-db1c784524e1b54011a95823026161f7c8517fe0 aria-expanded=false>
Reference</button><div id=section-db1c784524e1b54011a95823026161f7c8517fe0 class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../docs/configuration/reference/types/>Configuration Types</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/reference/reference/>Static Configuration Reference</a></li></ul></div></li></ul></div></li></ul></div></div></div></nav><div class="container-xxl d-xxl-flex"><aside class="d-none d-md-block pe-4 pt-4 flex-xxl-shrink-0"><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../docs/welcome/>Welcome</a></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-010b85ad56b34c34c7c2a3b2436c740e30428ed5 aria-expanded=true>
Getting Started</button><div id=section-010b85ad56b34c34c7c2a3b2436c740e30428ed5 class="collapse show"><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../docs/getting_started/concepts/>Concepts</a></li><li class=nav-item><a class=nav-link href=../../../docs/getting_started/decision_service_quickstart/>Decision Service Quickstart</a></li><li class=nav-item><a class="nav-link fw-bold" href=../../../docs/getting_started/proxy_service_quickstart/>Proxy Service Quickstart</a></li><li class=nav-item><a class=nav-link href=../../../docs/getting_started/configuration_introduction/>Configuration Introduction</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-a1fdaa6b2a846c8fcf18d414bf8c61db610eda6a aria-expanded=false>
Operations</button><div id=section-a1fdaa6b2a846c8fcf18d414bf8c61db610eda6a class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../docs/operations/install/>Install</a></li><li class=nav-item><a class=nav-link href=../../../docs/operations/cli/>CLI</a></li><li class=nav-item><a class=nav-link href=../../../docs/operations/observability/>Observability</a></li><li class=nav-item><a class=nav-link href=../../../docs/operations/security/>Security</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-63bf47d7b1e91548862e3da277e46e20a4b75401 aria-expanded=false>
Integration Guides</button><div id=section-63bf47d7b1e91548862e3da277e46e20a4b75401 class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../docs/guides/traefik/>Traefik Proxy Integration</a></li><li class=nav-item><a class=nav-link href=../../../docs/guides/nginx/>NGINX Integration</a></li><li class=nav-item><a class=nav-link href=../../../docs/guides/envoy/>Envoy Integration</a></li><li class=nav-item><a class=nav-link href=../../../docs/guides/opa/>Integration with OPA</a></li><li class=nav-item><a class=nav-link href=../../../docs/guides/contour/>Contour Integration</a></li><li class=nav-item><a class=nav-link href=../../../docs/guides/emissary/>Emissary Ingress Integration</a></li><li class=nav-item><a class=nav-link href=../../../docs/guides/haproxy/>HAProxy Integration</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-754164850f38c1ecdaf6b8ed894cb192bc36c5f4 aria-expanded=false>
Configuration</button><div id=section-754164850f38c1ecdaf6b8ed894cb192bc36c5f4 class=collapse><ul class="nav flex-column"><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-5cbd584046863bc7b753e57e8681a98a87f36f0f aria-expanded=false>
Services</button><div id=section-5cbd584046863bc7b753e57e8681a98a87f36f0f class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../docs/configuration/services/decision/>Decision</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/services/proxy/>Proxy</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/services/management/>Management</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-e2397377af6d698b0fb66f53c47349a85bd2cb00 aria-expanded=false>
Observability</button><div id=section-e2397377af6d698b0fb66f53c47349a85bd2cb00 class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../docs/configuration/observability/logging/>Logging</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/observability/metrics/>Metrics</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/observability/tracing/>Tracing</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/observability/profiling/>Runtime Profiling</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-bb11a8e3f8712e36e7cd9d1c615a4e3dbb03336a aria-expanded=false>
Rules</button><div id=section-bb11a8e3f8712e36e7cd9d1c615a4e3dbb03336a class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../docs/configuration/rules/overview/>Rules Overview</a></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-83ebcaaac1209f17a08fa17b9b1837aca7b222f7 aria-expanded=false>
Pipeline Mechanisms</button><div id=section-83ebcaaac1209f17a08fa17b9b1837aca7b222f7 class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../docs/configuration/rules/pipeline_mechanisms/overview/>Mechanisms Overview</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/rules/pipeline_mechanisms/authenticators/>Authenticators</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/rules/pipeline_mechanisms/authorizers/>Authorizers</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/rules/pipeline_mechanisms/contextualizers/>Contextualizers</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/rules/pipeline_mechanisms/finalizers/>Finalizers</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/rules/pipeline_mechanisms/error_handlers/>Error Handlers</a></li></ul></div></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/rules/configuration/>Rule</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/rules/default/>Default Rule</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/rules/providers/>Rule Providers</a></li></ul></div></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/cryptographic_material/>Cryptographic Material</a></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-db1c784524e1b54011a95823026161f7c8517fe0 aria-expanded=false>
Reference</button><div id=section-db1c784524e1b54011a95823026161f7c8517fe0 class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../docs/configuration/reference/types/>Configuration Types</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/reference/reference/>Static Configuration Reference</a></li></ul></div></li></ul></div></li></ul></aside><main class="px-3 pt-4 flex-xxl-grow-0"><h1>Proxy Service Quickstart</h1><div><linkable-headline-area><div class=paragraph><p>This document describes a simple use case in which you’ll see heimdall’s Proxy service in action. Here, we’ll create a minimal but complete environment for running heimdall with containers.</p></div><div class=sect1><h2 id=_prerequisites>Prerequisites</h2><div class=sectionbody><div class=ulist><ul><li><p><a href=https://docs.docker.com/install/>Docker</a> and</p></li><li><p><a href=https://docs.docker.com/compose/install/>docker-compose</a></p></li></ul></div></div></div><div class=sect1><h2 id=_configure>Configure</h2><div class=sectionbody><div class=paragraph><p>Heimdall can be configured via environment variables, as well as using a configuration file. For simplicity reasons, we’ll use a configuration file here.</p></div><div class="olist arabic"><ol class=arabic><li><p>Create a config file (<code>config.yaml</code>) with the following content:</p><div class=listingblock><div class=content><pre class="rouge highlight" style=color:#fff;background-color:#272822><code data-lang=yaml><span style=color:#a6e22e>log</span><span style=color:#fff;background-color:#272822>:</span>
  <span style=color:#a6e22e>level</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>info</span>  <i class=conum data-value=1></i><b>(1)</b>

<span style=color:#a6e22e>mechanisms</span><span style=color:#fff;background-color:#272822>:</span>
  <span style=color:#a6e22e>authenticators</span><span style=color:#fff;background-color:#272822>:</span>
  <span style=color:#fff;background-color:#272822>-</span> <span style=color:#a6e22e>id</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>anonymous_authenticator</span>  <i class=conum data-value=2></i><b>(2)</b>
    <span style=color:#a6e22e>type</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>anonymous</span>
  <span style=color:#a6e22e>authorizers</span><span style=color:#fff;background-color:#272822>:</span>
  <span style=color:#fff;background-color:#272822>-</span> <span style=color:#a6e22e>id</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>deny_all_requests</span>  <i class=conum data-value=3></i><b>(3)</b>
    <span style=color:#a6e22e>type</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>deny</span>
  <span style=color:#fff;background-color:#272822>-</span> <span style=color:#a6e22e>id</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>allow_all_requests</span>  <i class=conum data-value=4></i><b>(4)</b>
    <span style=color:#a6e22e>type</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>allow</span>
  <span style=color:#a6e22e>finalizers</span><span style=color:#fff;background-color:#272822>:</span>
  <span style=color:#fff;background-color:#272822>-</span> <span style=color:#a6e22e>id</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>create_jwt</span>  <i class=conum data-value=5></i><b>(5)</b>
    <span style=color:#a6e22e>type</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>jwt</span>

<span style=color:#a6e22e>default_rule</span><span style=color:#fff;background-color:#272822>:</span>  <i class=conum data-value=6></i><b>(6)</b>
  <span style=color:#a6e22e>methods</span><span style=color:#fff;background-color:#272822>:</span>
  <span style=color:#fff;background-color:#272822>-</span> <span style=color:#e6db74>GET</span>
  <span style=color:#fff;background-color:#272822>-</span> <span style=color:#e6db74>POST</span>
  <span style=color:#a6e22e>execute</span><span style=color:#fff;background-color:#272822>:</span>
  <span style=color:#fff;background-color:#272822>-</span> <span style=color:#a6e22e>authenticator</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>anonymous_authenticator</span>
  <span style=color:#fff;background-color:#272822>-</span> <span style=color:#a6e22e>authorizer</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>deny_all_requests</span>

<span style=color:#a6e22e>providers</span><span style=color:#fff;background-color:#272822>:</span>
  <span style=color:#a6e22e>file_system</span><span style=color:#fff;background-color:#272822>:</span>  <i class=conum data-value=7></i><b>(7)</b>
    <span style=color:#a6e22e>src</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>/heimdall/conf/rule.yaml</span>
    <span style=color:#a6e22e>watch</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#66d9ef>true</span></code></pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>Here we are setting the log level to <code>info</code> to be able to see any log output. By default, heimdall logs on <code>error</code> log level.</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>Configures the <code>anonymous</code> authenticator.</td></tr><tr><td><i class=conum data-value=3></i><b>3</b></td><td>Configures the <code>deny</code> authorizer, which rejects all requests.</td></tr><tr><td><i class=conum data-value=4></i><b>4</b></td><td>Configures the <code>allow</code> authorizer. It will be used in our rule to allow requests.</td></tr><tr><td><i class=conum data-value=5></i><b>5</b></td><td>Configures the <code>jwt</code> finalizer.</td></tr><tr><td><i class=conum data-value=6></i><b>6</b></td><td>Configures the default rule.</td></tr><tr><td><i class=conum data-value=7></i><b>7</b></td><td>Configures the <code>file_system</code> provider, which will allow loading of our rule from the file system.</td></tr></tbody></table></div><div class=paragraph><p>Put together, this configuration will let heimdall create a JSON Web Token (JWT) with <code>sub</code> claim set to <code>anonymous</code> for every request on every URL for the HTTP methods GET and POST. The JWT itself will be put into the <code>Authorization</code> header as a bearer token. Since the above default rule cannot be used to forward requests to the upstream service, the <code>deny</code> authenticator will reject the requests for us and enforce a configuration of an authorization mechanism in a specific rule, which we’re going to define next.</p></div></li><li><p>Create a rule file (<code>rule.yaml</code>) with the following contents:</p><div class=listingblock><div class=content><pre class="rouge highlight" style=color:#fff;background-color:#272822><code data-lang=yaml><span style=color:#a6e22e>version</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>1alpha2&#34;</span>
<span style=color:#a6e22e>rules</span><span style=color:#fff;background-color:#272822>:</span>
<span style=color:#fff;background-color:#272822>-</span> <span style=color:#a6e22e>id</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>rule1</span>  <i class=conum data-value=1></i><b>(1)</b>
  <span style=color:#a6e22e>match</span><span style=color:#fff;background-color:#272822>:</span>
    <span style=color:#a6e22e>url</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>http://&lt;**&gt;/anonymous</span>
  <span style=color:#a6e22e>forward_to</span><span style=color:#fff;background-color:#272822>:</span>
    <span style=color:#a6e22e>host</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>upstream</span>
  <span style=color:#a6e22e>execute</span><span style=color:#fff;background-color:#272822>:</span>
    <span style=color:#fff;background-color:#272822>-</span> <span style=color:#a6e22e>authorizer</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>allow_all_requests</span>
    <span style=color:#fff;background-color:#272822>-</span> <span style=color:#a6e22e>finalizer</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>create_jwt</span>

<span style=color:#fff;background-color:#272822>-</span> <span style=color:#a6e22e>id</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>rule2</span>  <i class=conum data-value=2></i><b>(2)</b>
  <span style=color:#a6e22e>match</span><span style=color:#fff;background-color:#272822>:</span>
    <span style=color:#a6e22e>url</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>http://&lt;**&gt;/public</span>
  <span style=color:#a6e22e>forward_to</span><span style=color:#fff;background-color:#272822>:</span>
    <span style=color:#a6e22e>host</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>upstream</span>
  <span style=color:#a6e22e>execute</span><span style=color:#fff;background-color:#272822>:</span>
    <span style=color:#fff;background-color:#272822>-</span> <span style=color:#a6e22e>authorizer</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>allow_all_requests</span></code></pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>This rule matches any host and the <code>/anonymous</code> path and forwards the request to our upstream service (which we’re going to define next). In addition, it reuses the configuration from the default rule. Here, the methods, which are allowed, as well as the authenticator. So we don’t need to define them in the rule.</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>This rule matches any host and the <code>/public</code> path and forwards the request as the previous rule to our upstream service. This rule doesn’t perform any kind of request verification or transformation.</td></tr></tbody></table></div></li><li><p>Create or copy the following <code>docker-compose.yaml</code> file and modify it to include the correct paths to your <code>config.yaml</code> and <code>rule.yaml</code> files:</p><div class=listingblock><div class=content><pre class="rouge highlight" style=color:#fff;background-color:#272822><code data-lang=yaml><span style=color:#a6e22e>version</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>3&#34;</span>

<span style=color:#a6e22e>services</span><span style=color:#fff;background-color:#272822>:</span>
  <span style=color:#a6e22e>heimdall</span><span style=color:#fff;background-color:#272822>:</span>  <i class=conum data-value=1></i><b>(1)</b>
    <span style=color:#a6e22e>image</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>dadrus/heimdall:latest</span>
    <span style=color:#a6e22e>volumes</span><span style=color:#fff;background-color:#272822>:</span>
      <span style=color:#75715e># Mount your config file:</span>
      <span style=color:#fff;background-color:#272822>-</span> <span style=color:#e6db74>./config.yaml:/heimdall/conf/config.yaml:ro</span>
      <span style=color:#75715e># Mount your rule file:</span>
      <span style=color:#fff;background-color:#272822>-</span> <span style=color:#e6db74>./rule.yaml:/heimdall/conf/rule.yaml:ro</span>
    <span style=color:#a6e22e>ports</span><span style=color:#fff;background-color:#272822>:</span>
      <span style=color:#fff;background-color:#272822>-</span> <span style=color:#e6db74>4455:4455</span>
    <span style=color:#a6e22e>command</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>-c /heimdall/conf/config.yaml serve proxy</span>

  <span style=color:#a6e22e>upstream</span><span style=color:#fff;background-color:#272822>:</span>  <i class=conum data-value=2></i><b>(2)</b>
    <span style=color:#a6e22e>image</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>containous/whoami:latest</span></code></pre></div></div><div class="colist arabic"><table><tbody><tr><td><i class=conum data-value=1></i><b>1</b></td><td>Configures heimdall to use our config and rule files and to run in proxy operation mode.</td></tr><tr><td><i class=conum data-value=2></i><b>2</b></td><td>Configures the "upstream" service. Here it is a very simple service, which just echoes back everything it receives.</td></tr></tbody></table></div></li></ol></div></div></div><div class=sect1><h2 id=_run>Run</h2><div class=sectionbody><div class=paragraph><p>Run docker compose:</p></div><div class=listingblock><div class=content><pre class="rouge highlight" style=color:#fff;background-color:#272822><code data-lang=bash><span style=color:#fff;background-color:#272822>$ </span>docker-compose up</code></pre></div></div><div class=paragraph><p>Docker will automatically download the required container images. Then, heimdall will start in the <a href=../../../docs/getting_started/concepts/#_proxy_mode>proxy</a> mode and run with the configuration details set in the previous steps. You’ll then be able to see an output similar to</p></div><div class=listingblock><div class=content><pre class="rouge highlight" style=color:#fff;background-color:#272822><code data-lang=bash>Creating network <span style=color:#e6db74>&#34;heimdall_default&#34;</span> with the default driver
Starting heimdall_heimdall_1 ... <span style=color:#f92672>done
</span>Starting heimdall_upstream_1 ... <span style=color:#f92672>done
</span>Attaching to heimdall_heimdall_1, heimdall_upstream_1
upstream_1  | Starting up on port 80
heimdall_1  | 2022-08-04T07:50:08+02:00 INF No opentracing provider configured. Tracing will be disabled.
heimdall_1  | 2022-08-04T07:50:08+02:00 INF Instantiating <span style=color:#f92672>in </span>memory cache
heimdall_1  | 2022-08-04T07:50:08+02:00 INF Loading pipeline definitions
heimdall_1  | 2022-08-04T07:50:08+02:00 WRN Key store is not configured. NEVER DO IT IN PRODUCTION!!!!
                                        Generating an RSA key pair.
heimdall_1  | 2022-08-04T07:50:08+02:00 WRN No key <span style=color:#f6aa11>id </span><span style=color:#f92672>for </span>signer configured. Taking first entry from the
                                        key store
heimdall_1  | 2022-08-04T07:50:08+02:00 INF Starting cache evictor
heimdall_1  | 2022-08-04T07:50:08+02:00 INF Starting rule definition loader
heimdall_1  | 2022-08-04T07:50:08+02:00 INF Starting rule definitions provider: file_system
heimdall_1  | 2022-08-04T07:50:08+02:00 INF Loading initial rule <span style=color:#f6aa11>set
</span>heimdall_1  | 2022-08-04T07:50:08+02:00 INF Rule <span style=color:#f6aa11>set </span>changed <span style=color:#fff;background-color:#272822>src</span><span style=color:#f92672>=</span>file_system:/heimdall/conf/rule.yaml
                                        <span style=color:#f6aa11>type</span><span style=color:#f92672>=</span>Create
heimdall_1  | 2022-08-04T07:50:08+02:00 INF Loading rule <span style=color:#f6aa11>set </span><span style=color:#fff;background-color:#272822>src</span><span style=color:#f92672>=</span>file_system:/heimdall/conf/rule.yaml
heimdall_1  | 2022-08-04T07:50:08+02:00 INF Metrics service starts listening on: :9000
heimdall_1  | 2022-08-04T07:50:08+02:00 INF Proxy service starts listening on: :4455
heimdall_1  | 2022-08-04T07:50:08+02:00 INF Management service starts listening on: :4457</code></pre></div></div><div class=paragraph><p>Ignore the warnings. They are expected and will not have any effects in this case.</p></div></div></div><div class=sect1><h2 id=_use>Use</h2><div class=sectionbody><div class=paragraph><p>Send a request to heimdall’s proxy endpoint:</p></div><div class=listingblock><div class=content><pre class="rouge highlight" style=color:#fff;background-color:#272822><code data-lang=bash><span style=color:#fff;background-color:#272822>$ </span>curl <span style=color:#f92672>-v</span> 127.0.0.1:4455/foobar</code></pre></div></div><div class=paragraph><p>Here, heimdall will not match any of the defined rules, which will result in the execution of the default rule. Thus, you’ll see <code>403 Forbidden</code> as answer.</p></div><div class=paragraph><p>Try sending requests to the <code>/public</code> and the <code>/anonymous</code> endpoints and see what happens. In both cases, the response will be an HTTP <code>200 OK</code>. And the response from the <code>/anonymous</code> endpoint will also contain an <code>Authorization</code> header containing a JWT, e.g. as shown below.</p></div><div class=listingblock><div class=content><pre class="rouge highlight" style=color:#fff;background-color:#272822><code data-lang=bash><span style=color:#f92672>*</span>   Trying 127.0.0.1:4455...
<span style=color:#f92672>*</span> Connected to 127.0.0.1 <span style=color:#f92672>(</span>127.0.0.1<span style=color:#f92672>)</span> port 4455 <span style=color:#f92672>(</span><span style=color:#75715e>#0)</span>
<span style=color:#f92672>&gt;</span> GET /foobar HTTP/1.1
<span style=color:#f92672>&gt;</span> Host: 127.0.0.1:4455
<span style=color:#f92672>&gt;</span> User-Agent: curl/7.74.0
<span style=color:#f92672>&gt;</span> Accept: <span style=color:#f92672>*</span>/<span style=color:#f92672>*</span>
<span style=color:#f92672>&gt;</span>
<span style=color:#f92672>*</span> Mark bundle as not supporting multiuse
&lt; HTTP/1.1 200 OK
&lt; Date: Thu, 04 Aug 2022 07:53:41 GMT
&lt; Content-Type: text/plain<span style=color:#fff;background-color:#272822>;</span> <span style=color:#fff;background-color:#272822>charset</span><span style=color:#f92672>=</span>utf-8
&lt; Content-Length: 872
&lt;
Hostname: 4f809f75f31b
IP: 127.0.0.1
IP: 172.22.0.3
RemoteAddr: 172.22.0.2:42100
GET /foobar HTTP/1.1
Host: upstream
User-Agent: curl/7.74.0
Accept: <span style=color:#f92672>*</span>/<span style=color:#f92672>*</span>
Authorization: Bearer eyJhbGciOiJQUzI1NiIsImtpZCI6IjNhYjFiMDdmMmMyNjlkMWVlMTRjNzQ2NDA4
OTAyZjRlNWQ1MDAyOTgiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2NTkzMzczMjEsImlhdCI6MTY1OTMzNzAyMSw
iaXNzIjoiaGVpbWRhbGwiLCJqdGkiOiJjMmEzNjczMy04ZDBjLTQzYWQtOGFkNi0xM2Q4NGVhNDI1MTgiLCJuY
mYiOjE2NTkzMzcwMjEsInN1YiI6ImFub255bW91cyJ9.gw-h15LaUUYV-Sjk6Vf-kZflnZxn88lejVIIatKliv
FkeUz8oo9x9juKBSzr4nIVWjGZ_atGVmLoKshudHdnpvABx5cgBaz2_KDgifVzGORE1zld9vGDpU7IPjOyC9-M
b7vOOA1fq9pbQ4nfXw100AJJKFXSct9cYa3163kk_s-jEIPclhB0ZiPqGI-t_GiYJBCVKOTJPkkLKB51KCgn2y
PvO3qLCwO81JdCSFG9k2WLjWZlQe-a8u4El-2qctx8yB-vBFPIaQlwCJh66of3hcUs98IoVlMLGdTJSI4pX9nK
s8OMxVO37eI501gZXXkF5IiSsRAqV_o8pMcGZ47Ztg
Forwarded: <span style=color:#f92672>for</span><span style=color:#f92672>=</span>172.22.0.1<span style=color:#fff;background-color:#272822>;</span><span style=color:#fff;background-color:#272822>proto</span><span style=color:#f92672>=</span>http
X-Forwarded-For: 172.22.0.1

<span style=color:#f92672>*</span> Connection <span style=color:#75715e>#0 to host 127.0.0.1 left intact</span></code></pre></div></div><div class=paragraph><p>You should also be able to see similar output as below from the docker-compose environment:</p></div><div class=listingblock><div class=content><pre class="rouge highlight" style=color:#fff;background-color:#272822><code data-lang=bash>...
2022-08-04T07:53:41+02:00 INF TX started <span style=color:#fff;background-color:#272822>_client_ip</span><span style=color:#f92672>=</span>127.0.0.1 <span style=color:#fff;background-color:#272822>_http_host</span><span style=color:#f92672>=</span>127.0.0.1:4455 <span style=color:#fff;background-color:#272822>_http_method</span><span style=color:#f92672>=</span>GET
 <span style=color:#fff;background-color:#272822>_http_path</span><span style=color:#f92672>=</span>/foobar <span style=color:#fff;background-color:#272822>_http_scheme</span><span style=color:#f92672>=</span>http <span style=color:#fff;background-color:#272822>_http_user_agent</span><span style=color:#f92672>=</span>curl/7.74.0 <span style=color:#fff;background-color:#272822>_tx_start</span><span style=color:#f92672>=</span>1659599621
2022-08-04T07:53:41+02:00 INF TX finished <span style=color:#fff;background-color:#272822>_access_granted</span><span style=color:#f92672>=</span><span style=color:#f6aa11>true </span><span style=color:#fff;background-color:#272822>_body_bytes_sent</span><span style=color:#f92672>=</span>872 <span style=color:#fff;background-color:#272822>_client_ip</span><span style=color:#f92672>=</span>127.0.0.1
 <span style=color:#fff;background-color:#272822>_http_host</span><span style=color:#f92672>=</span>127.0.0.1:4455 <span style=color:#fff;background-color:#272822>_http_method</span><span style=color:#f92672>=</span>GET <span style=color:#fff;background-color:#272822>_http_path</span><span style=color:#f92672>=</span>/foobar <span style=color:#fff;background-color:#272822>_http_scheme</span><span style=color:#f92672>=</span>http <span style=color:#fff;background-color:#272822>_http_status_code</span><span style=color:#f92672>=</span>200
 <span style=color:#fff;background-color:#272822>_http_user_agent</span><span style=color:#f92672>=</span>curl/7.74.0 <span style=color:#fff;background-color:#272822>_subject</span><span style=color:#f92672>=</span>anonymous <span style=color:#fff;background-color:#272822>_tx_duration_ms</span><span style=color:#f92672>=</span>0 <span style=color:#fff;background-color:#272822>_tx_start</span><span style=color:#f92672>=</span>1659599621</code></pre></div></div><div class=paragraph><p>By the way, this quickstart is also available on <a href=https://github.com/dadrus/heimdall/tree/main/examples/docker-compose/quickstarts>GitHub</a>.</p></div></div></div></linkable-headline-area></div><p class="text-end fst-italic fs-7">Last updated on <span class=fw-bold>Nov 14, 2023</span></p><div class="d-flex justify-content-between"><a href=../../../docs/getting_started/decision_service_quickstart/><div class="fs-6 mb-3"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentcolor" class="bi bi-chevron-left" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M11.354 1.646a.5.5.0 010 .708L5.707 8l5.647 5.646a.5.5.0 01-.708.708l-6-6a.5.5.0 010-.708l6-6a.5.5.0 01.708.0z"/></svg>Decision Service Quickstart</div></a><a class=ms-auto href=../../../docs/getting_started/configuration_introduction/><div class="fs-6 mb-3">Configuration Introduction<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentcolor" class="bi bi-chevron-right" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4.646 1.646a.5.5.0 01.708.0l6 6a.5.5.0 010 .708l-6 6a.5.5.0 01-.708-.708L10.293 8 4.646 2.354a.5.5.0 010-.708z"/></svg></div></a></div></main></div><footer class="footer py-4 py-md-5 px-4 px-md-3"><div class=container><div class=row><div class="col-lg-3 mb-3"><p class=fs-5>Heimdall</p><ul class="list-unstyled small text-muted"><li class=mb-2>2022-2023 © Heimdall Project Authors. All rights reserved.</li><li class=mb-2><a href=https://github.com/dadrus/heimdall/blob/master/LICENSE>Apache 2.0 licensed</a></li></ul></div><div class="col-6 col-lg-2 offset-lg-1 mb-3"><h5>Links</h5><ul class=list-unstyled><li class=mb-2><a href=../../../>Home</a></li><li class=mb-2><a href=../../../docs/welcome>Docs</a></li><li class=mb-2><a href=../../../openapi/>API</a></li></ul></div><div class="col-6 col-lg-2 mb-2"><h5>Guides</h5><ul class=list-unstyled><li class=mb-2><a href=../../../docs/operations/install/>Install</a></li><li class=mb-2><a href=../../../docs/getting_started/>Getting Started</a></li><li class=mb-2><a href=../../../docs/guides/>Integration Guides</a></li></ul></div><div class="col-6 col-lg-2 mb-2"><h5>Community</h5><ul class=list-unstyled><li class=mb-2><a href=https://github.com/dadrus/heimdall>Github</a></li><li class=mb-2><a href=https://discord.gg/qQgg8xKuyb>Discord</a></li></ul></div></div></div></footer><script src=../../../js/main.js defer></script>
<script src=https://cdn.redoc.ly/redoc/latest/bundles/redoc.standalone.js></script></body></html>