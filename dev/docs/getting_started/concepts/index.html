<!doctype html><html lang=en><head><title>Concepts</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="An open source Identity Aware Proxy and an Access Control Decision service for cloud native applications"><meta name=dc.relation content="https://dadrus.github.io/"><meta name=theme-color content="#1A94D2"><link rel=stylesheet href=../../../css/styles.min.css media=screen><link rel='shortcut icon' type=image/x-icon href=../../../favicon.ico></head><body><header class="navbar navbar-expand-md navbar-dark bg-dark sticky-top"><nav class="container-xxl flex-wrap flex-lg-nowrap" aria-label="Main navigation"><a class="navbar-brand text-white" href=../../../ style=font-weight:500;font-size:1.5rem>Heimdall</a>
<button class=navbar-toggler type=button data-bs-toggle=offcanvas data-bs-target=#mainMenuContent aria-controls=mainMenuContent aria-expanded=false aria-label="Open main menu">
<span class=navbar-toggler-icon></span></button><div class="offcanvas offcanvas-end bg-dark" tabindex=-1 id=mainMenuContent data-bs-scroll=true aria-labelledby=mainMenuContentLabel><div class=offcanvas-header><h5 class="offcanvas-title text-white" id=mainMenuContentLabel>Heimdall</h5><button type=button class="btn-close btn-close-white" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class=offcanvas-body><ul class="navbar-nav flex-column flex-md-row"><li class=nav-item style=display:flex><a class='nav-link text-white' href=../../../docs/welcome style=align-self:center>Docs</a></li><li class=nav-item style=display:flex><a class='nav-link text-white' href=../../../openapi/ style=align-self:center>API</a></li><li class="nav-item dropdown" style=display:flex><a class='nav-link dropdown-toggle text-white active' href=# id="Get Started-navbarDropdown" role=button data-bs-toggle=dropdown aria-expanded=false style=align-self:center>Get Started</a><ul class="dropdown-menu bg-dark" aria-labelledby="Get Started-navbarDropdown"><li><a class='dropdown-item text-white active' href=../../../docs/getting_started/concepts/>Concepts</a></li><li><a class='dropdown-item text-white' href=../../../docs/getting_started/decision_service_quickstart/>Decision Service Quickstart</a></li><li><a class='dropdown-item text-white' href=../../../docs/getting_started/proxy_service_quickstart/>Proxy Service Quickstart</a></li></ul></li><li class="nav-item dropdown" style=display:flex><a class='nav-link dropdown-toggle text-white' href=# id="Integration Guides-navbarDropdown" role=button data-bs-toggle=dropdown aria-expanded=false style=align-self:center>Integration Guides</a><ul class="dropdown-menu bg-dark" aria-labelledby="Integration Guides-navbarDropdown"><li><a class='dropdown-item text-white' href=../../../docs/guides/contour/>Contour Integration</a></li><li><a class='dropdown-item text-white' href=../../../docs/guides/emissary/>Emissary Ingress Integration</a></li><li><a class='dropdown-item text-white' href=../../../docs/guides/envoy/>Envoy Integration</a></li><li><a class='dropdown-item text-white' href=../../../docs/guides/haproxy/>HAProxy Integration</a></li><li><a class='dropdown-item text-white' href=../../../docs/guides/opa/>Integration with OPA</a></li><li><a class='dropdown-item text-white' href=../../../docs/guides/nginx/>NGINX Integration</a></li><li><a class='dropdown-item text-white' href=../../../docs/guides/traefik/>Traefik Proxy Integration</a></li></ul></li></ul><hr class="text-white-50 d-md-none"><ul class="navbar-nav flex-column ms-auto" style=align-self:center><doc-version-select class="nav-item dropdown" version-file=/heimdall/data.json current-version=dev current-page=/docs/getting_started/concepts/><button class="btn btn-dark dropdown-toggle me-4" data-bs-toggle=dropdown aria-expanded=false>
dev</button></doc-version-select></ul><ul class="navbar-nav flex-column"><li class="nav-item mb-1" style=display:flex><a class="nav-link text-white" style=align-self:center href=https://github.com/dadrus/heimdall><svg xmlns="http://www.w3.org/2000/svg" role="img" width="20" height="20" fill="currentcolor" class="bi bi-github text-white" viewBox="0 0 16 16"><title>GitHub</title><path d="M8 0C3.58.0.0 3.58.0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38.0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95.0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12.0.0.67-.21 2.2.82.64-.18 1.32-.27 2-.27s1.36.09 2 .27c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15.0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48.0 1.07-.01 1.93-.01 2.2.0.21.15.46.55.38A8.012 8.012.0 0016 8c0-4.42-3.58-8-8-8z"/></svg><small class="ms-2 d-md-none">GitHub</small></a></li></ul></div></div></nav></header><nav class="navbar navbar-expand-lg bg-light" aria-label="Docs menu"><div class=container-xxl><div class="row container-fluid"><doc-search class="col-auto me-auto" index-file=/heimdall/dev/index.json path-prefix=/heimdall/dev><form id=docs-search tabindex=1 class="doks-search position-relative me-auto"><input id=search class="form-control search-bar" type=search placeholder="Search docs..." aria-label="Search docs..." autocomplete=off><div id=search-suggestions class="shadow bg-white rounded collapse search-results"></div></form></doc-search><button class="col-auto navbar-toggler" type=button data-bs-toggle=collapse data-bs-target=#docsMenuContent aria-controls=docsMenuContent aria-expanded=false aria-label="Open docs menu"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentcolor" class="bi bi-arrow-down-up" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M11.5 15a.5.5.0 00.5-.5V2.707l3.146 3.147a.5.5.0 00.708-.708l-4-4a.5.5.0 00-.708.0l-4 4a.5.5.0 10.708.708L11 2.707V14.5a.5.5.0 00.5.5zm-7-14a.5.5.0 01.5.5v11.793l3.146-3.147a.5.5.0 01.708.708l-4 4a.5.5.0 01-.708.0l-4-4a.5.5.0 01.708-.708L4 13.293V1.5a.5.5.0 01.5-.5z"/></svg></button></div><div class="row d-md-none"><div class="col-2 collapse navbar-collapse" id=docsMenuContent><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../docs/welcome/>Welcome</a></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-010b85ad56b34c34c7c2a3b2436c740e30428ed5 aria-expanded=true>
Getting Started</button><div id=section-010b85ad56b34c34c7c2a3b2436c740e30428ed5 class="collapse show"><ul class="nav flex-column"><li class=nav-item><a class="nav-link fw-bold" href=../../../docs/getting_started/concepts/>Concepts</a></li><li class=nav-item><a class=nav-link href=../../../docs/getting_started/decision_service_quickstart/>Decision Service Quickstart</a></li><li class=nav-item><a class=nav-link href=../../../docs/getting_started/proxy_service_quickstart/>Proxy Service Quickstart</a></li><li class=nav-item><a class=nav-link href=../../../docs/getting_started/configuration_introduction/>Configuration Introduction</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-a1fdaa6b2a846c8fcf18d414bf8c61db610eda6a aria-expanded=false>
Operations</button><div id=section-a1fdaa6b2a846c8fcf18d414bf8c61db610eda6a class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../docs/operations/install/>Install</a></li><li class=nav-item><a class=nav-link href=../../../docs/operations/cli/>CLI</a></li><li class=nav-item><a class=nav-link href=../../../docs/operations/observability/>Observability</a></li><li class=nav-item><a class=nav-link href=../../../docs/operations/security/>Security</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-63bf47d7b1e91548862e3da277e46e20a4b75401 aria-expanded=false>
Integration Guides</button><div id=section-63bf47d7b1e91548862e3da277e46e20a4b75401 class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../docs/guides/contour/>Contour Integration</a></li><li class=nav-item><a class=nav-link href=../../../docs/guides/emissary/>Emissary Ingress Integration</a></li><li class=nav-item><a class=nav-link href=../../../docs/guides/envoy/>Envoy Integration</a></li><li class=nav-item><a class=nav-link href=../../../docs/guides/haproxy/>HAProxy Integration</a></li><li class=nav-item><a class=nav-link href=../../../docs/guides/opa/>Integration with OPA</a></li><li class=nav-item><a class=nav-link href=../../../docs/guides/nginx/>NGINX Integration</a></li><li class=nav-item><a class=nav-link href=../../../docs/guides/traefik/>Traefik Proxy Integration</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-754164850f38c1ecdaf6b8ed894cb192bc36c5f4 aria-expanded=false>
Configuration</button><div id=section-754164850f38c1ecdaf6b8ed894cb192bc36c5f4 class=collapse><ul class="nav flex-column"><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-5cbd584046863bc7b753e57e8681a98a87f36f0f aria-expanded=false>
Services</button><div id=section-5cbd584046863bc7b753e57e8681a98a87f36f0f class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../docs/configuration/services/decision/>Decision</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/services/proxy/>Proxy</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/services/management/>Management</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-e2397377af6d698b0fb66f53c47349a85bd2cb00 aria-expanded=false>
Observability</button><div id=section-e2397377af6d698b0fb66f53c47349a85bd2cb00 class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../docs/configuration/observability/logging/>Logging</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/observability/metrics/>Metrics</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/observability/tracing/>Tracing</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/observability/profiling/>Runtime Profiling</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-bb11a8e3f8712e36e7cd9d1c615a4e3dbb03336a aria-expanded=false>
Rules</button><div id=section-bb11a8e3f8712e36e7cd9d1c615a4e3dbb03336a class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../docs/configuration/rules/overview/>Rules Overview</a></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-83ebcaaac1209f17a08fa17b9b1837aca7b222f7 aria-expanded=false>
Pipeline Mechanisms</button><div id=section-83ebcaaac1209f17a08fa17b9b1837aca7b222f7 class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../docs/configuration/rules/pipeline_mechanisms/overview/>Mechanisms Overview</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/rules/pipeline_mechanisms/authenticators/>Authenticators</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/rules/pipeline_mechanisms/authorizers/>Authorizers</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/rules/pipeline_mechanisms/contextualizers/>Contextualizers</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/rules/pipeline_mechanisms/finalizers/>Finalizers</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/rules/pipeline_mechanisms/error_handlers/>Error Handlers</a></li></ul></div></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/rules/configuration/>Rule</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/rules/default/>Default Rule</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/rules/providers/>Rule Providers</a></li></ul></div></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/cryptographic_material/>Cryptographic Material</a></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-db1c784524e1b54011a95823026161f7c8517fe0 aria-expanded=false>
Reference</button><div id=section-db1c784524e1b54011a95823026161f7c8517fe0 class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../docs/configuration/reference/types/>Configuration Types</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/reference/reference/>Static Configuration Reference</a></li></ul></div></li></ul></div></li></ul></div></div></div></nav><div class="container-xxl d-xxl-flex"><aside class="d-none d-md-block pe-4 pt-4 flex-xxl-shrink-0"><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../docs/welcome/>Welcome</a></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-010b85ad56b34c34c7c2a3b2436c740e30428ed5 aria-expanded=true>
Getting Started</button><div id=section-010b85ad56b34c34c7c2a3b2436c740e30428ed5 class="collapse show"><ul class="nav flex-column"><li class=nav-item><a class="nav-link fw-bold" href=../../../docs/getting_started/concepts/>Concepts</a></li><li class=nav-item><a class=nav-link href=../../../docs/getting_started/decision_service_quickstart/>Decision Service Quickstart</a></li><li class=nav-item><a class=nav-link href=../../../docs/getting_started/proxy_service_quickstart/>Proxy Service Quickstart</a></li><li class=nav-item><a class=nav-link href=../../../docs/getting_started/configuration_introduction/>Configuration Introduction</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-a1fdaa6b2a846c8fcf18d414bf8c61db610eda6a aria-expanded=false>
Operations</button><div id=section-a1fdaa6b2a846c8fcf18d414bf8c61db610eda6a class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../docs/operations/install/>Install</a></li><li class=nav-item><a class=nav-link href=../../../docs/operations/cli/>CLI</a></li><li class=nav-item><a class=nav-link href=../../../docs/operations/observability/>Observability</a></li><li class=nav-item><a class=nav-link href=../../../docs/operations/security/>Security</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-63bf47d7b1e91548862e3da277e46e20a4b75401 aria-expanded=false>
Integration Guides</button><div id=section-63bf47d7b1e91548862e3da277e46e20a4b75401 class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../docs/guides/contour/>Contour Integration</a></li><li class=nav-item><a class=nav-link href=../../../docs/guides/emissary/>Emissary Ingress Integration</a></li><li class=nav-item><a class=nav-link href=../../../docs/guides/envoy/>Envoy Integration</a></li><li class=nav-item><a class=nav-link href=../../../docs/guides/haproxy/>HAProxy Integration</a></li><li class=nav-item><a class=nav-link href=../../../docs/guides/opa/>Integration with OPA</a></li><li class=nav-item><a class=nav-link href=../../../docs/guides/nginx/>NGINX Integration</a></li><li class=nav-item><a class=nav-link href=../../../docs/guides/traefik/>Traefik Proxy Integration</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-754164850f38c1ecdaf6b8ed894cb192bc36c5f4 aria-expanded=false>
Configuration</button><div id=section-754164850f38c1ecdaf6b8ed894cb192bc36c5f4 class=collapse><ul class="nav flex-column"><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-5cbd584046863bc7b753e57e8681a98a87f36f0f aria-expanded=false>
Services</button><div id=section-5cbd584046863bc7b753e57e8681a98a87f36f0f class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../docs/configuration/services/decision/>Decision</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/services/proxy/>Proxy</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/services/management/>Management</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-e2397377af6d698b0fb66f53c47349a85bd2cb00 aria-expanded=false>
Observability</button><div id=section-e2397377af6d698b0fb66f53c47349a85bd2cb00 class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../docs/configuration/observability/logging/>Logging</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/observability/metrics/>Metrics</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/observability/tracing/>Tracing</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/observability/profiling/>Runtime Profiling</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-bb11a8e3f8712e36e7cd9d1c615a4e3dbb03336a aria-expanded=false>
Rules</button><div id=section-bb11a8e3f8712e36e7cd9d1c615a4e3dbb03336a class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../docs/configuration/rules/overview/>Rules Overview</a></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-83ebcaaac1209f17a08fa17b9b1837aca7b222f7 aria-expanded=false>
Pipeline Mechanisms</button><div id=section-83ebcaaac1209f17a08fa17b9b1837aca7b222f7 class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../docs/configuration/rules/pipeline_mechanisms/overview/>Mechanisms Overview</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/rules/pipeline_mechanisms/authenticators/>Authenticators</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/rules/pipeline_mechanisms/authorizers/>Authorizers</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/rules/pipeline_mechanisms/contextualizers/>Contextualizers</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/rules/pipeline_mechanisms/finalizers/>Finalizers</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/rules/pipeline_mechanisms/error_handlers/>Error Handlers</a></li></ul></div></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/rules/configuration/>Rule</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/rules/default/>Default Rule</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/rules/providers/>Rule Providers</a></li></ul></div></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/cryptographic_material/>Cryptographic Material</a></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-db1c784524e1b54011a95823026161f7c8517fe0 aria-expanded=false>
Reference</button><div id=section-db1c784524e1b54011a95823026161f7c8517fe0 class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../docs/configuration/reference/types/>Configuration Types</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/reference/reference/>Static Configuration Reference</a></li></ul></div></li></ul></div></li></ul></aside><main class="px-3 pt-4 flex-xxl-grow-0"><h1>Concepts</h1><div><linkable-headline-area><div class=paragraph><p>Everything you need to know.</p></div><div class=sect1><h2 id=_pipeline>Pipeline</h2><div class=sectionbody><div class=paragraph><p>As described in the <a href=../../../docs/welcome/>Welcome</a> section and also shown in the diagram below, heimdall authenticates and authorizes incoming HTTP requests, rejecting unauthenticated or unauthorized ones, as well as enriches the valid requests with further contextual information and transforms resulting subject information into a format, required by the upstream services. This is done in upstream service specific <a href=../../../docs/configuration/rules/overview/>rules</a>, which assemble the required individual pipelines by making use of different <a href=../../../docs/configuration/rules/pipeline_mechanisms/overview/>mechanisms</a>.</p></div><div id=_fig_heimdall_request_pipeline class=imageblock><div class=content><img src=diag-ditaa-md5-6271999793de82bc8f4030f7ebf2f533.svg alt=Diagram width=1290 height=308></div><div class=title>Figure 1. Request Pipeline</div></div><div class=paragraph><p>Each rule defines which mechanisms are required for its pipeline and executed in which order.</p></div><div class=paragraph><p>In general each rule contains</p></div><div class=ulist><ul><li><p>an identifier - to uniquely identify a rule</p></li><li><p>an url pattern - to match the incoming request against</p></li><li><p>a list of allowed HTTP methods for the matched requests</p></li><li><p>a regular pipeline, consisting of a list with</p><div class=ulist><ul><li><p><strong>authentication</strong> mechanisms, so-called <a href=../../../docs/configuration/rules/pipeline_mechanisms/authenticators/>Authenticators</a>, to be executed (if multiple are defined, they are executed as fallbacks) - step 1 in the figure above.</p><div class=paragraph><p>Here, heimdall typically communicates with the actual authentication systems to get information about the authenticated subject, or to get key material to verify the authentication information provided in the request, or perform other activities related to authentication.</p></div></li><li><p><strong>contextualization</strong> mechanisms, so-called <a href=../../../docs/configuration/rules/pipeline_mechanisms/contextualizers/>Contextualizers</a>, to be executed (if multiple are defined, they are executed in the order of their definition; can be mixed with authorization mechanisms) - step 2 in the figure above.</p><div class=paragraph><p>Here, heimdall communicates with other systems as well, either to get further information about the subject, like specific attributes required by the upstream service and not available in the authentication information or the request itself. An example would be information about the request IP, like provided by <a href=https://www.abuseipdb.com/>AbuseIPDB</a>, etc.</p></div></li><li><p><strong>authorization</strong> mechanisms, so-called <a href=../../../docs/configuration/rules/pipeline_mechanisms/authorizers/>Authorizers</a>, to be executed (if multiple are defined, they are executed in the order of their definition; can be mixed with contextualization mechanisms) - step 3 in the figure above.</p><div class=paragraph><p>Here, heimdall performs authorization checks, either locally, or by communicating with yet again further systems, like Open Policy Agent, Ory Keto and alike.</p></div></li><li><p><strong>finalization</strong> mechanisms, so-called <a href=../../../docs/configuration/rules/pipeline_mechanisms/finalizers/>Finalizers</a>, to be executed (if multiple are defined, they are executed in the order of their definition) - step 4 in the figure above.</p><div class=paragraph><p>This step finalizes the execution of the pipeline and enriches the request with data such as subject information or authentication tokens required by the upstream service. The available options range from adding a simple header over a structured JWT, to driving specific protocols, e.g. to obtain a token required by the upstream service.</p></div></li></ul></div></li><li><p>an error pipeline, consisting of <a href=../../../docs/configuration/rules/pipeline_mechanisms/error_handlers/>error handler</a> mechanisms (if multiple are defined, they are executed as fallbacks), which are executed if any of the regular pipeline mechanisms fail. These mechanisms range from a simple error response to the client (which sent the request), to sophisticated ones supporting complex logic and redirects.</p></li></ul></div><div class=paragraph><p>The diagram below sketches the related execution logic</p></div><div class=imageblock><div class=content><img src=diag-mermaid-md5-39b652f619770708f844bf056830fbbe.svg alt=Diagram width=70% height=940></div></div><div class="olist arabic"><ol class=arabic><li><p><strong>Url matches rule?</strong> - This is the first step executed by heimdall. The information about the scheme, host, path and query is taken either from the URL itself, or if present and allowed, from the <code>X-Forwarded-Proto</code>, <code>X-Forwarded-Host</code>, <code>X-Forwarded-Path</code>, or <code>X-Forwarded-Uri</code> headers of the incoming request. The request is denied if there is no matching rule. Otherwise, the rule specific pipeline is executed. When heimdall is evaluating the rules against the request url it takes the first matching one. That allows simpler matching expressions and supports ordering of rules in rule set with most specific matchig expressions first.</p></li><li><p><strong>Method allowed?</strong> - As soon as a rule matching the request is found, a verification is done whether the used HTTP method is allowed or not. The information about the HTTP method is either taken from the request itself or, if present and allowed, from the <code>X-Forwarded-Method</code> header.</p></li><li><p><strong>Execute regular pipeline</strong> - when the above steps succeed, the regular pipeline mechanisms defined in the matched rule are executed.</p></li><li><p><strong>Forward request, respectively respond to the API gateway</strong> - when the above steps succeed, heimdall, depending on the <a href=#_operating_modes>operating mode</a>, responds with, respectively forwards whatever was defined in the pipeline (usually this is a set of HTTP headers). Otherwise</p></li><li><p><strong>Execute error pipeline</strong> is executed if any of the mechanisms, defined in the regular pipeline fail. This again results in a response, this time however, based on the definition in the used error handler.</p></li></ol></div></div></div><div class=sect1><h2 id=_operating_modes>Operating Modes</h2><div class=sectionbody><div class=paragraph><p>To support different deployment scenarios, heimdall supports two operating modes:</p></div><div class=ulist><ul><li><p>as a <a href=#_proxy_mode>Reverse Proxy</a> in front of your upstream API or web server, or</p></li><li><p>as a <a href=#_decision_mode>Decision Service</a>, integrated with your Reverse Proxy, or API Gateway (like <a href=https://konghq.com/>Kong</a>, <a href=https://nginx.org>NGNIX</a>, <a href=https://www.envoyproxy.io/>Envoy</a>, <a href=https://traefik.io/>Traefik</a> and much more)</p></li></ul></div><div class=sect2><h3 id=_proxy_mode>Proxy Mode</h3><div id=_fig_heimdall_proxy_deployment class=imageblock><div class=content><img src=diag-ditaa-md5-2552f7950a6d0b66ae0af3b9470186bf.svg alt=Diagram width=1080 height=392></div><div class=title>Figure 2. Proxy Deployment</div></div><div class=paragraph><p>In this mode heimdall forwards requests to the upstream service if these satisfy the conditions defined in matched rules. Otherwise, heimdall returns an error to the client. If the execution of the rule was successful, it also forwards additional headers, specified in the rule to the upstream service.</p></div><div class=paragraph><p>Starting heimdall in this mode happens via the <code>serve proxy</code> command. Head over to the description of <a href=../../../docs/operations/cli/>CLI</a> as well as <a href=../../../docs/configuration/services/proxy/>Configuration</a> options for more details.</p></div><div class=exampleblock><div class=title>Example 1. Reverse Proxy Example</div><div class=content><div class=paragraph><p>Imagine following request hits heimdall</p></div><div class=listingblock><div class=content><pre class="rouge highlight" style=color:#fff;background-color:#272822><code data-lang=bash>GET /my-service/api HTTP/1.1
Host: heimdall:4455

Some payload</code></pre></div></div><div class=paragraph><p>And there is a rule, which allows anonymous requests and sets a header with subject id set to <code>anonymous</code> like this</p></div><div class=listingblock><div class=content><pre class="rouge highlight" style=color:#fff;background-color:#272822><code data-lang=yaml><span style=color:#a6e22e>id</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>rule:my-service:anonymous-api-access</span>
<span style=color:#a6e22e>match</span><span style=color:#fff;background-color:#272822>:</span>
  <span style=color:#a6e22e>url</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>&lt;**&gt;/my-service/api</span>
<span style=color:#a6e22e>forward_to</span><span style=color:#fff;background-color:#272822>:</span>
  <span style=color:#a6e22e>host</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>my-backend-service:8888</span>
<span style=color:#a6e22e>methods</span><span style=color:#fff;background-color:#272822>:</span>
  <span style=color:#fff;background-color:#272822>-</span> <span style=color:#e6db74>GET</span>
<span style=color:#a6e22e>execute</span><span style=color:#fff;background-color:#272822>:</span>
  <span style=color:#fff;background-color:#272822>-</span> <span style=color:#a6e22e>authenticator</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>anonymous-authn</span>
  <span style=color:#fff;background-color:#272822>-</span> <span style=color:#a6e22e>finalizer</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>id-header</span></code></pre></div></div><div class=paragraph><p>Then the request will be forwarded as follows:</p></div><div class=listingblock><div class=content><pre class="rouge highlight" style=color:#fff;background-color:#272822><code data-lang=bash>GET /my-service/api HTTP/1.1
Host: my-backend-service:8888
X-User-ID: anonymous

Some payload</code></pre></div></div></div></div></div><div class=sect2><h3 id=_decision_mode>Decision Mode</h3><div id=_fig_heimdall_decision_deployment class=imageblock><div class=content><img src=diag-ditaa-md5-522a74a859dfbc992b038afdc1344a3c.svg alt=Diagram width=1080 height=560></div><div class=title>Figure 3. Decision Deployment</div></div><div class=paragraph><p>In this mode heimdall can be integrated with most probably all modern API gateways and reverse proxies as a so-called "authentication middleware". Here the reverse proxy, respectively API gateway integrating with heimdall, will forward requests to heimdall by making use of its decision service endpoint for authentication and authorization purposes. As in the <a href=#_proxy_mode>Reverse Proxy</a> mode, heimdall will check if these requests match and satisfy the conditions defined in the available rules. If not, heimdall returns an error to its client (here API gateway/reverse proxy). If the rule execution was successful, it also responds to the API gateway/reverse proxy with <code>200 OK</code> (can be overridden if required) and sets headers/cookies, specified in the matched rule, which are then forwarded to the upstream service.</p></div><div class=paragraph><p>Starting heimdall in this mode happens via the <code>serve decision</code> command. Head over to the description of <a href=../../../docs/operations/cli/>CLI</a> as well as to <a href=../../../docs/configuration/services/decision/>Configuration</a> options for more details.</p></div><div class=exampleblock><div class=title>Example 2. Decision Service Example</div><div class=content><div class=paragraph><p>Imagine following request hits heimdall (sent to it by an API gateway)</p></div><div class=listingblock><div class=content><pre class="rouge highlight" style=color:#fff;background-color:#272822><code data-lang=bash>GET /my-service/api HTTP/1.1
Host: heimdall:4455
X-Forwarded-Host: my-backend-service

Some payload</code></pre></div></div><div class=paragraph><p>And there is a rule, which allows anonymous requests and sets a header with subject id set to <code>anonymous</code> like this</p></div><div class=listingblock><div class=content><pre class="rouge highlight" style=color:#fff;background-color:#272822><code data-lang=yaml><span style=color:#a6e22e>id</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>rule:my-service:anonymous-api-access</span>
<span style=color:#a6e22e>match</span><span style=color:#fff;background-color:#272822>:</span>
  <span style=color:#a6e22e>url</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>http://my-backend-service/my-service/api</span>
<span style=color:#a6e22e>methods</span><span style=color:#fff;background-color:#272822>:</span>
  <span style=color:#fff;background-color:#272822>-</span> <span style=color:#e6db74>GET</span>
<span style=color:#a6e22e>execute</span><span style=color:#fff;background-color:#272822>:</span>
  <span style=color:#fff;background-color:#272822>-</span> <span style=color:#a6e22e>authenticator</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>anonymous-authn</span>
  <span style=color:#fff;background-color:#272822>-</span> <span style=color:#a6e22e>finalizer</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>id-header</span></code></pre></div></div><div class=paragraph><p>Then heimdall will respond with:</p></div><div class=listingblock><div class=content><pre class="rouge highlight" style=color:#fff;background-color:#272822><code data-lang=bash>HTTP/1.1 200 OK
X-User-ID: anonymous</code></pre></div></div></div></div></div></div></div></linkable-headline-area></div><p class="text-end fst-italic fs-7">Last updated on <span class=fw-bold>Nov 14, 2023</span></p><div class="d-flex justify-content-between"><a href=../../../docs/welcome/><div class="fs-6 mb-3"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentcolor" class="bi bi-chevron-left" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M11.354 1.646a.5.5.0 010 .708L5.707 8l5.647 5.646a.5.5.0 01-.708.708l-6-6a.5.5.0 010-.708l6-6a.5.5.0 01.708.0z"/></svg>Welcome</div></a><a class=ms-auto href=../../../docs/getting_started/decision_service_quickstart/><div class="fs-6 mb-3">Decision Service Quickstart<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentcolor" class="bi bi-chevron-right" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4.646 1.646a.5.5.0 01.708.0l6 6a.5.5.0 010 .708l-6 6a.5.5.0 01-.708-.708L10.293 8 4.646 2.354a.5.5.0 010-.708z"/></svg></div></a></div></main></div><footer class="footer py-4 py-md-5 px-4 px-md-3"><div class=container><div class=row><div class="col-lg-3 mb-3"><p class=fs-5>Heimdall</p><ul class="list-unstyled small text-muted"><li class=mb-2>2022-2023 Â© Heimdall Project Authors. All rights reserved.</li><li class=mb-2><a href=https://github.com/dadrus/heimdall/blob/master/LICENSE>Apache 2.0 licensed</a></li></ul></div><div class="col-6 col-lg-2 offset-lg-1 mb-3"><h5>Links</h5><ul class=list-unstyled><li class=mb-2><a href=../../../>Home</a></li><li class=mb-2><a href=../../../docs/welcome>Docs</a></li><li class=mb-2><a href=../../../openapi/>API</a></li></ul></div><div class="col-6 col-lg-2 mb-2"><h5>Guides</h5><ul class=list-unstyled><li class=mb-2><a href=../../../docs/operations/install/>Install</a></li><li class=mb-2><a href=../../../docs/getting_started/>Getting Started</a></li><li class=mb-2><a href=../../../docs/guides/>Integration Guides</a></li></ul></div><div class="col-6 col-lg-2 mb-2"><h5>Community</h5><ul class=list-unstyled><li class=mb-2><a href=https://github.com/dadrus/heimdall>Github</a></li><li class=mb-2><a href=https://discord.gg/qQgg8xKuyb>Discord</a></li></ul></div></div></div></footer><script src=../../../js/main.js defer></script>
<script src=https://cdn.redoc.ly/redoc/latest/bundles/redoc.standalone.js></script></body></html>