<!doctype html><html lang=en><head><title>Authenticators</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="An open source Identity Aware Proxy and an Access Control Decision service for cloud native applications"><meta name=dc.relation content="https://dadrus.github.io/"><meta name=theme-color content="#1A94D2"><link rel=stylesheet href=../../../../../css/styles.min.css media=screen><link rel='shortcut icon' type=image/x-icon href=../../../../../favicon.ico></head><body><header class="navbar navbar-expand-md navbar-dark bg-dark sticky-top"><nav class="container-xxl flex-wrap flex-lg-nowrap" aria-label="Main navigation"><a class="navbar-brand text-white" href=../../../../../ style=font-weight:500;font-size:1.5rem>Heimdall</a>
<button class=navbar-toggler type=button data-bs-toggle=offcanvas data-bs-target=#mainMenuContent aria-controls=mainMenuContent aria-expanded=false aria-label="Open main menu">
<span class=navbar-toggler-icon></span></button><div class="offcanvas offcanvas-end bg-dark" tabindex=-1 id=mainMenuContent data-bs-scroll=true aria-labelledby=mainMenuContentLabel><div class=offcanvas-header><h5 class="offcanvas-title text-white" id=mainMenuContentLabel>Heimdall</h5><button type=button class="btn-close btn-close-white" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class=offcanvas-body><ul class="navbar-nav flex-column flex-md-row"><li class=nav-item style=display:flex><a class='nav-link text-white' href=../../../../../docs/welcome style=align-self:center>Docs</a></li><li class=nav-item style=display:flex><a class='nav-link text-white' href=../../../../../openapi/ style=align-self:center>API</a></li><li class="nav-item dropdown" style=display:flex><a class='nav-link dropdown-toggle text-white' href=# id="Get Started-navbarDropdown" role=button data-bs-toggle=dropdown aria-expanded=false style=align-self:center>Get Started</a><ul class="dropdown-menu bg-dark" aria-labelledby="Get Started-navbarDropdown"><li><a class='dropdown-item text-white' href=../../../../../docs/getting_started/concepts/>Concepts</a></li><li><a class='dropdown-item text-white' href=../../../../../docs/getting_started/decision_service_quickstart/>Decision Service Quickstart</a></li><li><a class='dropdown-item text-white' href=../../../../../docs/getting_started/proxy_service_quickstart/>Proxy Service Quickstart</a></li></ul></li><li class="nav-item dropdown" style=display:flex><a class='nav-link dropdown-toggle text-white' href=# id="Integration Guides-navbarDropdown" role=button data-bs-toggle=dropdown aria-expanded=false style=align-self:center>Integration Guides</a><ul class="dropdown-menu bg-dark" aria-labelledby="Integration Guides-navbarDropdown"><li><a class='dropdown-item text-white' href=../../../../../docs/guides/contour/>Contour Integration</a></li><li><a class='dropdown-item text-white' href=../../../../../docs/guides/emissary/>Emissary Ingress Integration</a></li><li><a class='dropdown-item text-white' href=../../../../../docs/guides/envoy/>Envoy Integration</a></li><li><a class='dropdown-item text-white' href=../../../../../docs/guides/haproxy/>HAProxy Integration</a></li><li><a class='dropdown-item text-white' href=../../../../../docs/guides/opa/>Integration with OPA</a></li><li><a class='dropdown-item text-white' href=../../../../../docs/guides/nginx/>NGINX Integration</a></li><li><a class='dropdown-item text-white' href=../../../../../docs/guides/traefik/>Traefik Proxy Integration</a></li></ul></li></ul><hr class="text-white-50 d-md-none"><ul class="navbar-nav flex-column ms-auto" style=align-self:center><doc-version-select class="nav-item dropdown" version-file=/heimdall/data.json current-version=v0.13.0-alpha current-page=/docs/configuration/rules/pipeline_mechanisms/authenticators/><button class="btn btn-dark dropdown-toggle me-4" data-bs-toggle=dropdown aria-expanded=false>
v0.13.0-alpha</button></doc-version-select></ul><ul class="navbar-nav flex-column"><li class="nav-item mb-1" style=display:flex><a class="nav-link text-white" style=align-self:center href=https://github.com/dadrus/heimdall><svg xmlns="http://www.w3.org/2000/svg" role="img" width="20" height="20" fill="currentcolor" class="bi bi-github text-white" viewBox="0 0 16 16"><title>GitHub</title><path d="M8 0C3.58.0.0 3.58.0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38.0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95.0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12.0.0.67-.21 2.2.82.64-.18 1.32-.27 2-.27s1.36.09 2 .27c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15.0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48.0 1.07-.01 1.93-.01 2.2.0.21.15.46.55.38A8.012 8.012.0 0016 8c0-4.42-3.58-8-8-8z"/></svg><small class="ms-2 d-md-none">GitHub</small></a></li></ul></div></div></nav></header><nav class="navbar navbar-expand-lg bg-light" aria-label="Docs menu"><div class=container-xxl><div class="row container-fluid"><doc-search class="col-auto me-auto" index-file=/heimdall/v0.13.0-alpha/index.json path-prefix=/heimdall/v0.13.0-alpha><form id=docs-search tabindex=1 class="doks-search position-relative me-auto"><input id=search class="form-control search-bar" type=search placeholder="Search docs..." aria-label="Search docs..." autocomplete=off><div id=search-suggestions class="shadow bg-white rounded collapse search-results"></div></form></doc-search><button class="col-auto navbar-toggler" type=button data-bs-toggle=collapse data-bs-target=#docsMenuContent aria-controls=docsMenuContent aria-expanded=false aria-label="Open docs menu"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentcolor" class="bi bi-arrow-down-up" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M11.5 15a.5.5.0 00.5-.5V2.707l3.146 3.147a.5.5.0 00.708-.708l-4-4a.5.5.0 00-.708.0l-4 4a.5.5.0 10.708.708L11 2.707V14.5a.5.5.0 00.5.5zm-7-14a.5.5.0 01.5.5v11.793l3.146-3.147a.5.5.0 01.708.708l-4 4a.5.5.0 01-.708.0l-4-4a.5.5.0 01.708-.708L4 13.293V1.5a.5.5.0 01.5-.5z"/></svg></button></div><div class="row d-md-none"><div class="col-2 collapse navbar-collapse" id=docsMenuContent><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/welcome/>Welcome</a></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-010b85ad56b34c34c7c2a3b2436c740e30428ed5 aria-expanded=false>
Getting Started</button><div id=section-010b85ad56b34c34c7c2a3b2436c740e30428ed5 class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/getting_started/concepts/>Concepts</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/getting_started/decision_service_quickstart/>Decision Service Quickstart</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/getting_started/proxy_service_quickstart/>Proxy Service Quickstart</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/getting_started/configuration_introduction/>Configuration Introduction</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-a1fdaa6b2a846c8fcf18d414bf8c61db610eda6a aria-expanded=false>
Operations</button><div id=section-a1fdaa6b2a846c8fcf18d414bf8c61db610eda6a class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/operations/install/>Install</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/operations/cli/>CLI</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/operations/observability/>Observability</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/operations/security/>Security</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-63bf47d7b1e91548862e3da277e46e20a4b75401 aria-expanded=false>
Integration Guides</button><div id=section-63bf47d7b1e91548862e3da277e46e20a4b75401 class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/guides/contour/>Contour Integration</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/guides/emissary/>Emissary Ingress Integration</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/guides/envoy/>Envoy Integration</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/guides/haproxy/>HAProxy Integration</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/guides/opa/>Integration with OPA</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/guides/nginx/>NGINX Integration</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/guides/traefik/>Traefik Proxy Integration</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-754164850f38c1ecdaf6b8ed894cb192bc36c5f4 aria-expanded=true>
Configuration</button><div id=section-754164850f38c1ecdaf6b8ed894cb192bc36c5f4 class="collapse show"><ul class="nav flex-column"><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-5cbd584046863bc7b753e57e8681a98a87f36f0f aria-expanded=false>
Services</button><div id=section-5cbd584046863bc7b753e57e8681a98a87f36f0f class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/services/decision/>Decision</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/services/proxy/>Proxy</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/services/management/>Management</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-e2397377af6d698b0fb66f53c47349a85bd2cb00 aria-expanded=false>
Observability</button><div id=section-e2397377af6d698b0fb66f53c47349a85bd2cb00 class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/observability/logging/>Logging</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/observability/metrics/>Metrics</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/observability/tracing/>Tracing</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/observability/profiling/>Runtime Profiling</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-bb11a8e3f8712e36e7cd9d1c615a4e3dbb03336a aria-expanded=true>
Rules</button><div id=section-bb11a8e3f8712e36e7cd9d1c615a4e3dbb03336a class="collapse show"><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/overview/>Rules Overview</a></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-83ebcaaac1209f17a08fa17b9b1837aca7b222f7 aria-expanded=true>
Pipeline Mechanisms</button><div id=section-83ebcaaac1209f17a08fa17b9b1837aca7b222f7 class="collapse show"><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/pipeline_mechanisms/overview/>Mechanisms Overview</a></li><li class=nav-item><a class="nav-link fw-bold" href=../../../../../docs/configuration/rules/pipeline_mechanisms/authenticators/>Authenticators</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/pipeline_mechanisms/authorizers/>Authorizers</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/pipeline_mechanisms/contextualizers/>Contextualizers</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/pipeline_mechanisms/finalizers/>Finalizers</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/pipeline_mechanisms/error_handlers/>Error Handlers</a></li></ul></div></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/configuration/>Rule</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/default/>Default Rule</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/providers/>Rule Providers</a></li></ul></div></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/cryptographic_material/>Cryptographic Material</a></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-db1c784524e1b54011a95823026161f7c8517fe0 aria-expanded=false>
Reference</button><div id=section-db1c784524e1b54011a95823026161f7c8517fe0 class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/reference/types/>Configuration Types</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/reference/reference/>Static Configuration Reference</a></li></ul></div></li></ul></div></li></ul></div></div></div></nav><div class="container-xxl d-xxl-flex"><aside class="d-none d-md-block pe-4 pt-4 flex-xxl-shrink-0"><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/welcome/>Welcome</a></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-010b85ad56b34c34c7c2a3b2436c740e30428ed5 aria-expanded=false>
Getting Started</button><div id=section-010b85ad56b34c34c7c2a3b2436c740e30428ed5 class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/getting_started/concepts/>Concepts</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/getting_started/decision_service_quickstart/>Decision Service Quickstart</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/getting_started/proxy_service_quickstart/>Proxy Service Quickstart</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/getting_started/configuration_introduction/>Configuration Introduction</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-a1fdaa6b2a846c8fcf18d414bf8c61db610eda6a aria-expanded=false>
Operations</button><div id=section-a1fdaa6b2a846c8fcf18d414bf8c61db610eda6a class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/operations/install/>Install</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/operations/cli/>CLI</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/operations/observability/>Observability</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/operations/security/>Security</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-63bf47d7b1e91548862e3da277e46e20a4b75401 aria-expanded=false>
Integration Guides</button><div id=section-63bf47d7b1e91548862e3da277e46e20a4b75401 class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/guides/contour/>Contour Integration</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/guides/emissary/>Emissary Ingress Integration</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/guides/envoy/>Envoy Integration</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/guides/haproxy/>HAProxy Integration</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/guides/opa/>Integration with OPA</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/guides/nginx/>NGINX Integration</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/guides/traefik/>Traefik Proxy Integration</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-754164850f38c1ecdaf6b8ed894cb192bc36c5f4 aria-expanded=true>
Configuration</button><div id=section-754164850f38c1ecdaf6b8ed894cb192bc36c5f4 class="collapse show"><ul class="nav flex-column"><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-5cbd584046863bc7b753e57e8681a98a87f36f0f aria-expanded=false>
Services</button><div id=section-5cbd584046863bc7b753e57e8681a98a87f36f0f class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/services/decision/>Decision</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/services/proxy/>Proxy</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/services/management/>Management</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-e2397377af6d698b0fb66f53c47349a85bd2cb00 aria-expanded=false>
Observability</button><div id=section-e2397377af6d698b0fb66f53c47349a85bd2cb00 class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/observability/logging/>Logging</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/observability/metrics/>Metrics</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/observability/tracing/>Tracing</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/observability/profiling/>Runtime Profiling</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-bb11a8e3f8712e36e7cd9d1c615a4e3dbb03336a aria-expanded=true>
Rules</button><div id=section-bb11a8e3f8712e36e7cd9d1c615a4e3dbb03336a class="collapse show"><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/overview/>Rules Overview</a></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-83ebcaaac1209f17a08fa17b9b1837aca7b222f7 aria-expanded=true>
Pipeline Mechanisms</button><div id=section-83ebcaaac1209f17a08fa17b9b1837aca7b222f7 class="collapse show"><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/pipeline_mechanisms/overview/>Mechanisms Overview</a></li><li class=nav-item><a class="nav-link fw-bold" href=../../../../../docs/configuration/rules/pipeline_mechanisms/authenticators/>Authenticators</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/pipeline_mechanisms/authorizers/>Authorizers</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/pipeline_mechanisms/contextualizers/>Contextualizers</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/pipeline_mechanisms/finalizers/>Finalizers</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/pipeline_mechanisms/error_handlers/>Error Handlers</a></li></ul></div></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/configuration/>Rule</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/default/>Default Rule</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/providers/>Rule Providers</a></li></ul></div></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/cryptographic_material/>Cryptographic Material</a></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-db1c784524e1b54011a95823026161f7c8517fe0 aria-expanded=false>
Reference</button><div id=section-db1c784524e1b54011a95823026161f7c8517fe0 class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/reference/types/>Configuration Types</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/reference/reference/>Static Configuration Reference</a></li></ul></div></li></ul></div></li></ul></aside><main class="px-3 pt-4 flex-xxl-grow-0"><h1>Authenticators</h1><div><linkable-headline-area><div class=paragraph><p>Authenticators inspect HTTP requests for presence of authentication objects, like e.g. the presence of a specific cookie. If such objects exist, authenticators verify the related authentication status and obtain information about the corresponding <a href=../../../../../docs/configuration/rules/pipeline_mechanisms/overview/#_subject>subject</a>. A subject, could be a user, trying to use particular functionality of the upstream service, a machine (if you have machine-2-machine interaction), or something different. Authenticators ensure the subject is authenticated and the information available about it is valid.</p></div><div class=sect1><h2 id=_authenticator_types>Authenticator Types</h2><div class=sectionbody><div class=paragraph><p>The following sections describe the available authenticator types in more detail. Some of these may support or require additional configuration. The corresponding properties are annotated with <code>mandatory</code>, respectively <code>optional</code> to denote configuration requirement, as well as with <code>overridable</code>, <code>not overriddable</code> and <code>partially overridable</code> to indicate whether the property can be overridden in a rule pipeline.</p></div><div class=sect2><h3 id=_unauthorized>Unauthorized</h3><div class=paragraph><p>This authenticator rejects all requests as unauthenticated (on HTTP response code level this is then mapped to <code>401 Unauthorized</code>, hence the type name). It basically stops the successful execution of the pipeline resulting in the execution of the error handlers. This authenticator type doesn’t have any configuration options.</p></div><div class=paragraph><p>To enable the usage of this authenticator, you have to set the <code>type</code> property to <code>unauthorized</code>.</p></div><div class=exampleblock><div class=title>Example 1. Configure Unauthorized authenticator</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight" style=color:#fff;background-color:#272822><code data-lang=yaml><span style=color:#a6e22e>id</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>foo</span>
<span style=color:#a6e22e>type</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>unauthorized</span></code></pre></div></div></div></div></div><div class=sect2><h3 id=_anonymous>Anonymous</h3><div class=paragraph><p>This authenticator just creates a <a href=../../../../../docs/configuration/rules/pipeline_mechanisms/overview/#_subject><code>Subject</code></a> object and sets its <code>ID</code> to <code>anonymous</code> without doing anything else. You can overwrite the value of subject’s id by using the optional <code>config</code> property.</p></div><div class=paragraph><p>To enable the usage of this authenticator, you have to set the <code>type</code> property to <code>anonymous</code>.</p></div><div class=paragraph><p>Configuration using the <code>config</code> property is optional. Following properties are available:</p></div><div class=ulist><ul><li><p><strong><code>subject</code></strong>: <em>string</em> (optional, overridable)</p><div class=paragraph><p>Enables setting the <code>ID</code> of the created <a href=../../../../../docs/configuration/rules/pipeline_mechanisms/overview/#_subject><code>Subject</code></a> object to a custom value.</p></div></li></ul></div><div class=exampleblock><div class=title>Example 2. Configuration of Anonymous authenticator</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight" style=color:#fff;background-color:#272822><code data-lang=yaml><span style=color:#a6e22e>id</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>foo</span>
<span style=color:#a6e22e>type</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>anonymous</span>
<span style=color:#a6e22e>config</span><span style=color:#fff;background-color:#272822>:</span>
  <span style=color:#a6e22e>subject</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>anon</span></code></pre></div></div></div></div></div><div class=sect2><h3 id=_basic_auth>Basic Auth</h3><div class=paragraph><p>This authenticator verifies the provided credentials according to the HTTP "Basic" authentication scheme, described in <a href=https://datatracker.ietf.org/doc/html/rfc7617>RFC 7617</a>. It does however not challenge the authentication, it only verifies the provided credentials and sets the <a href=../../../../../docs/configuration/rules/pipeline_mechanisms/overview/#_subject><code>Subject</code></a> <code>ID</code> to the configured user identifier if the authentication succeeds. Otherwise, it raises an error, resulting in the execution of the configured error handlers. The <a href=../../../../../docs/configuration/rules/pipeline_mechanisms/error_handlers/#_www_authenticate>"WWW Authenticate"</a> error handler mechanism can for example be used if the corresponding challenge is required.</p></div><div class=paragraph><p>To enable the usage of this authenticator, you have to set the <code>type</code> property to <code>basic_auth</code>.</p></div><div class=paragraph><p>Configuration using the <code>config</code> property is mandatory. Following properties are available:</p></div><div class=ulist><ul><li><p><strong><code>user_id</code></strong>: <em>string</em> (mandatory, overridable)</p><div class=paragraph><p>The identifier of the subject to be verified.</p></div></li><li><p><strong><code>password</code></strong>: <em>string</em> (mandatory, overridable)</p><div class=paragraph><p>The password of the subject to be verified.</p></div></li><li><p><strong><code>allow_fallback_on_error</code></strong>: <em>boolean</em> (optional, overridable)</p><div class=paragraph><p>If set to <code>true</code>, allows the pipeline to fall back to the next authenticator in the pipeline if this one fails to verify the credentials. Defaults to <code>false</code>.</p></div></li></ul></div><div class=exampleblock><div class=title>Example 3. Configuration of Basic Auth authenticator</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight" style=color:#fff;background-color:#272822><code data-lang=yaml><span style=color:#a6e22e>id</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>foo</span>
<span style=color:#a6e22e>type</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>basic_auth</span>
<span style=color:#a6e22e>config</span><span style=color:#fff;background-color:#272822>:</span>
  <span style=color:#a6e22e>user_id</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>bar</span>
  <span style=color:#a6e22e>password</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>baz</span></code></pre></div></div></div></div></div><div class=sect2><h3 id=_generic>Generic</h3><div class=paragraph><p>This authenticator is kind of a Swiss knife and can do a lot depending on the given configuration. It verifies the authentication status of the subject by making use of values available in cookies, headers, or query parameters of the HTTP request and communicating with the actual authentication system to perform the verification of the subject authentication status on the one hand, and to get the information about the subject on the other hand. There is however one limitation: it can only deal with JSON responses.</p></div><div class=paragraph><p>To enable the usage of this authenticator, you have to set the <code>type</code> property to <code>generic</code>.</p></div><div class=paragraph><p>Configuration using the <code>config</code> property is mandatory. Following properties are available:</p></div><div class=ulist><ul><li><p><strong><code>identity_info_endpoint</code></strong>: <em><a href=../../../../../docs/configuration/reference/types/#_endpoint>Endpoint</a></em> (mandatory, not overridable)</p><div class=paragraph><p>The endpoint to communicate to for the actual subject authentication status verification purpose. At least the <code>url</code> must be configured. If you don’t configure <code>method</code>, HTTP <code>POST</code> will be used. The <code>Accept</code> header is set to <code>application/json</code> by default. You can overwrite these setting if required. Query and header definitions can be templated and can make use of the <code>AuthenticationData</code> object (see below). Don’t forget - this authenticator supports only JSON responses.</p></div></li><li><p><strong><code>authentication_data_source</code></strong>: <em><a href=../../../../../docs/configuration/reference/types/#_authentication_data_source>Authentication Data Source</a></em> (mandatory, not overridable)</p><div class=paragraph><p>Where to extract the authentication data from the request. The extracted value is made available as <code>AuthenticationData</code> for usage in templates defined as part of this authenticator configuration. So you can reference it in a body, header, etc.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content>The <code>AuthenticationData</code> object is available during the execution of this authenticator only and is not made available to other mechanisms.</td></tr></tbody></table></div></li><li><p><strong><code>forward_headers</code></strong>: <em>string array</em> (optional, not overridable)</p><div class=paragraph><p>If the <code>identity_info_endpoint</code> API requires any headers from the request to heimdall, you can forward these unchanged by making use of this property. This might be the header used to extract the authentication data from.</p></div></li><li><p><strong><code>forward_cookies</code></strong>: <em>string array</em> (optional, not overridable)</p><div class=paragraph><p>If the <code>identity_info_endpoint</code> API requires any cookies from the request to heimdall, you can forward these unchanged by making use of this property. This might be the cookie used to extract the authentication data from.</p></div></li><li><p><strong><code>payload</code></strong>: <em>string</em> (optional, not overridable)</p><div class=paragraph><p>Your <a href=../../../../../docs/configuration/rules/pipeline_mechanisms/overview/#_templating>template</a> with definitions required to send the extracted authentication data. The template has access to the <code>AuthenticationData</code> object only.</p></div></li><li><p><strong><code>subject</code></strong>: <em><a href=../../../../../docs/configuration/reference/types/#_subject>Subject</a></em> (mandatory, not overridable)</p><div class=paragraph><p>Where to extract the <a href=../../../../../docs/configuration/rules/pipeline_mechanisms/overview/#_subject><code>Subject</code></a> information from the identity info endpoint response.</p></div></li><li><p><strong><code>cache_ttl</code></strong>: <em><a href=../../../../../docs/configuration/reference/types/#_duration>Duration</a></em> (optional, overridable)</p><div class=paragraph><p>How long to cache the response. If not set, response caching if disabled. The cache key is calculated from the <code>identity_info_endpoint</code> configuration and the actual authentication data value.</p></div></li><li><p><strong><code>allow_fallback_on_error</code></strong>: <em>boolean</em> (optional, overridable)</p><div class=paragraph><p>If set to <code>true</code>, allows the pipeline to fall back to the next authenticator in the pipeline if this one fails to verify the credentials. Defaults to <code>false</code>.</p></div></li><li><p><strong><code>session_lifespan</code></strong>: <em><a href=../../../../../docs/configuration/reference/types/#_session_lifespan>Session Lifespan</a></em> (optional, not overridable)</p><div class=paragraph><p>Where to extract the session validity information form the identity info endpoint response. If the <code>not_after</code> property is specified, the corresponding value from the response is also used for cache ttl calculation to prevent usage of not anymore valid session objects and overwrites the value configured for <code>cache_ttl</code> if the usage of that value would exceed the lifespan of the session object.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content>If you’re configuring the <code>cache_ttl</code> property, it is highly recommended to configure <code>session_lifespan</code> as well to ensure outdated session objects are not used for subsequent requests to heimdall. Usage of <code>session_lifespan</code> is recommended anyway to enable time based validation of the response from the identity info endpoint.</td></tr></tbody></table></div></li></ul></div><div class=exampleblock><div class=title>Example 4. Configuration to work with session cookies</div><div class=content><div class=paragraph><p>This example shows how to configure this authenticator to work with Ory Kratos, an authentication system, which issues a cookie upon successful user authentication to maintain the authentication state. To reduce the communication overhead, it also makes use of <code>cache_ttl</code> to cache the response for 5 minutes if that time frame does not exceed the actual validity of the session represented by the cookie.</p></div><div class=listingblock><div class=content><pre class="rouge highlight" style=color:#fff;background-color:#272822><code data-lang=yaml><span style=color:#a6e22e>id</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>kratos_session_cookie</span>
<span style=color:#a6e22e>type</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>generic</span>
<span style=color:#a6e22e>config</span><span style=color:#fff;background-color:#272822>:</span>
  <span style=color:#a6e22e>identity_info_endpoint</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>https://kratos/sessions/whoami</span>
  <span style=color:#a6e22e>authentication_data_source</span><span style=color:#fff;background-color:#272822>:</span>
    <span style=color:#fff;background-color:#272822>-</span> <span style=color:#a6e22e>cookie</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>ory_kratos_session</span>
  <span style=color:#a6e22e>forward_cookies</span><span style=color:#fff;background-color:#272822>:</span>
    <span style=color:#fff;background-color:#272822>-</span> <span style=color:#e6db74>ory_kratos_session</span>
  <span style=color:#a6e22e>subject</span><span style=color:#fff;background-color:#272822>:</span>
    <span style=color:#a6e22e>id</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>identity.id&#34;</span>
  <span style=color:#a6e22e>cache_ttl</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>5m</span>
  <span style=color:#a6e22e>session_lifespan</span><span style=color:#fff;background-color:#272822>:</span>
    <span style=color:#a6e22e>active</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>active</span>
    <span style=color:#a6e22e>issued_at</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>issued_at</span>
    <span style=color:#a6e22e>not_before</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>authenticated_at</span>
    <span style=color:#a6e22e>not_after</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>expires_at</span>
    <span style=color:#a6e22e>time_format</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>2006-01-02T15:04:05.999999Z07&#34;</span>
    <span style=color:#a6e22e>validity_leeway</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>10s</span></code></pre></div></div><div class=paragraph><p>As kratos requires the <code>ory_kratos_session</code> cookie as is, this configuration makes use of the <code>forward_cookies</code> property and does not use the <code>AuthenticationData</code> object.</p></div><div class=paragraph><p>This example does also show how an endpoint can be configured by just specifying the URL as string, which is the simplest way for endpoint configuration.</p></div></div></div><div class=exampleblock><div class=title>Example 5. Configuration to work with a Bearer token</div><div class=content><div class=paragraph><p>This example shows how to configure this authenticator to work with an OAuth2 authorization service, which issues a Bearer token upon successful user authentication. To reduce the communication overhead, it also makes use of <code>cache_ttl</code> to cache the response for 5 minutes if it does not exceed the validity of the information present in the response from the used endpoint.</p></div><div class=paragraph><p>In this example we configure the authenticator to use the introspection endpoint to get the information about the token.</p></div><div class=listingblock><div class=content><pre class="rouge highlight" style=color:#fff;background-color:#272822><code data-lang=yaml><span style=color:#a6e22e>id</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>opaque_bearer_token</span>
<span style=color:#a6e22e>type</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>generic</span>
<span style=color:#a6e22e>config</span><span style=color:#fff;background-color:#272822>:</span>
  <span style=color:#a6e22e>identity_info_endpoint</span><span style=color:#fff;background-color:#272822>:</span>
    <span style=color:#a6e22e>url</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>https://my-auth.system/introspect</span>
    <span style=color:#a6e22e>headers</span><span style=color:#fff;background-color:#272822>:</span>
      <span style=color:#a6e22e>Content-Type</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>application/x-www-form-urlencoded</span>
    <span style=color:#a6e22e>auth</span><span style=color:#fff;background-color:#272822>:</span>
      <span style=color:#a6e22e>type</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>basic_auth</span>
      <span style=color:#a6e22e>config</span><span style=color:#fff;background-color:#272822>:</span>
        <span style=color:#a6e22e>user</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>Heimdall</span>
        <span style=color:#a6e22e>password</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>${INTROSPECTION_PASSWORD}</span>
  <span style=color:#a6e22e>authentication_data_source</span><span style=color:#fff;background-color:#272822>:</span>
    <span style=color:#fff;background-color:#272822>-</span> <span style=color:#a6e22e>header</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>Authorization</span>
      <span style=color:#a6e22e>scheme</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>Bearer</span>
  <span style=color:#a6e22e>payload</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#fff;background-color:#272822>|</span>
    <span style=color:#e6db74>token={{ urlenc .AuthenticationData }}&amp;token_type_hint=access_token</span>
  <span style=color:#a6e22e>subject</span><span style=color:#fff;background-color:#272822>:</span>
    <span style=color:#a6e22e>id</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>sub</span>
  <span style=color:#a6e22e>cache_ttl</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>5m</span>
  <span style=color:#a6e22e>session_lifespan</span><span style=color:#fff;background-color:#272822>:</span>
    <span style=color:#a6e22e>active</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>active</span>
    <span style=color:#a6e22e>issued_at</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>iat</span>
    <span style=color:#a6e22e>not_before</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>nbf</span>
    <span style=color:#a6e22e>not_after</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>exp</span>
    <span style=color:#a6e22e>validity_leeway</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>10s</span></code></pre></div></div><div class=paragraph><p>Usually, you would not only like to verify the validity of a token, but also a couple of claims. This can be achieved by a <a href=../../../../../docs/configuration/rules/pipeline_mechanisms/authorizers/#_local_cel>CEL Authorizer</a>. However, there is also a special purpose <a href=#_oauth2_introspection>OAuth2 Introspection</a> authenticator type, which supports asserting all security relevant claims in just one place and does not need so much configuration as shown above.</p></div><div class=paragraph><p>In this configuration the authenticator extracts the token from the <code>Authorization</code> header and request the information about the corresponding user from the <code><a href=http://my-auth.system/introspect class=bare>http://my-auth.system/introspect</a></code> endpoint by sending the extracted token in the body of the request in a parameter named <code>token</code>.</p></div></div></div><div class=exampleblock><div class=title>Example 6. Configuration to work with Google’s Firebase.</div><div class=content><div class=paragraph><p>If you would like to integrate with Google’s Firebase, you would configure something like this:</p></div><div class=paragraph><p>Assumption: The token issued by firebase is located in the HTTP Authorization header using Bearer scheme</p></div><div class=listingblock><div class=content><pre class="rouge highlight" style=color:#fff;background-color:#272822><code data-lang=yaml><span style=color:#a6e22e>id</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>firebase_token</span>
<span style=color:#a6e22e>type</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>generic</span>
<span style=color:#a6e22e>config</span><span style=color:#fff;background-color:#272822>:</span>
  <span style=color:#a6e22e>identity_info_endpoint</span><span style=color:#fff;background-color:#272822>:</span>
    <span style=color:#a6e22e>url</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>https://identitytoolkit.googleapis.com/v1/accounts:lookup?key=${YOUR_API_KEY}</span>
    <span style=color:#a6e22e>headers</span><span style=color:#fff;background-color:#272822>:</span>
      <span style=color:#a6e22e>Content-Type</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>application/json</span>
  <span style=color:#a6e22e>authentication_data_source</span><span style=color:#fff;background-color:#272822>:</span>
    <span style=color:#fff;background-color:#272822>-</span> <span style=color:#a6e22e>header</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>Authorization</span>
      <span style=color:#a6e22e>scheme</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>Bearer</span>
  <span style=color:#a6e22e>payload</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#fff;background-color:#272822>|</span>
   <span style=color:#e6db74>{ &#34;idToken&#34;: {{ quote .AuthenticationData }} }</span>
  <span style=color:#a6e22e>subject</span><span style=color:#fff;background-color:#272822>:</span>
   <span style=color:#a6e22e>id</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>users.0.localId</span>
   <span style=color:#a6e22e>attributes</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>users.0</span>
  <span style=color:#a6e22e>cache_ttl</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>5m</span></code></pre></div></div></div></div></div><div class=sect2><h3 id=_oauth2_introspection>OAuth2 Introspection</h3><div class=paragraph><p>This authenticator handles requests that have Bearer token in the HTTP Authorization header (<code>Authorization: Bearer &lt;token></code>), in the <code>access_token</code> query parameter or the <code>access_token</code> body parameter (latter, if the body is of <code>application/x-www-form-urlencoded</code> MIME type). It then uses <a href=https://datatracker.ietf.org/doc/html/rfc7662>OAuth 2.0 Token Introspection</a> endpoint to check if the token is valid. The validation includes at least the verification of the status and the time validity. That is if the token is still active and whether it has been issued in an acceptable time frame. Latter can be adjusted by specifying a leeway. All other validation options can and should be configured.</p></div><div class=paragraph><p>To enable the usage of this authenticator, you have to set the <code>type</code> property to <code>oauth2_introspection</code>.</p></div><div class=paragraph><p>Configuration using the <code>config</code> property is mandatory. Following properties are available:</p></div><div class=ulist><ul><li><p><strong><code>introspection_endpoint</code></strong>: <em><a href=../../../../../docs/configuration/reference/types/#_endpoint>Endpoint</a></em> (dependant, not overridable)</p><div class=paragraph><p>The <a href=https://datatracker.ietf.org/doc/html/rfc7662>OAuth 2.0 Token Introspection</a> endpoint of the OAuth2 authorization provider.</p></div><div class=paragraph><p>The configuration of this property is mutually exclusive with <code>metadata_endpoint</code>. At least the <code>url</code> must be configured. There is no need to define the <code>method</code> property or setting the <code>Content-Type</code> or the <code>Accept</code> header. These are set by default to the values required by the RFC referenced above. You can however override these while configuring the authenticator if needed. The path part of the <code>url</code> can be <a href=../../../../../docs/configuration/rules/pipeline_mechanisms/overview/#_templating>templated</a> and has access to the <code>TokenIssuer</code> object, which is a string and only available if the format of the used token is JWT. It basically holds the value of the <code>iss</code> claim from the token.</p></div></li><li><p><strong><code>metadata_endpoint</code></strong>: <em><a href=../../../../../docs/configuration/reference/types/#_endpoint>Endpoint</a></em> (dependant, not overridable)</p><div class=paragraph><p>The <a href=https://datatracker.ietf.org/doc/html/rfc8414>OAuth 2.0 Authorization Server Metadata</a> endpoint of the OAuth2, respectively OIDC authorization provider (the <a href=https://openid.net/specs/openid-connect-discovery-1_0.html>OpenID Connect Discovery</a> specification is an OIDC specific profile of that specification). If the token introspection URL is not known upfront, it can be resolved by making use of that endpoint.</p></div><div class=paragraph><p>The configuration of this property is mutually exclusive with <code>introspection_endpoint</code>. At least the <code>url</code> must be configured, can be templated and has access to the <code>TokenIssuer</code> object already introduced above (with the same limitations).</p></div><div class=paragraph><p>The <code>metadata_endpoint</code> is by default configured to use <code>GET</code> as HTTP method and sets the <code>Accept</code> header to <code>application/json</code> as also required by both specifications referenced above. In addition, to avoid useless communication, it is also configured to make use of HTTP cache according to <a href=http://tools.ietf.org/html/rfc7234>RFC 7234</a> with default HTTP cache ttl set to <code>30m</code>. All these settings can however be overridden if required.</p></div><div class=paragraph><p>In addition to the properties specified by the <a href=../../../../../docs/configuration/reference/types/#_endpoint><code>endpoint</code></a> type, following properties are available:</p></div><div class=ulist><ul><li><p><strong><code>disable_issuer_identifier_verification</code></strong>: <em>boolean</em> (optional, not overridable)</p><div class=paragraph><p>Upon retrieval of the server metadata, both, the <a href=https://datatracker.ietf.org/doc/html/rfc8414>OAuth 2.0 Authorization Server Metadata</a> RFC, and the <a href=https://openid.net/specs/openid-connect-discovery-1_0.html>OpenID Connect Discovery</a> specification, require the verification of the issuer identifier for security reasons, e.g. to prevent <a href=https://datatracker.ietf.org/doc/html/rfc8414#section-6.2>Spoofing Attacks</a>. There are however setups, where strictly following that recommendation would result in extended bandwidth usage (instead of communicating directly with the auth server within the cluster one would need to use the same domain, the client application uses, which introduces additional network hops). It might also not work at all as the actual identifier of the issuer would change depending on where the request come from. By making use of this property and setting it to <code>true</code>, one can disable the corresponding verification. Defaults to <code>false</code>.</p></div></li></ul></div></li><li><p><strong><code>token_source</code></strong>: <em><a href=../../../../../docs/configuration/reference/types/#_authentication_data_source>Authentication Data Source</a></em> (optional, not overridable)</p><div class=paragraph><p>Where to get the access token from. Defaults to retrieve it from the <code>Authorization</code> header, the <code>access_token</code> query parameter or the <code>access_token</code> body parameter (latter, if the body is of <code>application/x-www-form-urlencoded</code> MIME type).</p></div></li><li><p><strong><code>assertions</code></strong>: <em><a href=../../../../../docs/configuration/reference/types/#_assertions>Assertions</a></em> (dependent, overridable)</p><div class=paragraph><p>Configures the required claim assertions. Overriding on rule level is possible even partially. Those parts of the assertion, which have not been overridden are taken from the prototype configuration. If <code>metadata_endpoint</code> is used, the list of issuers is optional, as the issuer will be resolved via the auth server metadata document. Otherwise, the list of issuers is mandatory.</p></div></li><li><p><strong><code>subject</code></strong>: <em><a href=../../../../../docs/configuration/reference/types/#_subject>Subject</a></em> (optional, not overridable)</p><div class=paragraph><p>Where to extract the <a href=../../../../../docs/configuration/rules/pipeline_mechanisms/overview/#_subject><code>Subject</code></a> information from the introspection endpoint response. If not configured <code>sub</code> is used to extract the subject <code>ID</code> and all attributes from the introspection endpoint response are made available as <code>Attributes</code>.</p></div></li><li><p><strong><code>cache_ttl</code></strong>: <em><a href=../../../../../docs/configuration/reference/types/#_duration>Duration</a></em> (optional, overridable)</p><div class=paragraph><p>How long to cache the response. If not set, caching of the introspection response is based on the available token expiration information. To disable caching, set it to <code>0s</code>. If you set the ttl to a custom value > 0, the expiration time (if available) of the token will be considered. The cache key is calculated from the <code>introspection_endpoint</code> configuration and the value of the access token.</p></div></li><li><p><strong><code>allow_fallback_on_error</code></strong>: <em>boolean</em> (optional, overridable)</p><div class=paragraph><p>If set to <code>true</code>, allows the pipeline to fall back to the next authenticator in the pipeline if this one fails to verify the credentials. Defaults to <code>false</code>.</p></div></li></ul></div><div class=exampleblock><div class=title>Example 7. Minimal possible configuration based on the Introspection endpoint</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight" style=color:#fff;background-color:#272822><code data-lang=yaml><span style=color:#a6e22e>id</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>at_opaque</span>
<span style=color:#a6e22e>type</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>oauth2_introspection</span>
<span style=color:#a6e22e>config</span><span style=color:#fff;background-color:#272822>:</span>
  <span style=color:#a6e22e>introspection_endpoint</span><span style=color:#fff;background-color:#272822>:</span>
    <span style=color:#a6e22e>url</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>http://hydra:4445/oauth2/introspect</span>
  <span style=color:#a6e22e>assertions</span><span style=color:#fff;background-color:#272822>:</span>
    <span style=color:#a6e22e>issuers</span><span style=color:#fff;background-color:#272822>:</span>
      <span style=color:#fff;background-color:#272822>-</span> <span style=color:#e6db74>http://127.0.0.1:4444/</span></code></pre></div></div></div></div><div class=exampleblock><div class=title>Example 8. Configuration for Keycloak utilizing metadata discovery</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight" style=color:#fff;background-color:#272822><code data-lang=yaml><span style=color:#a6e22e>id</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>keycloak</span>
<span style=color:#a6e22e>type</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>metadata_endpoint</span>
<span style=color:#a6e22e>config</span><span style=color:#fff;background-color:#272822>:</span>
  <span style=color:#a6e22e>metadata_endpoint</span><span style=color:#fff;background-color:#272822>:</span>
    <span style=color:#a6e22e>url</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>http://keycloak:8080/realms/{{ trimPrefix &#34;https://my-auth-server/realms/&#34; .TokenIssuer }}/.well-known/openid-configuration</span>
  <span style=color:#75715e># Note that no assertions are configured here, since it&#39;ll be resolved via the metadata endpoint</span></code></pre></div></div><div class=paragraph><p>This example does also show how to make use of templating if the format of the access token is JWT.</p></div><div class=paragraph><p>The external domain of the auth server in this example is <code><a href=https://my-auth-server.com class=bare>https://my-auth-server.com</a></code>.
If the <code>iss</code> claim of the issued JWT is set to <code><a href=https://my-auth-server.com/realms/my-app class=bare>https://my-auth-server.com/realms/my-app</a></code>, the above line will build an internal URL to the metadata endpoint of the same server and profile/realm, which is that case would be <code><a href=http://keycloak:8080/realms/my-app/.well-known/openid-configuration class=bare>http://keycloak:8080/realms/my-app/.well-known/openid-configuration</a></code></p></div></div></div></div><div class=sect2><h3 id=_jwt>JWT</h3><div class=paragraph><p>As the <a href=#_oauth2_introspection>OAuth2 Introspection</a> authenticator, this authenticator handles requests that have a Bearer token in the <code>Authorization</code> header, in a different header, a query parameter or a body parameter as well. Unlike the OAuth2 Introspection authenticator it expects the token to be a JSON Web Token (JWT) and verifies it according <a href=https://www.rfc-editor.org/rfc/rfc7519#section-7.2>RFC 7519, Section 7.2</a>. It does however not support encrypted payloads and nested JWTs. In addition to this, validation includes the verification of the time validity. Latter can be adjusted by specifying a leeway. All other validation options can and should be configured.</p></div><div class=paragraph><p>To enable the usage of this authenticator, you have to set the <code>type</code> property to <code>jwt</code>.</p></div><div class=paragraph><p>Configuration using the <code>config</code> property is mandatory. Following properties are available:</p></div><div class=ulist><ul><li><p><strong><code>jwks_endpoint</code></strong>: <em><a href=../../../../../docs/configuration/reference/types/#_endpoint>Endpoint</a></em> (dependant, not overridable)</p><div class=paragraph><p>The JWKS endpoint, this authenticator retrieves the key material in a format specified in <a href=https://datatracker.ietf.org/doc/html/rfc7519>RFC 7519</a> from for JWT signature verification purposes.</p></div><div class=paragraph><p>The configuration of this property is mutually exclusive with <code>metadata_endpoint</code>. At least the <code>url</code> must be configured. By default <code>method</code> is set to <code>GET</code> and the HTTP <code>Accept</code> header to <code>application/json</code>. The path part of the <code>url</code> can be <a href=../../../../../docs/configuration/rules/pipeline_mechanisms/overview/#_templating>templated</a> and has access to the <code>TokenIssuer</code> object, which is a string and basically holds the value of the <code>iss</code> claim from the token.</p></div></li><li><p><strong><code>metadata_endpoint</code></strong>: <em><a href=../../../../../docs/configuration/reference/types/#_endpoint>Endpoint</a></em> (dependant, not overridable)</p><div class=paragraph><p>The <a href=https://datatracker.ietf.org/doc/html/rfc8414>OAuth 2.0 Authorization Server Metadata</a> endpoint of the OAuth2, respectively OIDC authorization provider (the <a href=https://openid.net/specs/openid-connect-discovery-1_0.html>OpenID Connect Discovery</a> specification is an OIDC specific profile of that specification). If the JWKS URL is not known upfront, it can be resolved by making use of that endpoint.</p></div><div class=paragraph><p>The configuration of this property is mutually exclusive with <code>jwks_endpoint</code>. At least the <code>url</code> must be configured. As with the <code>jwks_endpoint</code>, the path part of the <code>url</code> can be templated and has access to the <code>TokenIssuer</code> object already introduced above.</p></div><div class=paragraph><p>As with the <code>jwks_endpoint</code> as well, the <code>metadata_endpoint</code> is by default configured to use <code>GET</code> as HTTP method and sets the <code>Accept</code> header to <code>application/json</code>, as also required by both specifications referenced above. In addition, to avoid useless communication, it is also configured to make use of HTTP cache according to <a href=http://tools.ietf.org/html/rfc7234>RFC 7234</a> with default HTTP cache ttl set to <code>30m</code>. All these settings can however be overridden if required.</p></div><div class=paragraph><p>In addition to the properties specified by the <a href=../../../../../docs/configuration/reference/types/#_endpoint><code>endpoint</code></a> type, following properties are available:</p></div><div class=ulist><ul><li><p><strong><code>disable_issuer_identifier_verification</code></strong>: <em>boolean</em> (optional, not overridable)</p><div class=paragraph><p>Upon retrieval of the server metadata, both, the <a href=https://datatracker.ietf.org/doc/html/rfc8414>OAuth 2.0 Authorization Server Metadata</a> RFC, and the <a href=https://openid.net/specs/openid-connect-discovery-1_0.html>OpenID Connect Discovery</a> specification, require the verification of the issuer identifier for security reasons, e.g. to prevent <a href=https://datatracker.ietf.org/doc/html/rfc8414#section-6.2>Spoofing Attacks</a>. There are however setups, where strictly following that recommendation would result in extended bandwidth usage (instead of communicating directly with the auth server within the cluster one would need to use the same domain, the client application uses, which introduces additional network hops). It might also not work at all as the actual identifier of the issuer would change depending on where the request come from. By making use of this property and setting it to <code>true</code>, one can disable the corresponding verification. Defaults to <code>false</code>.</p></div></li></ul></div></li><li><p><strong><code>jwt_source</code></strong>: <em><a href=../../../../../docs/configuration/reference/types/#_authentication_data_source>Authentication Data Source</a></em> (optional, not overridable)</p><div class=paragraph><p>Where to get the access token from. Defaults to retrieve it from the <code>Authorization</code> header, the <code>access_token</code> query parameter or the <code>access_token</code> body parameter (latter, if the body is of <code>application/x-www-form-urlencoded</code> MIME type).</p></div></li><li><p><strong><code>assertions</code></strong>: <em><a href=../../../../../docs/configuration/reference/types/#_assertions>Assertions</a></em> (dependant, overridable)</p><div class=paragraph><p>Configures the required claim assertions. Overriding on rule level is possible even partially. Those parts of the assertion, which have not been overridden are taken from the prototype configuration. If <code>metadata_endpoint</code> is used, the list of issuers is optional, as the issuer will be resolved via the auth server metadata document. Otherwise, the list of issuers is mandatory.</p></div></li><li><p><strong><code>subject</code></strong>: <em><a href=../../../../../docs/configuration/reference/types/#_subject>Subject</a></em> (optional, not overridable)</p><div class=paragraph><p>Where to extract the subject id from the JWT, as well as which attributes to use. If not configured <code>sub</code> is used to extract the subject id and all attributes from the JWT payload are made available as attributes of the subject.</p></div></li><li><p><strong><code>cache_ttl</code></strong>: <em><a href=../../../../../docs/configuration/reference/types/#_duration>Duration</a></em> (optional, overridable)</p><div class=paragraph><p>How long to cache the key from the JWKS response, which was used for signature verification purposes. If not set, heimdall will cache this key for 10 minutes and not call JWKS endpoint again if the same <code>kid</code> is referenced in an JWT and same JWKS endpoint is used. The cache key is calculated from the <code>jwks_endpoint</code> configuration and the <code>kid</code> referenced in the JWT.</p></div></li><li><p><strong><code>allow_fallback_on_error</code></strong>: <em>boolean</em> (optional, overridable)</p><div class=paragraph><p>If set to <code>true</code>, allows the pipeline to fall back to the next authenticator in the pipeline if this one fails to verify the credentials. Defaults to <code>false</code>.</p></div></li><li><p><strong><code>validate_jwk</code></strong>: <em>boolean</em> (optional, not overridable)</p><div class=paragraph><p>Enables or disables the verification of the JWK certificate used for JWT signature verification purposes. Effective only if the JWK contains a certificate. The verification happens according to <a href=https://www.rfc-editor.org/rfc/rfc5280#section-6.1>RFC 5280, section 6.1</a> and also includes the check, that the certificate is allowed to be used for signature verification purposes. Revocation check is not supported. Defaults to <code>true</code>.</p></div></li><li><p><strong><code>trust_store</code></strong>: <em>string</em> (optional, not overridable)</p><div class=paragraph><p>The path to a PEM file containing the trust anchors, to be used for the JWK certificate validation. Defaults to system trust store.</p></div></li></ul></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content>If a JWT does not reference a <code>kid</code>, heimdall always fetches a JWKS from the configured endpoint (so no caching is done) and iterates over the received keys until one matches. If none matches, the authenticator fails.</td></tr></tbody></table></div><div class=exampleblock><div class=title>Example 9. Minimal possible configuration based on the JWKS endpoint</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight" style=color:#fff;background-color:#272822><code data-lang=yaml><span style=color:#a6e22e>id</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>at_jwt</span>
<span style=color:#a6e22e>type</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>jwt</span>
<span style=color:#a6e22e>config</span><span style=color:#fff;background-color:#272822>:</span>
  <span style=color:#a6e22e>jwks_endpoint</span><span style=color:#fff;background-color:#272822>:</span>
    <span style=color:#a6e22e>url</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>http://hydra:4444/.well-known/jwks.json</span>
  <span style=color:#a6e22e>assertions</span><span style=color:#fff;background-color:#272822>:</span>
    <span style=color:#a6e22e>issuers</span><span style=color:#fff;background-color:#272822>:</span>
      <span style=color:#fff;background-color:#272822>-</span> <span style=color:#e6db74>http://127.0.0.1:4444/</span></code></pre></div></div></div></div><div class=exampleblock><div class=title>Example 10. Configuration for Keycloak utilizing metadata discovery</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight" style=color:#fff;background-color:#272822><code data-lang=yaml><span style=color:#a6e22e>id</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>keycloak</span>
<span style=color:#a6e22e>type</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>jwt</span>
<span style=color:#a6e22e>config</span><span style=color:#fff;background-color:#272822>:</span>
  <span style=color:#a6e22e>metadata_endpoint</span><span style=color:#fff;background-color:#272822>:</span>
    <span style=color:#a6e22e>url</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>http://keycloak:8080/realms/my-app/.well-known/openid-configuration</span>
  <span style=color:#75715e># Note that no assertions are configured here, since it&#39;ll be resolved via the metadata endpoint</span></code></pre></div></div></div></div></div></div></div></linkable-headline-area></div><p class="text-end fst-italic fs-7">Last updated on <span class=fw-bold>Jan 3, 2024</span></p><div class="d-flex justify-content-between"><a href=../../../../../docs/configuration/rules/pipeline_mechanisms/overview/><div class="fs-6 mb-3"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentcolor" class="bi bi-chevron-left" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M11.354 1.646a.5.5.0 010 .708L5.707 8l5.647 5.646a.5.5.0 01-.708.708l-6-6a.5.5.0 010-.708l6-6a.5.5.0 01.708.0z"/></svg>Mechanisms Overview</div></a><a class=ms-auto href=../../../../../docs/configuration/rules/pipeline_mechanisms/authorizers/><div class="fs-6 mb-3">Authorizers<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentcolor" class="bi bi-chevron-right" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4.646 1.646a.5.5.0 01.708.0l6 6a.5.5.0 010 .708l-6 6a.5.5.0 01-.708-.708L10.293 8 4.646 2.354a.5.5.0 010-.708z"/></svg></div></a></div></main></div><footer class="footer py-4 py-md-5 px-4 px-md-3"><div class=container><div class=row><div class="col-lg-3 mb-3"><p class=fs-5>Heimdall</p><ul class="list-unstyled small text-muted"><li class=mb-2>2022-2023 © Heimdall Project Authors. All rights reserved.</li><li class=mb-2><a href=https://github.com/dadrus/heimdall/blob/master/LICENSE>Apache 2.0 licensed</a></li></ul></div><div class="col-6 col-lg-2 offset-lg-1 mb-3"><h5>Links</h5><ul class=list-unstyled><li class=mb-2><a href=../../../../../>Home</a></li><li class=mb-2><a href=../../../../../docs/welcome>Docs</a></li><li class=mb-2><a href=../../../../../openapi/>API</a></li></ul></div><div class="col-6 col-lg-2 mb-2"><h5>Guides</h5><ul class=list-unstyled><li class=mb-2><a href=../../../../../docs/operations/install/>Install</a></li><li class=mb-2><a href=../../../../../docs/getting_started/>Getting Started</a></li><li class=mb-2><a href=../../../../../docs/guides/>Integration Guides</a></li></ul></div><div class="col-6 col-lg-2 mb-2"><h5>Community</h5><ul class=list-unstyled><li class=mb-2><a href=https://github.com/dadrus/heimdall>Github</a></li><li class=mb-2><a href=https://discord.gg/qQgg8xKuyb>Discord</a></li></ul></div></div></div></footer><script src=../../../../../js/main.js defer></script>
<script src=https://cdn.redoc.ly/redoc/latest/bundles/redoc.standalone.js></script></body></html>